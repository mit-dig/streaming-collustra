(function(){function ha(){function a(){}a.prototype=ha.prototype;var b=new a,e;for(e in va)b[e]=va[e];return b}function M(a){function b(){}a=a||{};b.prototype=M.prototype;var e=new b;e._lexer=a.lexer||new ha;e._blankNodes=Object.create(null);e._blankNodeCount=0;e._tripleStack=[];a.documentURI?(e._baseURI=e._documentURI=a.documentURI,e._baseURIRoot=e._documentURIRoot=a.documentURI.replace(wa,"")):(e._baseURI=e._documentURI=null,e._baseURIROOT=e._documentURIRoot=null);return e}typeof console=="undefined"&&
(console={log:function(){}});window.process={};process.nextTick=function(a){setTimeout(a,0)};var s={"extends":function(a,b){b.prototype=new a},stackCounterLimit:1E3,stackCounter:0};s.recur=function(a){s.stackCounter===s.stackCounterLimit?(s.stackCounter=0,setTimeout(a,0)):(s.stackCounter++,a())};s.clone=function(a){return JSON.parse(JSON.stringify(a))};s.shuffle=function(a){for(var b,e,d=a.length;d;b=parseInt(Math.random()*d),e=a[--d],a[d]=a[b],a[b]=e);return a};s.include=function(a,b,e){for(var d=
a.length-1;d>=0;d--){var g=!1,g=e==null?a[d]===b:e(a[d],b)===0;if(g===!0)return!0}return!1};s.remove=function(a,b){for(var e=[],d=0;d<a.length;d++)a[d]!==b&&e.push(a[d]);return e};s.repeat=function(a,b,e,d,g){arguments.length===4&&(g={});a<b?(g._i=a,e(function(e,g){s.recur(function(){s.repeat(a+1,b,e,d,g)})},g)):d(g)};s.meanwhile=function(a,b,e,d){arguments.length===3&&(d={});d._stack_counter==null&&(d._stack_counter=0);a===!0?b(function(a,b,d){d._stack_counter%40==39?(d._stack_counter+=1,setTimeout(function(){s.neanwhile(a,
b,e,d)},0)):(d._stack_counter+=1,s.meanwhile(a,b,e,d))},d):e(d)};s.seq=function(){var a=arguments;return function(b){s.repeat(0,a.length,function(e,b){var g=arguments.callee;a[b._i](function(){e(g,b)})},function(){b()})}};s.partition=function(a,b){for(var e=a.length%b,d=[],g=0;g<e;g++)d.push(null);e=[];for(g=0;g<a.length;g++)d.push(a[g]),d.length%b==0&&(e.push(d),d=[]);return e};s.keys=function(a){var b=[],e;for(e in a)b.push(e);return b};s.iso8601=function(a){function b(a){return a<10?"0"+a:a}return a.getUTCFullYear()+
"-"+b(a.getUTCMonth()+1)+"-"+b(a.getUTCDate())+"T"+b(a.getUTCHours())+":"+b(a.getUTCMinutes())+":"+b(a.getUTCSeconds())+"Z"};s.parseStrictISO8601=function(a){var b=a.match(RegExp("([0-9]{4})(-([0-9]{2})(-([0-9]{2})(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?")),a=0,e=new Date(b[1],0,1);if(b[3])e.setMonth(b[3]-1);else throw"missing ISO8061 component";if(b[5])e.setDate(b[5]);else throw"missing ISO8061 component";if(b[7])e.setHours(b[7]);else throw"missing ISO8061 component";
if(b[8])e.setMinutes(b[8]);else throw"missing ISO8061 component";if(b[10])e.setSeconds(b[10]);else throw"missing ISO8061 component";b[12]&&e.setMilliseconds(Number("0."+b[12])*1E3);b[14]&&(a=Number(b[16])*60+Number(b[17]),a*=b[15]=="-"?1:-1);a-=e.getTimezoneOffset();b=new Date;b.setTime(Number(Number(e)+a*6E4));return b};s.parseISO8601=function(a){var b=a.match(RegExp("([0-9]{4})(-([0-9]{2})(-([0-9]{2})(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?")),a=
0,e=new Date(b[1],0,1);b[3]&&e.setMonth(b[3]-1);b[5]&&e.setDate(b[5]);b[7]&&e.setHours(b[7]);b[8]&&e.setMinutes(b[8]);b[10]&&e.setSeconds(b[10]);b[12]&&e.setMilliseconds(Number("0."+b[12])*1E3);b[14]&&(a=Number(b[16])*60+Number(b[17]),a*=b[15]=="-"?1:-1);a-=e.getTimezoneOffset();b=new Date;b.setTime(Number(Number(e)+a*6E4));return b};s.parseISO8601Components=function(a){var a=a.match(RegExp("([0-9]{4})(-([0-9]{2}))(-([0-9]{2}))(T([0-9]{2}):([0-9]{2})(:([0-9]{2}))?(.([0-9]+))?)?(Z|([-+])([0-9]{2})(:([0-9]{2}))?)?")),
b,e,d,g,i,f,h,k;b=Number(a[1]);e=a[3]-1;d=Number(a[5]);g=Number(a[7]);i=Number(a[8]);f=Number(a[10]);a[12]&&(h=Number("0."+a[12])*1E3);a[13]==="Z"?k=0:a[14]?(k=0,a[17]&&(k=Number(a[17])),k+=Number(a[15])*60,k*=a[14]=="-"?-1:1):a[14]==null&&a[11]&&(k=Number(a[12])*60);return{year:isNaN(b)?null:b,month:isNaN(e)?null:e,date:isNaN(d)?null:d,hours:isNaN(g)?null:g,minutes:isNaN(i)?null:i,seconds:isNaN(f)?null:f,millisecs:isNaN(h)?null:h,timezone:isNaN(k)?null:k}};s.compareDateComponents=function(a,b){var e=
s.parseISO8601Components(a),d=s.parseISO8601Components(b);if(e.timezone==null&&d.timezone==null||e.timezone!=null&&d.timezone!=null)return e=s.parseISO8601(a),d=s.parseISO8601(b),e.getTime()==d.getTime()?0:e.getTime()<d.getTime()?-1:1;else if(e.timezone!=null&&d.timezone==null){var e=s.parseISO8601(a),d=s.parseISO8601(b),e=e.getTime(),d=d.getTime(),g=50400;return e<d&&e<d+g?-1:e>d&&e>d-g?1:null}else return e=s.parseISO8601(a),d=s.parseISO8601(b),e=e.getTime(),d=d.getTime(),g=50400,e<d&&e+g<d?-1:e>
d&&e+g>d?1:null};s.lexicalFormLiteral=function(a,b){var e=a.value,d=a.lang,g=a.type,i=null;if(e!=null&&g!=null&&typeof g!="string"){e=g.value;if(e==null)e=g.suffix,g=b.namespaces[g.prefix],a.type=g+e,e=g+e;i=e.indexOf("hexBinary")!=-1?'"'+a.value.toLowerCase()+'"^^<'+e+">":'"'+a.value+'"^^<'+e+">"}else i=d==null&&g==null?'"'+e+'"':g==null?'"'+e+'"@'+d:g.indexOf("hexBinary")!=-1?'"'+a.value.toLowerCase()+'"^^<'+g+">":'"'+a.value+'"^^<'+g+">";return i};s.lexicalFormBaseUri=function(a,b){var e=null,
b=b||{};if(a.value==null)var e=a.prefix,d=a.suffix,g=b.namespaces[e],e=g!=null?g+d:e+":"+d;else e=a.value;if(e===null)return null;else e.indexOf(":")==-1&&(e=(b.base||"")+e);return e};s.lexicalFormTerm=function(a,b){if(a.token==="uri")return{uri:s.lexicalFormBaseUri(a,b)};else if(a.token==="literal")return{literal:s.lexicalFormLiteral(a,b)};else if(a.token==="blank")return{blank:"_:"+a.value};else throw"Error, cannot get lexical form of unknown token: "+a.token;};s.normalizeUnicodeLiterals=function(a){for(var b=
a.match(/\\u[0-9abcdefABCDEF]{4,4}/g)||[],e={},d=0;d<b.length;d++)e[b[d]]==null&&(e[b[d]]=!0,a=a.replace(RegExp("\\"+b[d],"g"),eval("'"+b[d]+"'")));return a};s.hashTerm=function(a){try{if(a==null)return"";if(a.token==="uri")return"u"+a.value;else if(a.token==="blank")return"b"+a.value;else if(a.token==="literal"){var b="l"+a.value;b+=a.type||"";b+=a.lang||"";return b}}catch(e){if(typeof a==="object"){b="";for(p in a)b=b+p+a[p];return b}return a}};var xa={PriorityQueue:function(a){var b=[],e={},d=
!1,g,i=a.maxSize||10;g=function(a,b){return e[b].priority-e[a].priority};var f=function(){b.sort(g);d=!0};return{debugContents:b,debugStore:e,debugSort:f,push:function(a,g){if(b.length===i){d||f();if(e[a]==null){delete e[b[0]];b[0]=a;var h=e[b[b.length-1]].priority-1;e[a]={object:g,priority:h}}else h=e[b[b.length-1]].priority-1,e[a].priority=h;d=!1}else b.length===0?(b.push(a),e[a]={object:g,priority:1E3}):(h=e[b[b.length-1]].priority-1,e[a]==null?(e[a]={object:g,priority:h},b.push(a)):(e[a].priority=
h,d=!1))},remove:function(a){if(e[a]!=null){delete e[a];for(var g=null,d=0;d<b.length;d++)if(b[d]===a){g=d;break}g!=null&&b.splice(g,1)}},fetch:function(a){var g=e[a];return e[a]!=null?(d||f(),e[a].priority=e[b[b.length-1]].priority-1,d=!1,g.object):null}}}},C={};C.Tree=function(a,b,e,d){if(arguments.length!=0){var g=null;if(e===!0)try{if(g=window.localStorage,g==null)throw"not found";}catch(i){throw"Local storage is not present, cannot create persistent storage";}g==null&&(g=function(){var a={};
return{setItem:function(e,b){a[e]=b},getItem:function(e){return a[e]||null},removeItem:function(e){delete a[e]},get:function(e){var b=0,g;for(g in a){if(e===b)return g;b++}return""},length:a.length}}());this.storage=g;this.order=a;this.name=b;this.diskManager=new C.LocalStorageManager(b,g,d);this.root=this.diskManager._readRootNode();this.root==null?(this.root=this._allocateNode(),this.root.isLeaf=!0,this.root.level=0,this._diskWrite(this.root),this._updateRootNode(this.root),this.root=this.root.pointer):
this.root=this.diskManager._diskRead(this.root).pointer;this.comparator=function(a,e){return a<e?-1:a>e?1:0};this.merger=null}};C.Tree.prototype._allocateNode=function(){return new C.Node};C.Tree.prototype._diskWrite=function(a){this.diskManager._diskWrite(a)};C.Tree.prototype._diskRead=function(a){return this.diskManager._diskRead(a)};C.Tree.prototype._diskDelete=function(a){this.diskManager._diskDelete(a)};C.Tree.prototype._updateRootNode=function(a){this.diskManager._updateRootNode(a);return a};
C.Tree.prototype.search=function(a,b){for(var e=!0,d=this._diskRead(this.root);e;){for(var g=0;g<d.numberActives&&this.comparator(a,d.keys[g].key)===1;)g++;if(g<d.numberActives&&this.comparator(d.keys[g].key,a)===0)return b!=null&&b==!0?!0:d.keys[g].data;else d.isLeaf===!0?e=!1:d=this._diskRead(d.children[g])}return null};C.Tree.prototype.walk=function(a){this._walk(a,this._diskRead(this.root))};C.Tree.prototype._walk=function(a,b){if(b.isLeaf)for(var e=0;e<b.numberActives;e++)a(b.keys[e]);else{for(e=
0;e<b.numberActives;e++)this._walk(a,this._diskRead(b.children[e])),a(b.keys[e]);this._walk(a,this._diskRead(b.children[b.numberActives]))}};C.Tree.prototype.walkNodes=function(a){this._walkNodes(a,this._diskRead(this.root))};C.Tree.prototype._walkNodes=function(a,b){if(b.isLeaf)a(b);else{a(b);for(var e=0;e<b.numberActives;e++)this._walkNodes(a,this._diskRead(b.children[e]));this._walkNodes(a,this._diskRead(b.children[b.numberActives]))}};C.Tree.prototype._splitChild=function(a,b,e){var d=this._allocateNode();
d.isLeaf=e.isLeaf;d.level=e.level;d.numberActives=this.order-1;var g=e.keys[this.order-1];e.keys[this.order-1]=null;for(var i=0;i<this.order-1;i++)d.keys[i]=e.keys[i+this.order],e.keys[i+this.order]=null,e.isLeaf||(d.children[i]=e.children[i+this.order],e.children[i+this.order]=null);e.isLeaf||(d.children[i]=e.children[i+this.order],e.children[i+this.order]=null);e.numberActives=this.order-1;for(i=a.numberActives+1;i>b+1;i--)a.children[i]=a.children[i-1];this._diskWrite(d);a.children[b+1]=d.pointer;
for(i=a.numberActives;i>b;i--)a.keys[i]=a.keys[i-1];a.keys[b]=g;a.numberActives++;this._diskWrite(a);this._diskWrite(e)};C.Tree.prototype.insert=function(a,b){var e=this._diskRead(this.root);if(e.numberActives===2*this.order-1){var d=this._allocateNode();d.isLeaf=!1;d.level=e.level+1;d.numberActives=0;d.children[0]=e.pointer;this._diskWrite(d);this._splitChild(d,0,e);this.root=d.pointer;this._updateRootNode(d);this._insertNonFull(d,a,b)}else this._insertNonFull(e,a,b)};C.Tree.prototype._insertNonFull=
function(a,b,e){for(var d=a.numberActives-1;!a.isLeaf;){for(;d>=0&&this.comparator(b,a.keys[d].key)===-1;)d--;d++;var g=this._diskRead(a.children[d]);g.numberActives===2*this.order-1&&(this._splitChild(a,d,g),this.comparator(b,a.keys[d].key)===1&&d++);a=this._diskRead(a.children[d]);d=a.numberActives-1}for(;d>=0&&this.comparator(b,a.keys[d].key)===-1;)a.keys[d+1]=a.keys[d],d--;a.keys[d+1]={key:b,data:e};a.numberActives++;this._diskWrite(a)};C.Tree.prototype["delete"]=function(a){for(var b=this._diskRead(this.root),
e=null,d=!0,g=null,i=null,f=null,h=!0;h===!0;){for(h=!1;d===!0;){m=0;if(b.numberActives===0)return!1;for(;m<b.numberActives&&this.comparator(a,b.keys[m].key)===1;)m++;g=m;m<b.numberActives&&this.comparator(a,b.keys[m].key)===0&&(d=!1);if(d===!0){if(b.isLeaf===!0)return!1;e=b;b=this._diskRead(b.children[m]);if(b===null)return!1;g===e.numberActives?(i=this._diskRead(e.children[g-1]),f=null):g===0?(i=null,f=this._diskRead(e.children[1])):(i=this._diskRead(e.children[g-1]),f=this._diskRead(e.children[g+
1]));b.numberActives===this.order-1&&e!=null&&(f!=null&&f.numberActives>this.order-1?(this._moveKey(e,m,-1),b=this._diskRead(b.pointer)):i!=null&&i.numberActives>this.order-1?(this._moveKey(e,m,1),b=this._diskRead(b.pointer)):i!=null&&i.numberActives===this.order-1?b=this._mergeSiblings(e,m,-1):f!=null&&f.numberActives===this.order-1&&(b=this._mergeSiblings(e,m,1)))}}if(b.isLeaf&&b.numberActives>this.order-1)return this._deleteKeyFromNode(b,g),!0;if(b.isLeaf&&b.pointer===this.root)return this._deleteKeyFromNode(b,
g),!0;try{if(b.isLeaf===!1)if(i=e=null,(e=this._diskRead(b.children[g])).numberActives>this.order-1){var k=this._getMaxKeyPos(e),a=k.node.keys[k.index];b.keys[g]=a;this._diskWrite(b);b=e;a=a.key;d=h=!0}else if((e=this._diskRead(b.children[g+1])).numberActives>this.order-1)k=this._getMinKeyPos(e),a=k.node.keys[k.index],b.keys[g]=a,this._diskWrite(b),b=e,a=a.key,d=h=!0;else if((e=this._diskRead(b.children[g])).numberActives===this.order-1&&(i=this._diskRead(b.children[g+1])).numberActives===this.order-
1){var o=this._mergeNodes(e,b.keys[g],i);b.children[g]=o.pointer;g++;for(var m=g;m<b.numberActives;m++)b.children[m]=b.children[m+1],b.keys[m-1]=b.keys[m];b.children[m]=null;b.keys[m-1]=null;b.numberActives--;if(b.numberActives===0&&this.root===b.pointer)this.root=o.pointer,this._updateRootNode(o);this._diskWrite(b);b=o;d=h=!0}}catch(q){console.log("!!!"),console.log(q)}b.isLeaf&&b.numberActives>this.order-1&&d===!1&&this._deleteKeyFromNode(b,g);if(h===!1)return!0}};C.Tree.prototype._moveKey=function(a,
b,e){e===1&&b--;var d=this._diskRead(a.children[b]),g=this._diskRead(a.children[b+1]);if(e==-1){d.keys[d.numberActives]=a.keys[b];d.children[d.numberActives+1]=g.children[0];g.children[0]=null;d.numberActives++;a.keys[b]=g.keys[0];for(e=1;e<g.numberActives;e++)g.keys[e-1]=g.keys[e],g.children[e-1]=g.children[e];g.children[g.numberActives-1]=g.children[g.numberActives];g.numberActives--}else{g.children[g.numberActives+1]=g.children[g.numberActives];for(e=g.numberActives;e>0;e--)g.children[e]=g.children[e-
1],g.keys[e]=g.keys[e-1];g.keys[0]=null;g.children[0]=null;g.children[0]=d.children[d.numberActives];g.keys[0]=a.keys[b];g.numberActives++;d.children[d.numberActives]=null;a.keys[b]=d.keys[d.numberActives-1];d.keys[d.numberActives-1]=null;d.numberActives--}this._diskWrite(d);this._diskWrite(g);this._diskWrite(a)};C.Tree.prototype._mergeSiblings=function(a,b){var e,d,g;b===a.numberActives?(b--,d=this._diskRead(a.children[a.numberActives-1]),g=this._diskRead(a.children[a.numberActives])):(d=this._diskRead(a.children[b]),
g=this._diskRead(a.children[b+1]));var i=this._allocateNode();i.isLeaf=d.isLeaf;i.level=d.level;for(e=0;e<this.order-1;e++)i.keys[e]=d.keys[e],i.children[e]=d.children[e];i.keys[this.order-1]=a.keys[b];i.children[this.order-1]=d.children[this.order-1];for(e=0;e<this.order-1;e++)i.keys[e+this.order]=g.keys[e],i.children[e+this.order]=g.children[e];i.children[2*this.order-1]=g.children[this.order-1];this._diskWrite(i);a.children[b]=i.pointer;for(e=b;e<a.numberActives;e++)a.keys[e]=a.keys[e+1],a.children[e+
1]=a.children[e+2];i.numberActives=d.numberActives+g.numberActives+1;a.numberActives--;for(e=a.numberActives;e<2*this.order-1;e++)a.keys[e]=null;if(a.numberActives===0&&this.root===a.pointer)this.root=i.pointer,i.isLeaf=i.level?!1:!0;this._diskWrite(i);this.root===i.pointer&&this._updateRootNode(i);this._diskWrite(a);this._diskDelete(d);this._diskDelete(g);return i};C.Tree.prototype._deleteKeyFromNode=function(a,b){var e=2*this.order-1;if(a.numberActives<e)e=a.numberActives;var d;if(a.isLeaf===!1)return!1;
for(d=b;d<e-1;d++)a.keys[d]=a.keys[d+1];a.keys.splice(e-1,a.keys.length-(e-1));a.numberActives--;this._diskWrite(a);return!0};C.Tree.prototype._mergeNodes=function(a,b,e){var d,g;d=this._allocateNode();d.isLeaf=!0;for(g=0;g<a.numberActives;g++)d.keys[g]=a.keys[g],d.children[g]=a.children[g];d.children[a.numberActives]=a.children[a.numberActives];d.keys[a.numberActives]=b;for(g=0;g<e.numberActives;g++)d.keys[g+a.numberActives+1]=e.keys[g],d.children[g+a.numberActives+1]=e.children[g];d.children[2*
this.order-1]=e.children[e.numberActives];d.numberActives=a.numberActives+e.numberActives+1;d.isLeaf=a.isLeaf;d.level=a.level;this._diskWrite(d);this._diskDelete(a);this._diskDelete(e);return d};C.Tree.prototype.audit=function(a){var b=[],e=[],d=this,g=function(g){for(var i=0;i<e.length;i++)if(d.comparator(e[i],g)===0){var h=" !!! duplicated key "+g;a===!0&&console.log(h);b.push(h)}},i=null,d=this;this.walkNodes(function(f){a===!0&&(console.log("--- Node at "+f.level+" level"),console.log(" - pointer: "+
f.pointer),console.log(" - leaf? "+f.isLeaf),console.log(" - num actives? "+f.numberActives),console.log(" - keys: "));for(var h=f.numberActives;h<f.keys.length;h++)f.keys[h]!=null&&a===!0&&(console.log(" * warning : redundant key data"),b.push(" * warning : redundant key data"));for(h=f.numberActives+1;h<f.children.length;h++)f.children[h]!=null&&a===!0&&(console.log(" * warning : redundant children data"),b.push(" * warning : redundant key data"));if(f.isLeaf===!1)for(h=0;h<f.numberActives;h++){var k=
d._diskRead(f.children[h]).keys[d._diskRead(f.children[h]).numberActives-1].key,o=d._diskRead(f.children[h+1]).keys[0].key;a===!0&&console.log("   "+f.keys[h].key+"("+k+","+o+")");if(d.comparator(f.keys[h].key,k)===-1){var m=" !!! value max left "+k+" > key "+f.keys[h].key;a===!0&&console.log(m);b.push(m)}d.comparator(f.keys[h].key,o)===1&&(m=" !!! value min right "+o+" < key "+f.keys[h].key,a===!0&&console.log(m),b.push(m));g(f.keys[h].key);e.push(f.keys[h].key)}else{i===null?i=f.level:i!=f.level&&
(m=" !!! Leaf node with wrong level value",a===!0&&console.log(m),b.push(m));for(h=0;h<f.numberActives;h++)a===!0&&console.log(" "+f.keys[h].key),g(f.keys[h].key),e.push(f.keys[h].key)}f.pointer!=d.root&&(f.numberActives>2*d.order-1&&(a===!0&&(m=" !!!! MAX num keys restriction violated "),console.log(m),b.push(m)),f.numberActives<d.order-1&&(a===!0&&(m=" !!!! MIN num keys restriction violated "),console.log(m),b.push(m)))});return b};C.Tree.prototype.clear=function(){this.diskManager.clear();this.root=
this._allocateNode();this.root.isLeaf=!0;this.root.level=0;this._diskWrite(this.root);this._updateRootNode(this.root);this.root=this.root.pointer};C.Tree.prototype._getMaxKeyPos=function(a){for(var b={};;){if(a===null)break;if(a.isLeaf===!0){b.node=a;b.index=a.numberActives-1;break}else b.node=a,b.index=a.numberActives-1,a=this._diskRead(a.children[a.numberActives])}return b};C.Tree.prototype._getMinKeyPos=function(a){for(var b={};;){if(a===null)break;if(a.isLeaf===!0){b.node=a;b.index=0;break}else b.node=
a,b.index=0,a=this._diskRead(a.children[0])}return b};C.Node=function(){this.numberActives=0;this.isLeaf=null;this.keys=[];this.children=[];this.level=0};C.LocalStorageManager=function(a,b,e){this.name=a;this.storage=b;this.maxSize=e;this.bufferCache=new xa.PriorityQueue({maxSize:e});this.counter=this.storage.getItem("__"+this.name+"__ID_COUNTER__")||0};C.LocalStorageManager.prototype.clear=function(){for(var a=this.storage.length,b=[],e=0;e<a;e++){var d=this.storage.key(e);(d.indexOf(this.name)==
0||d.indexOf("__"+this.name)==0)&&b.push(d)}for(e=0;e<b.length;e++)this.storage.removeItem(b[e]);this.bufferCache=new xa.PriorityQueue({maxSize:this.maxSize})};C.LocalStorageManager.prototype._genIndex=function(){var a=this.name+this.counter;this.counter++;this.storage.setItem("__"+this.name+"__ID_COUNTER__",this.counter);return a};C.LocalStorageManager.prototype._diskRead=function(a){if(typeof a==="object")a=a.pointer;var b=this.bufferCache.fetch(a);if(b==null&&(b=this.storage.getItem(a),b!=null))b=
this._decode(b),b.pointer=a,this.bufferCache.push(a,b);return b};C.LocalStorageManager.prototype._diskWrite=function(a){if(a.pointer==null)a.pointer=this._genIndex();var b=a.children,e=[];if(a.isLeaf===!1)for(var d=0;d<b.length;d++)b[d]==null?e.push(null):typeof b[d]==="object"?e.push(b[d].pointer):e.push(b[d]);a.children=e;this.storage.setItem(a.pointer,this._encode(a));a.children=b;this.bufferCache.push(a.pointer,a)};C.LocalStorageManager.prototype._diskDelete=function(a){this.storage.removeItem(a.pointer);
this.bufferCache.remove(a.pointer)};C.LocalStorageManager.prototype._updateRootNode=function(a){if(a.pointer)this.storage.setItem("__"+this.name+"__ROOT_NODE__",a.pointer);else throw"Cannot set as root of the b-tree a node without pointer";};C.LocalStorageManager.prototype._readRootNode=function(){var a=this.storage.getItem("__"+this.name+"__ROOT_NODE__");return a==null?null:this._diskRead(a)};C.LocalStorageManager.prototype._encode=function(a){for(var b=""+a.numberActives,b=b+":"+a.pointer,b=b+":"+
a.level,b=b+":"+(a.isLeaf?1:0),e=0,d="",g=0;g<a.keys.length;g++)a.keys[g]!=null&&(d=typeof a.keys[g].key==="number"?d+":"+a.keys[g].key:d+":"+("_"+(a.keys[g].key.subject||"")+"_"+(a.keys[g].key.predicate||"")+"_"+(a.keys[g].key.object||"")+"_"+(a.keys[g].key.graph||"")),a.keys[g].data==null?d+=":n:":d=typeof a.keys[g].data=="string"?d+":s:"+a.keys[g].data:typeof a.keys[g].data=="number"?a.keys[g]%1==0?d+":i:"+a.keys[g].data:d+":f:"+a.keys[g].data:d+":o:"+JSON.stringify(a.keys[g].data).replace(":",
"&colon;"),e++);b=b+":"+e+d;if(a.isLeaf===!1){e="";for(g=d=0;g<a.children.length;g++)a.children[g]!=null&&(e=e+":"+a.children[g],d++);b=b+":"+d+e}return b};C.LocalStorageManager.prototype._decode=function(a){var b=new C.Node,a=a.split(":");b.numberActives=parseInt(a[0]);b.pointer=a[1];b.level=parseInt(a[2]);b.isLeaf=a[3]==="1"?!0:!1;for(var e=parseInt(a[4]),d=5,g,i,f,h=0;h<e;h++)g=a[d],g[0]=="_"?(g=g.split("_"),g={subject:parseInt(g[1])||null,predicate:parseInt(g[2])||null,object:parseInt(g[3])||
null,graph:parseInt(g[4]||null)}):g=parseInt(a[d]),i=a[d+1],f=a[d+2],i==="n"?f=void 0:i==="i"?f=parseInt(f):i==="f"?f=parseFloat(f):i==="o"&&(f=JSON.parse(f.replace("&colon;",":"))),b.keys.push({key:g,data:f}),d+=3;if(b.isLeaf===!1){e=parseInt(a[d]);d++;for(h=0;h<e;h++)b.children[h]=a[d],d++}return b};var T={NodeKey:function(a,b){this.subject=a.subject;this.predicate=a.predicate;this.object=a.object;this.graph=a.graph;this.order=b}};T.NodeKey.prototype.comparator=function(a){for(var b=0;b<this.order.length;b++){var e=
this.order[b];if(a[e]==null)break;else if(this[e]<a[e])return-1;else if(this[e]>a[e])return 1}return 0};T.Pattern=function(a){this.subject=a.subject;this.predicate=a.predicate;this.object=a.object;this.graph=a.graph;this.indexKey=[];this.keyComponents={};for(var b=[],e=[],a=["subject","predicate","object","graph"],d=0;d<a.length;d++)typeof this[a[d]]==="string"?(e.push(a[d]),this.keyComponents[a[d]]=null):(b.push(a[d]),this.keyComponents[a[d]]=this[a[d]],this.indexKey.push(a[d]));this.order=b.concat(e);
this.key=new T.NodeKey(this.keyComponents,this.order)};var U={Tree:function(a,b){if(arguments!=0)this.componentOrder=a.componentOrder,C.Tree.call(this,a.order,a.name,a.persistent,a.cacheMaxSize),this.comparator=function(a,b){for(var g=0;g<this.componentOrder.length;g++){var i=this.componentOrder[g],f=a[i],i=b[i];if(f<i)return-1;else if(f>i)return 1}return 0},this.rangeComparator=function(a,b){for(var g=0;g<this.componentOrder.length;g++){var i=this.componentOrder[g];if(b[i]==null||a[i]==null)break;
else if(a[i]<b[i])return-1;else if(a[i]>b[i])return 1}return 0},b!=null&&b(this)}};s["extends"](C.Tree,U.Tree);U.Tree.prototype.insert=function(a,b){C.Tree.prototype.insert.call(this,a,null);b&&b(!0);return!0};U.Tree.prototype.search=function(a,b){var e=C.Tree.prototype.search.call(this,a,!0);b&&b(e);return e};U.Tree.prototype.range=function(a,b){var e=null,e=typeof this.root==="string"?this._rangeTraverse(this,this._diskRead(this.root),a):this._rangeTraverse(this,this.root,a);b&&b(e);return e};U.Tree.prototype._rangeTraverse=
function(a,b,e){for(var e=e.key,d=[],g=[b],i;g.length>0;){b=g.shift();for(i=0;i<b.numberActives&&a.rangeComparator(b.keys[i].key,e)===-1;)i++;if(b.isLeaf===!0)for(;i<b.numberActives&&a.rangeComparator(b.keys[i].key,e)===0;)d.push(b.keys[i].key),i++;else{var f=a._diskRead(b.children[i]);for(g.push(f);;)if(i<b.numberActives&&a.rangeComparator(b.keys[i].key,e)===0)d.push(b.keys[i].key),i++,f=a._diskRead(b.children[i]),g.push(f);else break}}return d};var V={QuadBackend:function(a,b){if(arguments!=0){this.indexMap=
{};this.treeOrder=a.treeOrder;this.indices=["SPOG","GP","OGS","POG","GSP","OS"];this.componentOrders={SPOG:["subject","predicate","object","graph"],GP:["graph","predicate","subject","object"],OGS:["object","graph","subject","predicate"],POG:["predicate","object","graph","subject"],GSP:["graph","subject","predicate","object"],OS:["object","subject","predicate","graph"]};for(var e=0;e<this.indices.length;e++){var d=this.indices[e];this.indexMap[d]=new U.Tree({order:this.treeOrder,componentOrder:this.componentOrders[d],
persistent:a.persistent,name:(a.name||"")+d,cacheMaxSize:a.cacheMaxSize})}b&&b(this)}}};V.QuadBackend.prototype.clear=function(){for(var a=0;a<this.indices.length;a++)this.indexMap[this.indices[a]].clear()};V.QuadBackend.prototype._indexForPattern=function(a){for(var a=a.indexKey,b=this.indices,e=0;e<b.length;e++)for(var d=b[e],g=this.componentOrders[d],i=0;i<g.length;i++){if(s.include(a,g[i])===!1)break;if(i==a.length-1)return d}return"SPOG"};V.QuadBackend.prototype.index=function(a,b){for(var e=
0;e<this.indices.length;e++)this.indexMap[this.indices[e]].insert(a);b&&b(!0);return!0};V.QuadBackend.prototype.range=function(a,b){var e=this.indexMap[this._indexForPattern(a)].range(a);b&&b(e);return e};V.QuadBackend.prototype.search=function(a,b){var e=this.indexMap[this.indices[0]].search(a);b&&b(e!=null);return e!=null};V.QuadBackend.prototype["delete"]=function(a,b){for(var e,d=0;d<this.indices.length;d++)e=this.indices[d],e=this.indexMap[e],e["delete"](a);b&&b(!0);return!0};var G={Lexicon:function(a,
b){this.name=b||"";this.storage=null;try{this.storage=window.localStorage}catch(e){}if(this.storage==null)this.storage={setItem:function(){},getItem:function(){return null},removeItem:function(){},key:function(){return""},length:0};this.uriToOID={};this.OIDToUri={};this.literalToOID={};this.OIDToLiteral={};this.blankToOID={};this.OIDToBlank={};this.defaultGraphOid=0;this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph";this.defaultGraphUriTerm={token:"uri",prefix:null,
suffix:null,value:this.defaultGraphUri,oid:this.defaultGraphOid};this.oidCounter=parseInt(this.storage.getItem(this.pointer("oidCounter")))||1;this.storage.getItem(this.pointer("knownGraphs"))==null?(this.knownGraphs={},this.storage.setItem(this.pointer("knownGraphs"),JSON.stringify(this.knownGraphs))):this.knownGraphs=JSON.parse(this.storage.getItem(this.pointer("knownGraphs")));a!=null&&a(this)}};G.Lexicon.prototype.updateAfterWrite=function(){this.storage.setItem(this.pointer("oidCounter"),""+
this.oidCounter)};G.Lexicon.prototype.pointer=function(a,b){a=="uriToOID"?a="uo":a=="OIDToUri"?a="ou":a=="literalToOID"?a="lo":a=="OIDToLiteral"?a="ok":a=="blankToOID"?a="bo":a=="OIDToBlank"&&(a="ob");return b==null?this.name+"_l_"+a:this.name+"_l_"+a+"_"+b};G.Lexicon.prototype.clear=function(){this.uriToOID={};this.OIDToUri={};this.literalToOID={};this.OIDToLiteral={};this.blankToOID={};this.OIDToBlank={};for(var a=this.storage.length,b=this.name+"_l_",e=[],d=0;d<a;d++){var g=this.storage.key(d);
g.indexOf(b)==0&&e.push(g)}for(d=0;d<e.length;d++)this.storage.removeItem(e[d])};G.Lexicon.prototype.registerGraph=function(a){a!=this.defaultGraphOid&&(this.knownGraphs[a]=!0,this.storage.setItem(this.pointer("knownGraphs"),JSON.stringify(this.knownGraphs)));return!0};G.Lexicon.prototype.registeredGraphs=function(a){var b=[],e;for(e in this.knownGraphs)a===!0?b.push(this.retrieve(e)):b.push(e);return b};G.Lexicon.prototype.registerUri=function(a){if(a===this.defaultGraphUri)return this.defaultGraphOid;
else{if(this.uriToOID[a]==null){var b=this.storage.getItem(this.pointer("uriToOID",a));if(b==null){var b=this.oidCounter,e="u"+b;this.oidCounter++;this.uriToOID[a]=[b,0];this.OIDToUri[e]=a;this.storage.setItem(this.pointer("uriToOID",a),b+":0");this.storage.setItem(this.pointer("OIDToUri",e),a)}else{var d=b.split(":"),b=parseInt(d[0]),e="u"+b,d=parseInt(d[1])+1;this.uriToOID[a]=[b,d];this.OIDToUri[e]=a;this.storage.setItem(this.pointer("uriToOID",a),b+":0")}}else e=this.uriToOID[a],b=e[0],d=e[1]+
1,this.uriToOID[a]=[b,d],this.storage.setItem(this.pointer("uriToOID",a),b+":"+d);return b}};G.Lexicon.prototype.resolveUri=function(a){if(a===this.defaultGraphUri)return this.defaultGraphOid;else{var b=this.uriToOID[a];if(b!=null)return b[0];else if(b=this.storage.getItem(this.pointer("uriToOID",a)),b==null)return-1;else{var e=b.split(":"),b=parseInt(e[0]),d="u"+b,e=parseInt(e[1]);this.uriToOID[a]=[b,e];this.OIDToUri[d]=a;return b}}};G.Lexicon.prototype.resolveUriCost=function(a){return a===this.defaultGraphUri?
this.defaultGraphOid:(a=this.uriToOID[a],a!=null?a[1]:-1)};G.Lexicon.prototype.registerBlank=function(){var a=this.oidCounter;this.oidCounter++;a=""+a;this.storage.setItem(this.pointer("OIDToBlank",a),!0);this.OIDToBlank[a]=!0;return a};G.Lexicon.prototype.resolveBlank=function(){var a=this.oidCounter;this.oidCounter++;return""+a};G.Lexicon.prototype.resolveBlankCost=function(){return 0};G.Lexicon.prototype.registerLiteral=function(a){if(this.literalToOID[a]==null){var b=this.storage.getItem(this.pointer("literalToOID",
a));if(b==null){var b=this.oidCounter,e="l"+b;this.oidCounter++;this.literalToOID[a]=[b,0];this.OIDToLiteral[e]=a;this.storage.setItem(this.pointer("literalToOID",a),b+":0");this.storage.setItem(this.pointer("OIDToLiteral",e),a)}else e=b.split(":"),b=parseInt(e[0]),e=parseInt(e[1])+1,this.literalToOID[a]=[b,e],this.storage.setItem(this.pointer("literalToOID",a),b+":"+e)}else e=this.literalToOID[a],b=e[0],e=e[1]+1,this.storage.setItem(this.pointer("literalToOID",a),b+":"+e),this.literalToOID[a]=[b,
e];return b};G.Lexicon.prototype.resolveLiteral=function(a){var b=this.literalToOID[a];if(b!=null)return b[0];else{var e=this.storage.getItem(this.pointer("literalToOID",a));return e!=null?(b=e.split(":"),e=parseInt(b[0]),b=parseInt(b[1]),this.literalToOID[a]=[e,b],this.OIDToLiteral["l"+e]=a,e):-1}};G.Lexicon.prototype.resolveLiteralCost=function(a){a=this.literalToOID[a];return a!=null?a[1]:0};G.Lexicon.prototype.parseLiteral=function(a){var b=a.lastIndexOf("@");if(b!=-1&&a[b-1]==='"'){var e=a.substring(1,
b-1),a=a.substring(b+1,a.length);return{token:"literal",value:e,lang:a}}b=a.lastIndexOf("^^");if(b!=-1&&a[b-1]==='"'&&a[b+2]==="<"&&a[a.length-1]===">")return e=a.substring(1,b-1),a=a.substring(b+3,a.length-1),{token:"literal",value:e,type:a};e=a.substring(1,a.length-1);return{token:"literal",value:e}};G.Lexicon.prototype.parseUri=function(a){return{token:"uri",value:a}};G.Lexicon.prototype.retrieve=function(a){var b;try{if(a===this.defaultGraphOid)return{token:"uri",value:this.defaultGraphUri,prefix:null,
suffix:null,defaultGraph:!0};else{var e=this.OIDToUri["u"+a];if(e!=null)return this.parseUri(e);else{var d=this.OIDToLiteral["l"+a];if(d!=null)return this.parseLiteral(d);else{var g=this.OIDToBlank[""+a];if(g!=null)return{token:"blank",value:"_:"+a};else if(e=this.storage.getItem(this.pointer("OIDToUri","u"+a)),e!=null){this.OIDToUri["u"+a]=e;b=this.storage.getItem(this.pointer("uriToOID",e));var i=b.split(":"),f=parseInt(i[1]);this.uriToOID[e]=[a,f];return this.parseUri(e)}else if(d=this.storage.getItem(this.pointer("OIDToLiteral",
"l"+a)),d!=null){this.OIDToLiteral["l"+a]=d;b=this.storage.getItem(this.pointer("literalToOID",d));var h=b.split(":"),a=parseInt(h[0]),f=parseInt(h[1]);this.literalToOID[d]=[a,f];return this.parseLiteral(d)}else if(g=this.storage.getItem(this.pointer("OIDToBlank",""+a)),g!=null)return this.OIDToBlank[""+a]=!0,{token:"blank",value:"_:"+a};else throw"Null value for OID";}}}}catch(k){throw console.log("error in lexicon retrieving OID:"),console.log(a),k.message&&console.log(k.message),k.stack&&console.log(k.stack),
Error("Unknown retrieving OID in lexicon:"+a);}};G.Lexicon.prototype.unregister=function(a,b){try{return this.unregisterTerm(a.subject.token,b.subject),this.unregisterTerm(a.predicate.token,b.predicate),this.unregisterTerm(a.object.token,b.object),a.graph!=null&&this.unregisterTerm(a.graph.token,b.graph),!0}catch(e){return console.log("Error unregistering quad"),console.log(e.message),!1}};G.Lexicon.prototype.unregisterTerm=function(a,b){if(a==="uri"){if(b!=this.defaultGraphOid){var e="u"+b,d=this.OIDToUri[e],
g=this.uriToOID[d],i=g[1];if(""+g[0]===""+b)i===0?(delete this.OIDToUri[e],delete this.uriToOID[d],delete this.knownGraphs[b]):this.uriToOID[d]=[b,i-1];else throw"Not matching OID : "+b+" vs "+g[0];}}else if(a==="literal")if(this.oidCounter++,e="l"+b,d=this.OIDToLiteral[e],g=this.literalToOID[d],i=g[1],""+g[0]===""+b)i===0?(delete this.OIDToLiteral[e],delete this.literalToOID[d]):this.literalToOID[d]=[b,i-1];else throw"Not matching OID : "+b+" vs "+g[0];else a==="blank"&&delete this.OIDToBlank[""+
b]};var P={};P.load=function(a,b,e){jQuery.ajax({url:a,headers:{Accept:b},success:function(a,b,i){if((""+i.status)[0]=="2"){for(var b=i.getAllResponseHeaders().split("\n"),i={},f=0;f<b.length;f++){var h=b[f].split(":");i[h[0]]=h[1]}e(!0,{headers:i,data:a})}},error:function(a){(""+a.status)[0]=="3"?redirection==0?e(!1,500):(a=a.getAllResponseHeaders().Location||a.getAllResponseHeaders().location,a!=null?P.load(a,b,e,redirection-1):e(!1,500)):e(!1,a.statusCode())}})};var ya=null;(function(){var a=function(a,
e){a.stack="";for(var b in e)a[b]=e[b]};if(typeof window!=="undefined"){var b=window.jsonld=window.jsonld||{};Exception=function(e){a(this,e)};if(!Object.keys)Object.keys=function(a){if(a!==Object(a))throw new TypeError("Object.keys called on non-object");var e=[],b;for(b in a)Object.prototype.hasOwnProperty.call(a,b)&&e.push(b);return e};if(!Array.prototype.filter)Array.prototype.filter=function(a,e){if(this==null)throw new TypeError;var b=Object(this),g=b.length>>>0;if(typeof a!="function")throw new TypeError;
for(var d=[],f=0;f<g;f++)if(f in b){var i=b[f];a.call(e,i,f,b)&&d.push(i)}return d}}else typeof module!=="undefined"&&module.exports&&(b={},Exception=function(e){a(this,e);this.stack=Error().stack});ya=b;var e={rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",owl:"http://www.w3.org/2002/07/owl#",xsd:"http://www.w3.org/2001/XMLSchema#",dcterms:"http://purl.org/dc/terms/",foaf:"http://xmlns.com/foaf/0.1/",cal:"http://www.w3.org/2002/12/cal/ical#",vcard:"http://www.w3.org/2006/vcard/ns# ",
geo:"http://www.w3.org/2003/01/geo/wgs84_pos#",cc:"http://creativecommons.org/ns#",sioc:"http://rdfs.org/sioc/ns#",doap:"http://usefulinc.com/ns/doap#",com:"http://purl.org/commerce#",ps:"http://purl.org/payswarm#",gr:"http://purl.org/goodrelations/v1#",sig:"http://purl.org/signature#",ccard:"http://purl.org/commerce/creditcard#"},d={xsd:"http://www.w3.org/2001/XMLSchema#"},g={"boolean":d.xsd+"boolean","double":d.xsd+"double",integer:d.xsd+"integer"},i=function(a,e,b){e in a?a[e].constructor===Array?
a[e].push(b):a[e]=[a[e],b]:a[e]=b},f=function(a){var e;if(a.constructor===Object){e={};var b=Object.keys(a).sort(),g;for(g in b){var d=b[g];e[d]=f(a[d])}}else if(a.constructor===Array)for(g in e=[],a)e[g]=f(a[g]);else e=a;return e},h=function(a){var e={"@id":"@id","@language":"@language","@literal":"@literal","@type":"@type"};if(a){var b={},g;for(g in a)a[g].constructor===String&&a[g]in e&&(b[a[g]]=g);for(g in b)e[g]=b[g]}return e},k=function(a,e){var b=null;e in a&&(a[e].constructor===String?b=a[e]:
a[e].constructor===Object&&"@id"in a[e]&&(b=a[e]["@id"]));return b},o=function(a,e,b){var g=null,d;for(d in a)if(d.length>0&&d[0]!=="@"&&e===k(a,d)){g=d;b!==null&&(b[d]=f(a[d]));break}g===null&&e==="@type"&&(g=h(a)["@type"]);if(g===null)for(d in a)if(d.length>0&&d[0]!=="@"){var i=k(a,d);if(i!==null&&e.indexOf(i)===0&&e.length>i.length){g=d+":"+e.substr(i.length);b!==null&&(b[d]=f(a[d]));break}}g===null&&(g=e);return g},m=function(a,e,b){var g=e,d=h(a),i=e.indexOf(":");if(i!==-1)d=e.substr(0,i),d in
a&&(g=k(a,d)+e.substr(i+1),b!==null&&(b[d]=f(a[d])));else if(e in a)g=k(a,e),b!==null&&(b[e]=f(a[e]));else for(var m in d)if(e===d[m]){g=m;break}return g},q=function(a){var e=!1;a!==null&&a.constructor===Object&&!("@literal"in a)&&(e=Object.keys(a).length>1||!("@id"in a));return e};b.normalize=function(a){return(new t).normalize(a)};b.expand=function(a){return(new t).expand({},null,a)};b.compact=function(a,e){var g=null;if(e!==null){var e=b.expand(e),d;e.constructor===Array?(g=[],d=e):d=[e];a.constructor===
Array&&(a=b.mergeContexts({},a));for(var i in d){var h={},n=(new t).compact(f(a),null,d[i],h);if(Object.keys(h).length>0){var k=h,h={},m=Object.keys(k).sort(),o=void 0;for(o in m){var q=m[o];h[q]=k[q]}k=Object.keys(n);k.sort();k.unshift("@context");n["@context"]=h;var h={},v;for(v in k)m=k[v],h[m]=n[m];n=h}g===null?g=n:g.push(n)}}return g};b.mergeContexts=function(a,e){a.constructor===Array&&(a=b.mergeContexts({},a));var g=f(a);if(e.constructor===Array)for(var d in e)g=b.mergeContexts(g,e[d]);else{for(var i in e)if(i.indexOf("@")!==
0)for(var h in g)if(g[h]===e[i]){delete g[h];break}for(i in e)g[i]=f(e[i])}return g};b.expandTerm=m;b.compactIri=function(a,e){return o(a,e,null)};b.frame=function(a,e,b){return(new t).frame(a,e,b)};b.toTriples=function(a,e,g){var d=null,a=b.normalize(a),g=g||null;g===null&&(d=[],g=function(a,b,g){d.push({subject:s.lexicalFormTerm(a),predicate:s.lexicalFormTerm(b),object:s.lexicalFormTerm(g),graph:e})});var f=!1,i;for(i in a){var h=a[i],n=h["@id"],n=n[0]=="_"?{token:"blank",value:n.split(":")[1]}:
{token:"uri",value:n},k;for(k in h)if(k!=="@id"){var m=h[k];m.constructor!==Array&&(m=[m]);for(var o in m)if(f=m[o],k==="@type"||k==="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"?(k="http://www.w3.org/1999/02/22-rdf-syntax-ns#type",f={token:"uri",value:f}):typeof f==="string"?f={token:"literal",value:f}:f["@id"]!=null?f=f["@id"][0]=="_"?{token:"blank",value:f["@id"].split(":")[1]}:{token:"uri",value:f["@id"]}:f["@type"]!=null?f={token:"literal",value:f["@literal"],type:f["@type"]}:f["@language"]!=
null&&(f={token:"literal",value:f["@literal"],lang:f["@language"]}),f=g(n,{token:"uri",value:k},f)===!1)break;if(f)break}if(f)break}return d};b.resolve=function(a,e,b){var g={},d=function(a,e){if(a.constructor===Array)for(var b in a)d(a[b]);else if(a.constructor===Object)for(var f in a)if(f==="@context")if(a[f].constructor===Array){var i=a[f];for(b in i)i[b].constructor===String&&(e?i[b]=g[i[b]]:g[i[b]]={})}else a[f].constructor===String&&(e?a[f]=g[a[f]]:g[a[f]]={})};d(a,!1);var f=Object.keys(g).length,
i=null;if(f===0)b(a,i);else for(var h in g)e(h,function(e,n){--f;if(e===null)i=i||[],i.push({url:h,error:n});else try{g[h]=e.constructor===String?JSON.parse(e)["@context"]:e["@context"]}catch(k){i=i||[],i.push({url:h,error:k})}f===0&&(i===null&&d(a,!0),b(a,i))})};var t=function(){};t.prototype.compact=function(a,e,b,d){var i,k=h(a);if(b===null)i=null,this.getCoerceType(a,e,d);else if(b.constructor===Array){i=[];for(var m in b)i.push(this.compact(a,e,b[m],d))}else if(b.constructor===Object&&"@id"in
b&&b["@id"].constructor===Array)i={},i[k["@id"]]=this.compact(a,e,b["@id"],d);else if(q(b)){i={};for(var t in b)if(b[t]!=="@context"&&(k=o(a,t,d),k!==t||!(k in i)))i[k]=this.compact(a,t,b[t],d)}else{e=this.getCoerceType(a,e,d);m=null;b.constructor===Object?"@language"in b||(m="@type"in b?b["@type"]:"@id"in b?"@id":e):b.constructor===String&&(m=e);if(e===null&&(m===g["boolean"]||m===g.integer||m===g["double"]))e=m;if(e!==null)if(m===null)throw{message:"Cannot coerce type when a language is specified. The language information would be lost."};
else if(m!==e)throw new Exception({message:"Cannot coerce type because the type does not match.",type:m,expected:e});else b.constructor===Object?"@id"in b?i=b["@id"]:"@literal"in b&&(i=b["@literal"]):i=b,e===g["boolean"]?i=i==="true"||i!=0:e===g["double"]?i=parseFloat(i):e===g.integer&&(i=parseInt(i));else if(b.constructor===Object)for(t in i={},b)i[k[t]]=b[t];else i=f(b);m==="@id"&&(i.constructor===Object?i[k["@id"]]=o(a,i[k["@id"]],d):i=o(a,i,d))}return i};t.prototype.expand=function(a,e,d){var k;
if(d===null)k=null;else if(e===null&&d.constructor===String)k=m(a,d,null);else if(d.constructor===Array){k=[];for(var o in d)k.push(this.expand(a,e,d[o]))}else if(d.constructor===Object){"@context"in d&&(a=b.mergeContexts(a,d["@context"]));k={};for(var q in d)q==="@embed"||q==="@explicit"||q==="@default"||q==="@omitDefault"?i(k,q,f(d[q])):q!=="@context"&&i(k,m(a,q,null),this.expand(a,q,d[q]))}else{o=this.getCoerceType(a,e,null);k=h(a);if(o===null&&(d.constructor===Number||d.constructor===Boolean))o=
d.constructor===Boolean?g["boolean"]:(""+d).indexOf(".")==-1?g.integer:g["double"];e===k["@id"]||e===k["@type"]?k=m(a,d,null):o!==null?(k={},o==="@id"?k["@id"]=m(a,d,null):(k["@type"]=o,o===g["double"]&&(d=d.toExponential(6).replace(/(e(?:\+|-))([0-9])$/,"$10$2")),k["@literal"]=""+d)):k=""+d}return k};t.prototype.normalize=function(a){var b=[];if(a!==null){this.ng={tmp:null,c14n:null};var g=this.expand(e,null,a);this.nameBlankNodes(g);a={};Ha(null,null,g,a);for(var d in a){var g=a[d],f={},i=Object.keys(g).sort(),
h;for(h in i){var n=i[h];f[n]=g[n]}b.push(f)}this.canonicalizeBlankNodes(b);b.sort(function(a,e){return y(a["@id"],e["@id"])})}return b};t.prototype.getCoerceType=function(a,e,b){var g=null,e=m(a,e,null);e==="@id"||e==="@type"?g="@id":(e=o(a,e,null),e in a&&a[e].constructor===Object&&"@type"in a[e]&&(g=m(a,a[e]["@type"],b),b!==null&&(b[e]=f(a[e]))));return g};var L=function(a){return a.indexOf("_:")===0},A=function(a){return a.constructor===Object&&"@id"in a&&L(a["@id"])},y=function(a,e){var b=0;
if(a.constructor===Array&&e.constructor===Array)for(var g=0;g<a.length&&b===0;++g)b=y(a[g],e[g]);else b=a<e?-1:a>e?1:0;return b},C=function(a,e,b){var g=0;b in a?g=b in e?y(a[b],e[b]):-1:b in e&&(g=1);return g},z=function(a,e){var b=0;a.constructor===String?b=e.constructor!==String?-1:y(a,e):e.constructor===String?b=1:(b=C(a,e,"@literal"),b===0&&("@literal"in a?(b=C(a,e,"@type"),b===0&&(b=C(a,e,"@language"))):b=y(a["@id"],e["@id"])));return b},D=function(a,e){var b=0,g;for(g in a)if(g!=="@id"){b=
y(a[g].constructor===Array?a[g].length:1,e[g].constructor===Array?e[g].length:1);if(b===0){var d=a[g],f=e[g];d.constructor!==Array&&(d=[d],f=[f]);d=d.filter(function(a){return!A(a)});f=f.filter(function(a){return!A(a)});b=y(d.length,f.length)}if(b===0){d.sort(z);f.sort(z);for(var i=0;i<d.length&&b===0;++i)b=z(d[i],f[i])}if(b!==0)break}return b},E=function(a){var e=-1,b={next:function(){++e;return b.current()},current:function(){return"_:"+a+e},inNamespace:function(e){return e.indexOf("_:"+a)===0}};
return b},I=function(a,e,b){if(a!==null)if(a.constructor===Array)for(var g in a)I(a[g],e,b);else if(a.constructor===Object){"@id"in a?a["@id"].constructor==Array?I(a["@id"],e,b):q(a)&&(e[a["@id"]]=a):q(a)&&(!("@id"in a)||A(a))&&b.push(a);for(var d in a)I(a[d],e,b)}},Ha=function(a,e,b,g){var d=null;if(b!==null)if(b.constructor===Array)for(var i in b)Ha(a,e,b[i],g);else if(b.constructor===Object)if("@literal"in b||e==="@type")d=f(b);else if(b["@id"].constructor===Array){if(a!==null)throw{message:"Embedded graph literals cannot be flattened."};
for(var h in b["@id"])Ha(a,e,b["@id"][h],g)}else{b["@id"]in g?i=g[b["@id"]]:(i={"@id":b["@id"]},g[b["@id"]]=i);var d={"@id":i["@id"]},n;for(n in b)h=b[n],h!==null&&n!=="@id"&&(n in i?i[n].constructor!==Array&&(i[n]=[i[n]]):i[n]=[],Ha(i[n],n,h,g),i[n].length===1&&(i[n]=i[n][0]))}else d=b;d!==null&&a!==null&&(a.constructor===Array?(e=!1,d.constructor===Object&&"@id"in d&&(e=a.filter(function(a){return a.constructor===Object&&"@id"in a&&a["@id"]===d["@id"]}).length>0),e||a.push(d)):a[e]=d)};t.prototype.nameBlankNodes=
function(a){var e=this.ng.tmp=E("tmp"),b={},g=[];I(a,b,g);for(var d in g)if(a=g[d],!("@id"in a)){for(;e.next()in b;);a["@id"]=e.current();b[e.current()]=a}};t.prototype.renameBlankNode=function(a,e){var b=a["@id"];a["@id"]=e;var g=this.subjects;g[e]=g[b];delete g[b];this.edges.refs[e]=this.edges.refs[b];this.edges.props[e]=this.edges.props[b];delete this.edges.refs[b];delete this.edges.props[b];var d=this.edges.refs[e].all,f;for(f in d){var i=d[f].s;i===b&&(i=e);var h=g[i],n=this.edges.props[i].all,
k;for(k in n)if(n[k].s===b){n[k].s=e;var i=n[k].p,i=h[i].constructor===Object?[h[i]]:h[i].constructor===Array?h[i]:[],m;for(m in i)i[m].constructor===Object&&"@id"in i[m]&&i[m]["@id"]===b&&(i[m]["@id"]=e)}}n=this.edges.props[e].all;for(f in n){var i=n[f].s,d=this.edges.refs[i].all,o;for(o in d)if(d[o].s===b)d[o].s=e}};t.prototype.canonicalizeBlankNodes=function(a){this.renamed={};this.mappings={};this.serializations={};var e=this.edges={refs:{},props:{}},b=this.subjects={},g=[],d;for(d in a){var f=
a[d]["@id"];b[f]=a[d];e.refs[f]={all:[],bnodes:[]};e.props[f]={all:[],bnodes:[]};L(f)&&g.push(a[d])}this.collectEdges();var a=this.ng.c14n=E("c14n"),i=this.ng.tmp;for(d in g){var h=g[d],f=h["@id"];if(a.inNamespace(f)){for(;i.next()in b;);this.renameBlankNode(h,i.current());f=h["@id"]}this.serializations[f]={props:null,refs:null}}for(var i=!0,n=this;g.length>0;){i&&(i=!1,g.sort(function(a,e){return n.deepCompareBlankNodes(a,e)}));var h=g.shift(),f=h["@id"],h=["props","refs"],k;for(k in h){var m=h[k];
if(this.serializations[f][m]===null){var o={};o[f]="s1"}else o=this.serializations[f][m].m;var q=Object.keys(o);q.sort(function(a,e){return y(o[a],o[e])});var t=[];for(d in q){var v=q[d];!a.inNamespace(f)&&v in b&&(this.renameBlankNode(b[v],a.next()),t.push(v))}q=g;g=[];for(d in q){var v=q[d],s=v["@id"];if(!a.inNamespace(s)){for(var A in t)this.markSerializationDirty(s,t[A],m)&&(i=!0);g.push(v)}}}}for(var C in e.props)if(e.props[C].bnodes.length>0){var h=b[C],D;for(D in h)D.indexOf("@")!==0&&h[D].constructor===
Array&&h[D].sort(z)}};MappingBuilder=function(){this.count=1;this.processed={};this.mapping={};this.adj={};this.keyStack=[{keys:["s1"],idx:0}];this.done={};this.s=""};MappingBuilder.prototype.copy=function(){var a=new MappingBuilder;a.count=this.count;a.processed=f(this.processed);a.mapping=f(this.mapping);a.adj=f(this.adj);a.keyStack=f(this.keyStack);a.done=f(this.done);a.s=this.s;return a};MappingBuilder.prototype.mapNode=function(a){a in this.mapping||(this.mapping[a]=a.indexOf("_:c14n")===0?"c"+
a.substr(6):"s"+this.count++);return this.mapping[a]};MappingBuilder.prototype.serialize=function(a,e){if(this.keyStack.length>0)for(var b=this.keyStack.pop();b.idx<b.keys.length;++b.idx){var g=b.keys[b.idx];if(!(g in this.adj)){this.keyStack.push(b);break}if(g in this.done)this.s+="_"+g;else{this.done[g]=!0;var d=g,g=this.adj[g],f=g.i;if(f in a){var i=a[f],h="",n=!0,k=void 0;for(k in i)if(k!=="@id"){n?n=!1:h+="|";h+="<"+k+">";var m=i[k].constructor===Array?i[k]:[i[k]],o;for(o in m){var q=m[o];q.constructor===
Object?"@id"in q?h+=L(q["@id"])?"_:":"<"+q["@id"]+">":(h+='"'+q["@literal"]+'"',"@type"in q?h+="^^<"+q["@type"]+">":"@language"in q&&(h+="@"+q["@language"])):h+='"'+q+'"'}}d+="["+h+"]";i=!0;d+="[";var f=e.refs[f].all,t;for(t in f)i?i=!1:d+="|",d+="<"+f[t].p+">",d+=L(f[t].s)?"_:":"<"+f[t].s+">";d+="]"}d+=g.k.join("");this.s+=d;this.keyStack.push({keys:g.k,idx:0});this.serialize(a,e)}}};t.prototype.markSerializationDirty=function(a,e,b){var g=!1,a=this.serializations[a];a[b]!==null&&e in a[b].m&&(a[b]=
null,g=!0);return g};var F=function(a,e){var b=0;return b=a.length==e.length?y(a,e):a.length>e.length?y(a.substr(0,e.length),e):y(a,e.substr(0,a.length))};t.prototype.serializeCombos=function(a,e,b,g,d,i,h){if(h.length>0){i=f(i);i[g.mapNode(h[0].s)]=h[0].s;for(var n=g.copy(),h=h.slice(1),k=Math.max(1,h.length),m=0;m<k;++m){var o=m===0?g:n.copy();this.serializeCombos(a,e,b,o,d,i,h);h.unshift.apply(h,h.splice(1,h.length))}}else if(h=Object.keys(i).sort(),g.adj[b]={i:e,k:h,m:i},g.serialize(this.subjects,
this.edges),a[d]===null||F(g.s,a[d].s)<=0){for(n in h)this.serializeBlankNode(a,i[h[n]],g,d);g.serialize(this.subjects,this.edges);if(a[d]===null||F(g.s,a[d].s)<=0&&g.s.length>=a[d].s.length)a[d]={s:g.s,m:g.mapping}}};t.prototype.serializeBlankNode=function(a,e,b,g){if(!(e in b.processed)){b.processed[e]=!0;var d=b.mapNode(e),f=b.copy(),i=this.edges[g][e].bnodes,h={},n=[],k;for(k in i)i[k].s in b.mapping?h[b.mapping[i[k].s]]=i[k].s:n.push(i[k]);i=Math.max(1,n.length);for(k=0;k<i;++k){var m=k===0?
b:f.copy();this.serializeCombos(a,e,d,m,g,h,n)}}};t.prototype.deepCompareBlankNodes=function(a,e){var b=0,g=a["@id"],d=e["@id"];if(g===d)b=0;else if(b=this.shallowCompareBlankNodes(a,e),b===0)for(var i=["props","refs"],h=0;b===0&&h<i.length;++h){var b=i[h],n=this.serializations[g],k=this.serializations[d];if(n[b]===null){var m=new MappingBuilder;if(b==="refs")m.mapping=f(n.props.m),m.count=Object.keys(m.mapping).length+1;this.serializeBlankNode(n,g,m,b)}if(k[b]===null){m=new MappingBuilder;if(b===
"refs")m.mapping=f(k.props.m),m.count=Object.keys(m.mapping).length+1;this.serializeBlankNode(k,d,m,b)}b=y(n[b].s,k[b].s)}return b};t.prototype.shallowCompareBlankNodes=function(a,e){var b=0,g=Object.keys(a),d=Object.keys(e),b=y(g.length,d.length);b===0&&(b=y(g.sort(),d.sort()));b===0&&(b=D(a,e));if(b===0)var f=this.edges.refs[a["@id"]].all,i=this.edges.refs[e["@id"]].all,b=y(f.length,i.length);if(b===0)for(g=0;g<f.length&&b===0;++g)b=this.compareEdges(f[g],i[g]);return b};t.prototype.compareEdges=
function(a,e){var b=0,g=L(a.s),d=L(e.s),f=this.ng.c14n;g!=d?b=g?1:-1:(g||(b=y(a.s,e.s)),b===0&&(b=y(a.p,e.p)),b===0&&f!==null&&(g=f.inNamespace(a.s),f=f.inNamespace(e.s),g!=f?b=g?1:-1:g&&(b=y(a.s,e.s))));return b};t.prototype.collectEdges=function(){var a=this.edges.refs,e=this.edges.props,b;for(b in this.subjects){var g=this.subjects[b],d;for(d in g)if(d!=="@id"){var f=g[d],f=f.constructor!==Array?[f]:f,i;for(i in f){var h=f[i];h.constructor===Object&&"@id"in h&&h["@id"]in this.subjects&&(h=h["@id"],
a[h].all.push({s:b,p:d}),e[b].all.push({s:h,p:d}))}}}var n=this;for(b in a)a[b].all.sort(function(a,e){return n.compareEdges(a,e)}),a[b].bnodes=a[b].all.filter(function(a){return L(a.s)});for(b in e)e[b].all.sort(function(a,e){return n.compareEdges(a,e)}),e[b].bnodes=e[b].all.filter(function(a){return L(a.s)})};var G=function(a,e){var b=!1;if(!("@type"in e)){var g=Object.keys(e).filter(function(a){return a.indexOf("@")!==0});if(g.length===0)b=!0;else if(a.constructor===Object&&"@id"in a){var b=!0,
d;for(d in g)if(!(g[d]in a)){b=!1;break}}}return b},M=function(a,e,b,g,d,f,i,h){var n=e["@id"],k=n in g?g[n]:null;if(("@embed"in b&&b["@embed"]||!("@embed"in b)&&h.defaults.embedOn)&&(k===null||k.autoembed&&!d)){if(k===null)k={},g[n]=k;else if(k.parent!==null){if(k.parent[k.key].constructor===Array){var m=k.parent[k.key],o;for(o in m)if(m[o].constructor===Object&&"@id"in m[o]&&m[o]["@id"]===n){m[o]={"@id":e["@id"]};break}}else k.parent[k.key]={"@id":e["@id"]};var q=function(a){var e=Object.keys(g),
b;for(b in e)b=e[b],b in g&&g[b].parent!==null&&g[b].parent["@id"]===a&&(delete g[b],q(b))};q(n)}k.autoembed=d;k.parent=f;k.key=i;if(b["@explicit"]===!0||h.defaults.explicitOn)for(t in e)t!=="@id"&&!(t in b)&&delete e[t];d=Object.keys(e);for(o in d){var t=d[o];if(t.indexOf("@")!==0){t in b?(f=b[t],i=!1):(f=e[t].constructor===Array?[]:{},i=!0);var n=e[t],n=n.constructor===Array?n:[n],v;for(v in n)n[v].constructor===Object&&"@id"in n[v]&&n[v]["@id"]in a&&(n[v]=a[n[v]["@id"]]);e[t]=P(a,n,f,g,i,e,t,h)}}for(t in b)if(t.indexOf("@")!==
0&&(!(t in e)||e[t]===null))f=b[t],f.constructor===Array?e[t]=[]:(f.constructor===Array&&(f=f.length>0?f[0]:{}),f["@omitDefault"]===!0||h.defaults.omitDefaultOn||(e[t]="@default"in f?f["@default"]:null))}else e={"@id":e["@id"]};return e},P=function(a,e,b,g,d,f,i,h){var n=null,k=-1,m;b.constructor===Array?(n=[],m=b,m.length===0&&m.push({})):(m=[b],k=1);for(var o=[],t=0;t<m.length&&k!==0;++t){b=m[t];if(b.constructor!==Object)throw{message:"Invalid JSON-LD frame. Frame must be an object or an array.",
frame:b};o[t]=[];for(var s=0;s<e.length&&k!==0;++s){var L=e[s],y=!1,A="@type";if("@type"in b&&L.constructor===Object&&A in L)for(var C=L[A].constructor===Array?L[A]:[L[A]],D=b[A].constructor===Array?b[A]:[b[A]],z=0;z<D.length&&!y;++z){var A=D[z],E;for(E in C)if(C[E]===A){y=!0;break}}if(y||G(L,b))o[t].push(L),--k}}for(var bb in o)for(var qc in o[bb])b=m[bb],e=o[bb][qc],q(e)&&(e=M(a,e,b,g,d,f,i,h)),n===null?n=e:(b=e!==null&&e.constructor===Object&&"@id"in e&&Object.keys(e).length===1&&e["@id"]in g,
f===null&&b||n.push(e));return n};t.prototype.frame=function(a,e,g){var a=b.normalize(a),d=null;if("@context"in e)d=f(e["@context"]),e=b.expand(e);else if(e.constructor===Array){e.length>0&&"@context"in e[0]&&(d=f(e[0]["@context"]));var g=[],i;for(i in e)g.push(b.expand(e[i]));e=g}var g={defaults:{embedOn:!0,explicitOn:!1,omitDefaultOn:!1}},h={};for(i in a)h[a[i]["@id"]]=a[i];a=P(h,a,e,{},!1,null,null,g);d!==null&&a!==null&&(a=b.compact(d,a));return a}})();var na={parser:{}};na.parser.parse=function(a,
b){typeof a==="string"&&(a=JSON.parse(a));return ya.toTriples(a,b)};var va={_explicituri:/^<((?:[^\x00-\x20<>\\"\{\}\|\^\`]|\\[uU])*)>/,_string:/^"[^"\\]*(?:\\.[^"\\]*)*"(?=[^"\\])|^'[^'\\]*(?:\\.[^'\\]*)*'(?=[^'\\])/,_tripleQuotedString:/^""("[^"\\]*(?:(?:\\.|"(?!""))[^"\\]*)*")""|^''('[^'\\]*(?:(?:\\.|'(?!''))[^'\\]*)*')''/,_langcode:/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,_prefix:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\.\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=\s)/,
_qname:/^((?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\.\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?=[\s\.;,)])/,
_number:/^[\-+]?(?:\d+\.?\d*([eE](?:[\-\+])?\d+)|\d+\.\d+|\.\d+|\d+)(?=\s*[\s\.;,)])/,_boolean:/^(?:true|false)(?=\s+)/,_punctuation:/^\.(?!\d)|^;|^,|^\[|^\]|^\(|^\)/,_fastString:/^"[^"\\]+"(?=[^"\\])/,_keyword:/^(?:@[a-z]+|[Pp][Rr][Ee][Ff][Ii][Xx]|[Bb][Aa][Ss][Ee])(?=\s)/,_type:/^\^\^(?:<([^>]*)>|([A-Z_a-z\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd][\-0-9A-Z_a-z\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]*)?:([A-Z_a-z\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd][\-0-9A-Z_a-z\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]*)(?=[\s\.;,)]))/,
_shortPredicates:/^a(?=\s+|<)/,_newline:/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,_whitespace:/^[ \t]+|^#[^\n\r]*/,_nonwhitespace:/^\S*/},jb=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\[uU]|\\(.)/g,kb={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\u000c",b:"\u0008",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},lb=/[\x00-\x20<>\\"\{\}\|\^\`]/,rc={".":"dot",";":"semicolon",",":"comma","[":"bracketopen",
"]":"bracketclose","(":"liststart",")":"listend"},sc={a:"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"};ha.prototype={constructor:ha,_next:function(a){function b(b){e=b._nonwhitespace.exec(b._input);delete b._input;a('Syntax error: unexpected "'+e[0]+'" on line '+b._line+".");return!1}if(this._input===void 0)return!1;for(var e;e=this._newline.exec(this._input);)this._line++,this._input=this._input.substr(e[0].length);if(e=this._whitespace.exec(this._input))this._input=this._input.substr(e[0].length);
var d={line:this._line,type:"",value:"",prefix:""},g;if(!this._input.length){if(!this._inputComplete)return!1;delete this._input;d.type="eof";a(null,d);return!0}if(e=this._explicituri.exec(this._input)){g=this._unescape(e[1]);if(g===null||lb.test(g))return b(this);d.type="explicituri";d.value=g}else if(e=this._punctuation.exec(this._input))d.type=rc[e[0]];else if(this._prevTokenType==="literal"&&(e=this._langcode.exec(this._input)))d.type="langcode",d.value=e[1];else if(e=this._fastString.exec(this._input))d.type=
"literal",d.value=e[0];else if(e=this._string.exec(this._input)){g=this._unescape(e[0]);if(g===null)return b(this);d.type="literal";d.value=g.replace(/^'|'$/g,'"')}else if(e=this._tripleQuotedString.exec(this._input)){g=e[1]||e[2];this._line+=g.split(/\r\n|\r|\n/).length-1;g=this._unescape(g);if(g===null)return b(this);d.type="literal";d.value=g.replace(/^'|'$/g,'"')}else if(e=this._number.exec(this._input))d.type="literal",d.value='"'+e[0]+'"^^<http://www.w3.org/2001/XMLSchema#'+(e[1]?"double>":
/^[+\-]?\d+$/.test(e[0])?"integer>":"decimal>");else if(e=this._boolean.exec(this._input))d.type="literal",d.value='"'+e[0]+'"^^<http://www.w3.org/2001/XMLSchema#boolean>';else if(this._prevTokenType==="literal"&&(e=this._type.exec(this._input)))d.type="type",e[2]?(d.prefix=e[2],d.value=e[3]):d.value=e[1];else if(e=this._keyword.exec(this._input))g=e[0],d.type=g[0]==="@"?g:g.toUpperCase();else if((this._prevTokenType==="@prefix"||this._prevTokenType==="PREFIX")&&(e=this._prefix.exec(this._input)))d.type=
"prefix",d.value=e[1]||"";else if(e=this._qname.exec(this._input)){g=this._unescape(e[2]);if(g===null)return b(this);d.type="qname";d.prefix=e[1]||"";d.value=g}else if(e=this._shortPredicates.exec(this._input))d.type="abbreviation",d.value=sc[e[0]];else return this._inputComplete&&b(this),!1;this._prevTokenType=d.type;this._input=this._input.substr(e[0].length);a(null,d);return!0},_unescape:function(a){try{return a.replace(jb,function(a,b,g,i){if(b){a=parseInt(b,16);if(isNaN(a))throw"invalid character code";
return String.fromCharCode(a)}else if(g){a=parseInt(g,16);if(isNaN(a))throw"invalid character code";return a<65535?String.fromCharCode(a):String.fromCharCode(Math.floor((a-65536)/1024)+55296)+String.fromCharCode((a-65536)%1024+56320)}else{a=kb[i];if(!a)throw"invalid escape sequence";return a}})}catch(b){return null}},tokenize:function(a,b){var e=this;this._line=1;typeof a==="string"?(this._input=a,this._inputComplete=!0,process.nextTick(function(){for(;e._next(b););})):(this._input="",this._inputComplete=
!1,a.setEncoding("utf8"),a.on("data",function(a){for(e._input+=a;e._next(b););}),a.on("end",function(){for(e._inputComplete=!0;e._next(b););}))}};var W={token:"uri",value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil",prefix:null,suffix:null},oa={token:"uri",value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#first",prefix:null,suffix:null},tc={token:"uri",value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest",prefix:null,suffix:null},ea=/^[a-z]+:/,fa=/^#/,wa=/[^\/]*$/;M.prototype={defaultGraph:null,
constructor:M,_readInTopContext:function(a){switch(a.type){case "eof":return this._callback(null,null);case "@prefix":return this._sparqlStyle=!1,this._readPrefix;case "PREFIX":return this._sparqlStyle=!0,this._readPrefix;case "@base":return this._sparqlStyle=!1,this._readBaseURI;case "BASE":return this._sparqlStyle=!0,this._readBaseURI;default:return this._readSubject(a)}},_readSubject:function(a){switch(a.type){case "explicituri":this._subject=this._baseURI===null||ea.test(a.value)?{token:"uri",
value:a.value,prefix:null,suffix:null}:{token:"uri",value:(fa.test(a.value)?this._baseURI:this._baseURIRoot)+a.value,prefix:null,suffix:null};break;case "qname":if(a.prefix==="_")this._subject=this._blankNodes[a.value]!==void 0?{blank:this._blankNodes[a.value]}:{blank:this._blankNodes[a.value]="_:"+this._blankNodeCount++};else{var b=this._prefixes[a.prefix];if(b===void 0)return this._error('Undefined prefix "'+a.prefix+':"',a);this._subject={token:"uri",value:b+a.value,prefix:null,suffix:null}}break;
case "bracketopen":return this._subject={blank:"_:"+this._blankNodeCount++},this._tripleStack.push({subject:this._subject,predicate:null,object:null,type:"blank"}),this._readBlankNodeHead;case "liststart":return this._tripleStack.push({subject:W,predicate:null,object:null,type:"list"}),this._subject=null,this._readListItem;default:return this._error('Unexpected token type "'+a.type,a)}this._subjectHasPredicate=!1;return this._readPredicate},_readPredicate:function(a){switch(a.type){case "explicituri":case "abbreviation":this._predicate=
this._baseURI===null||ea.test(a.value)?{token:"uri",value:a.value,prefix:null,suffix:null}:{token:"uri",value:(fa.test(a.value)?this._baseURI:this._baseURIRoot)+a.value,prefix:null,suffix:null};break;case "qname":if(a.prefix==="_")return this._error("Disallowed blank node as predicate",a);else{var b=this._prefixes[a.prefix];if(b===void 0)return this._error('Undefined prefix "'+a.prefix+':"',a);this._predicate={token:"uri",value:b+a.value,prefix:null,suffix:null}}break;case "bracketclose":return this._readBlankNodeTail(a,
!0);case "dot":return!this._subjectHasPredicate?this._error("Unexpected dot",a):this._readPunctuation(a,!0);case "semicolon":return this._readPredicate;default:return this._error('Expected predicate to follow "'+this._subject+'"',a)}this._subjectHasPredicate=!0;return this._readObject},_readObject:function(a){switch(a.type){case "explicituri":this._object=this._baseURI===null||ea.test(a.value)?{token:"uri",value:a.value,prefix:null,suffix:null}:{token:"uri",value:(fa.test(a.value)?this._baseURI:this._baseURIRoot)+
a.value,prefix:null,suffix:null};break;case "qname":if(a.prefix==="_")this._object=this._blankNodes[a.value]!==void 0?{blank:this._blankNodes[a.value]}:{blank:this._blankNodes[a.value]="_:"+this._blankNodeCount++};else{var b=this._prefixes[a.prefix];if(b===void 0)return this._error('Undefined prefix "'+a.prefix+':"',a);this._object={token:"uri",value:b+a.value,prefix:null,suffix:null}}break;case "literal":return this._object={literal:a.value},this._readDataTypeOrLang;case "bracketopen":return a={blank:"_:"+
this._blankNodeCount++},this._tripleStack.push({subject:this._subject,predicate:this._predicate,object:a,type:"blank"}),this._subject=a,this._readBlankNodeHead;case "liststart":return this._tripleStack.push({subject:this._subject,predicate:this._predicate,object:W,type:"list"}),this._subject=null,this._readListItem;default:return this._error('Expected object to follow "'+this._predicate+'"',a)}return this._getNextReader()},_readBlankNodeHead:function(a){return a.type==="bracketclose"?this._readBlankNodeTail(a,
!0):this._readPredicate(a)},_readBlankNodeTail:function(a,b){if(a.type!=="bracketclose")return this._readPunctuation(a);b!==!0&&this._callback(null,{subject:this._subject,predicate:this._predicate,object:this._object,graph:M.prototype.defaultGraph});var e=this._tripleStack.pop();this._subject=e.subject;return e.object!==null?(this._predicate=e.predicate,this._object=e.object,this._getNextReader()):this._readPredicate},_readDataTypeOrLang:function(a){switch(a.type){case "type":if(a.prefix==="")a=a.value;
else{var b=this._prefixes[a.prefix];if(b===void 0)return this._error('Undefined prefix "'+a.prefix+':"',a);a=b+a.value}this._object.literal?this._object.literal+="^^<"+a+">":(this._object+="^^<"+a+">",this._object={literal:this._object});return this._readPunctuation;case "langcode":return this._object.literal?this._object.literal+="@"+a.value.toLowerCase():(this._object+="@"+a.value.toLowerCase(),this._object={literal:this._object}),this._getNextReader();default:return this._getNextReader().call(this,
a)}},_readListItem:function(a){var b=null,e=null,d=this._subject,g=this._tripleStack,i=g[g.length-1],f=this._readListItem;switch(a.type){case "explicituri":b={token:"uri",value:a.value,prefix:null,suffix:null};break;case "qname":if(a.prefix==="_")b=this._blankNodes[a.value]||(this._blankNodes[a.value]={blank:"_:"+this._blankNodeCount++});else{b=this._prefixes[a.prefix];if(b===void 0)return this._error('Undefined prefix "'+a.prefix+':"',a);b={token:"uri",value:b+a.value,prefix:null,suffix:null}}break;
case "literal":b={literal:a.value};f=this._readDataTypeOrLang;break;case "bracketopen":e={blank:"_:"+this._blankNodeCount++};b={blank:"_:"+this._blankNodeCount++};g.push({subject:e,predicate:oa,object:b,type:"blank"});this._subject=b;f=this._readBlankNodeHead;break;case "liststart":e={blank:"_:"+this._blankNodeCount++};g.push({subject:e,predicate:oa,object:W,type:"list"});this._subject=null;f=this._readListItem;break;case "listend":g.pop();g.length!==0&&g[g.length-1].type==="list"&&this._callback(null,
{subject:i.subject,predicate:i.predicate,object:i.object,graph:M.prototype.defaultGraph});this._subject=typeof i.subject==="string"?{token:"uri",value:i.subject,prefix:null,suffix:null}:i.subject;if(i.predicate===null){if(f=this._readPredicate,i.subject===W)return f}else if(this._predicate=typeof i.predicate==="string"?{token:"uri",value:i.predicate,prefix:null,suffix:null}:i.predicate,this._object=typeof i.object==="string"?{token:"uri",value:i.object,prefix:null,suffix:null}:i.object,f=this._getNextReader(),
i.object===W)return f;e=W;break;default:return this._error('Expected list item instead of "'+a.type+'"',a)}if(e===null)this._subject=e={blank:"_:"+this._blankNodeCount++};d===null?i.object===W?i.object=e:i.subject=e:this._callback(null,{subject:d,predicate:tc,object:e,graph:M.prototype.defaultGraph});b!==null&&this._callback(null,{subject:e,predicate:oa,object:b,graph:M.prototype.defaultGraph});return f},_readPunctuation:function(a,b){var e;switch(a.type){case "dot":e=this._readInTopContext;break;
case "semicolon":e=this._readPredicate;break;case "comma":e=this._readObject;break;default:return this._error('Expected punctuation to follow "'+this._object+'"',a)}b||this._callback(null,{subject:this._subject,predicate:this._predicate,object:this._object,graph:M.prototype.defaultGraph});return e},_readPrefix:function(a){if(a.type!=="prefix")return this._error("Expected prefix to follow @prefix",a);this._prefix=a.value;return this._readPrefixURI},_readPrefixURI:function(a){if(a.type!=="explicituri")return this._error('Expected explicituri to follow prefix "'+
this.prefix+'"',a);this._prefixes[this._prefix]=this._baseURI===null||ea.test(a.value)?a.value:(fa.test(a.value)?this._baseURI:this._baseURIRoot)+a.value;return this._readDeclarationPunctuation},_readBaseURI:function(a){if(a.type!=="explicituri")return this._error("Expected explicituri to follow base declaration",a);this._baseURI=this._baseURI===null||ea.test(a.value)?a.value:(fa.test(a.value)?this._baseURI:this._baseURIRoot)+a.value;this._baseURIRoot=this._baseURI.replace(wa,"");return this._readDeclarationPunctuation},
_readDeclarationPunctuation:function(a){return this._sparqlStyle?this._readInTopContext(a):a.type!=="dot"?this._error("Expected declaration to end with a dot",a):this._readInTopContext},_getNextReader:function(){var a=this._tripleStack;if(a.length===0)return this._readPunctuation;switch(a[a.length-1].type){case "blank":return this._readBlankNodeTail;case "list":return this._readListItem}},_error:function(a,b){this._callback(a+" at line "+b.line+".")},parse:function(a,b){var e=this;this._prefixes=
Object.create(null);this._callback=b;this._readCallback=this._readInTopContext;this._lexer.tokenize(a,function(a,b){if(a!==null&&e._readCallback===void 0)e._callback(a);else if(e._readCallback!==void 0)a!==null?e._callback(a):e._readCallback=e._readCallback(b)})}};var ia={parser:{}};ia.parser.async=!0;ia.parser.parse=function(){var a=new M,b=arguments[0],e=arguments[1],d=arguments[2];arguments.length===2?(e=null,d=arguments[1]):arguments.length!==3&&d(!1,"Wrong number of arguments, 2, 3 args required");
e&&typeof e==="string"&&(e={token:"uri",value:e,prefix:null,suffix:null});M.prototype.defaultGraph=e;var g=[];a.parse(b,function(a,e){a?d(!1,a):e?g.push(e):d(!0,g)})};var uc=function(){var a=function(a,e){var b=e.indexOf("#");b>0&&(e=e.slice(0,b));if(a.length==0)return e;if(a.indexOf("#")==0)return e+a;if(a.indexOf(":")>=0)return a;var f=e.indexOf(":");if(e=="")return a;if(f<0)throw"Invalid Base URI";b=e.slice(0,f+1);if(a.indexOf("//")==0)return b+a;if(e.indexOf("//",f)==f+1){var h=e.indexOf("/",
f+3);if(h<0)return e.length-f-3>0?e+"/"+a:b+a}else if(h=e.indexOf("/",f+1),h<0)return e.length-f-1>0?e+"/"+a:b+a;if(a.indexOf("/")==0)return e.slice(0,h)+a;var f=e.slice(h),k=f.lastIndexOf("/");if(k<0)return b+a;k>=0&&k<f.length-1&&(f=f.slice(0,k+1));for(f+=a;f.match(/[^\/]*\/\.\.\//);)f=f.replace(/[^\/]*\/\.\.\//,"");f=f.replace(/\.\//g,"");f=f.replace(/\/\.$/,"/");return e.slice(0,h)+f},b=function(e){var b={ns:{RDF:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",RDFS:"http://www.w3.org/2000/01/rdf-schema#"},
nodeType:{ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12}};this.frameFactory=function(e,d,h){return{NODE:1,ARC:2,parent:d,parser:e,store:e.store,element:h,lastChild:0,base:null,lang:null,node:null,nodeType:null,listIndex:1,rdfid:null,datatype:null,collection:!1,terminateFrame:function(){this.collection&&this.node.close()},addSymbol:function(e,b){b=a(b,this.base);this.node=this.store.sym(b);
this.nodeType=e},loadTriple:function(){this.parent.parent.collection?this.parent.parent.node.append(this.node):this.store.add(this.parent.parent.node,this.parent.node,this.node,this.parser.why);if(this.parent.rdfid!=null){var e=this.store.sym(a("#"+this.parent.rdfid,this.base));this.store.add(e,this.store.sym(b.ns.RDF+"type"),this.store.sym(b.ns.RDF+"Statement"),this.parser.why);this.store.add(e,this.store.sym(b.ns.RDF+"subject"),this.parent.parent.node,this.parser.why);this.store.add(e,this.store.sym(b.ns.RDF+
"predicate"),this.parent.node,this.parser.why);this.store.add(e,this.store.sym(b.ns.RDF+"object"),this.node,this.parser.why)}},isTripleToLoad:function(){return this.parent!=null&&this.parent.parent!=null&&this.nodeType==this.NODE&&this.parent.nodeType==this.ARC&&this.parent.parent.nodeType==this.NODE},addNode:function(a){this.addSymbol(this.NODE,a);this.isTripleToLoad()&&this.loadTriple()},addCollection:function(){this.nodeType=this.NODE;this.node=this.store.collection();this.collection=!0;this.isTripleToLoad()&&
this.loadTriple()},addCollectionArc:function(){this.nodeType=this.ARC},addBNode:function(a){this.node=a!=null?this.parser.bnodes[a]!=null?this.parser.bnodes[a]:this.parser.bnodes[a]=this.store.bnode():this.store.bnode();this.nodeType=this.NODE;this.isTripleToLoad()&&this.loadTriple()},addArc:function(a){a==b.ns.RDF+"li"&&(a=b.ns.RDF+"_"+this.parent.listIndex++);this.addSymbol(this.ARC,a)},addLiteral:function(a){this.node=this.parent.datatype?this.store.literal(a,"",this.store.sym(this.parent.datatype)):
this.store.literal(a,this.lang);this.nodeType=this.NODE;this.isTripleToLoad()&&this.loadTriple()}}};this.getAttributeNodeNS=function(a,e,b){var g=null;if(a.getAttributeNodeNS)g=a.getAttributeNodeNS(e,b);else for(var a=a.attributes,d,h,q=0;q<a.length;++q)if(d=a[q],d.namespaceURI==e&&(h=d.prefix?d.prefix+":"+b:b,h==d.nodeName)){g=d;break}return g};this.store=e;this.bnodes={};this.why=null;this.reify=!1;this.parse=function(a,e,d){var h=a.childNodes;this.cleanParser();if(a.nodeType==b.nodeType.DOCUMENT)for(a=
0;a<h.length;a++){if(h[a].nodeType==b.nodeType.ELEMENT){var o=h[a];break}}else if(a.nodeType==b.nodeType.ELEMENT)o=a;else throw Error("RDFParser: can't find root in "+e+". Halting. ");this.why=d;d=this.frameFactory(this);this.base=e;d.base=e;d.lang="";this.parseDOM(this.buildFrame(d,o));return!0};this.parseDOM=function(e){for(var d=function(a){var e="";a.namespaceURI&&(e+=a.namespaceURI);a.localName?e+=a.localName:a.nodeName&&(e+=a.nodeName.indexOf(":")>=0?a.nodeName.split(":")[1]:a.nodeName);return e},
h=!0;e.parent;){var k=e.element,o=k.attributes;if(k.nodeType==b.nodeType.TEXT||k.nodeType==b.nodeType.CDATA_SECTION)e.addLiteral(k.nodeValue);else if(d(k)!=b.ns.RDF+"RDF"){if(e.parent&&e.parent.collection)e.addCollectionArc(),e=this.buildFrame(e,e.element),e.parent.element=null;if(!e.parent||!e.parent.nodeType||e.parent.nodeType==e.ARC){var m=this.getAttributeNodeNS(k,b.ns.RDF,"about"),q=this.getAttributeNodeNS(k,b.ns.RDF,"ID");if(m&&q)throw Error("RDFParser: "+k.nodeName+" has both rdf:id and rdf:about. Halting. Only one of these properties may be specified on a node.");
m==null&&q?(e.addNode("#"+q.nodeValue),k.removeAttributeNode(q)):m==null&&q==null?(m=this.getAttributeNodeNS(k,b.ns.RDF,"nodeID"))?(e.addBNode(m.nodeValue),k.removeAttributeNode(m)):e.addBNode():(e.addNode(m.nodeValue),k.removeAttributeNode(m));m=this.getAttributeNodeNS(k,b.ns.RDF,"type");b.ns.RDF+"Description"!=d(k)&&(m={nodeValue:d(k)});m!=null&&(this.store.add(e.node,this.store.sym(b.ns.RDF+"type"),this.store.sym(a(m.nodeValue,e.base)),this.why),m.nodeName&&k.removeAttributeNode(m));for(k=o.length-
1;k>=0;k--)this.store.add(e.node,this.store.sym(d(o[k])),this.store.literal(o[k].nodeValue,e.lang),this.why)}else{e.addArc(d(k));if(this.reify&&(q=this.getAttributeNodeNS(k,b.ns.RDF,"ID")))e.rdfid=q.nodeValue,k.removeAttributeNode(q);m=this.getAttributeNodeNS(k,b.ns.RDF,"parseType");if(q=this.getAttributeNodeNS(k,b.ns.RDF,"datatype"))e.datatype=q.nodeValue,k.removeAttributeNode(q);if(m){q=m.nodeValue;if(q=="Literal")e.datatype=b.ns.RDF+"XMLLiteral",e=this.buildFrame(e),e.addLiteral(k),h=!1;else if(q==
"Resource")e=this.buildFrame(e,e.element),e.parent.element=null,e.addBNode();else if(q=="Collection")e=this.buildFrame(e,e.element),e.parent.element=null,e.addCollection();k.removeAttributeNode(m)}if(o.length!=0){q=this.getAttributeNodeNS(k,b.ns.RDF,"resource");m=this.getAttributeNodeNS(k,b.ns.RDF,"nodeID");e=this.buildFrame(e);q?(e.addNode(q.nodeValue),k.removeAttributeNode(q)):m?(e.addBNode(m.nodeValue),k.removeAttributeNode(m)):e.addBNode();for(k=o.length-1;k>=0;k--)m=this.buildFrame(e),m.addArc(d(o[k])),
d(o[k])==b.ns.RDF+"type"?this.buildFrame(m).addNode(o[k].nodeValue):this.buildFrame(m).addLiteral(o[k].nodeValue)}else k.childNodes.length==0&&this.buildFrame(e).addLiteral("")}}for(k=e.element;e.parent;){for(o=e;k==null;)e=e.parent,k=e.element;m=k.childNodes[e.lastChild];if(m==null||!h){e.terminateFrame();if(!(e=e.parent))break;k=e.element;h=!0}else if(m.nodeType!=b.nodeType.ELEMENT&&m.nodeType!=b.nodeType.TEXT&&m.nodeType!=b.nodeType.CDATA_SECTION||(m.nodeType==b.nodeType.TEXT||m.nodeType==b.nodeType.CDATA_SECTION)&&
k.childNodes.length!=1)e.lastChild++;else{e.lastChild++;e=this.buildFrame(o,k.childNodes[e.lastChild-1]);break}}}};this.cleanParser=function(){this.bnodes={};this.why=null};this.buildFrame=function(e,d){var h=this.frameFactory(this,e,d);if(e)h.base=e.base,h.lang=e.lang;if(d==null||d.nodeType==b.nodeType.TEXT||d.nodeType==b.nodeType.CDATA_SECTION)return h;var k=d.attributes,o=d.getAttributeNode("xml:base");if(o!=null)h.base=o.nodeValue,d.removeAttribute("xml:base");o=d.getAttributeNode("xml:lang");
if(o!=null)h.lang=o.nodeValue,d.removeAttribute("xml:lang");for(o=k.length-1;o>=0;o--)if(k[o].nodeName.substr(0,3)=="xml"){if(k[o].name.slice(0,6)=="xmlns:"){var m=k[o].nodeValue;this.base&&(m=a(m,this.base));this.store.setPrefixForURI(k[o].name.slice(6),m)}d.removeAttributeNode(k[o])}return h}},e=function(a){this.statements=[];this.namespaces={};this.add=function(e,b,g){this.statements.push({subject:e,predicate:b,object:g,graph:a})};this.sym=function(a){return{token:"uri",value:a}};this.literal=
function(a,e,b){a=a.replace(/\\/g,"\\\\");a=a.replace(/\"/g,'\\"');a=a.replace(/\n/g,"\\n");a='"'+a+'"';b&&(a=a+"^^"+b);e&&(a=a+"@"+e);return{literal:a}};var e=0;this.bnode=function(a){a=a||"_:bnid"+e++;return{blank:a}};this.setPrefixForURI=function(a,e){if(this.namespaces[a]||e!==e)throw"Can't redefine prefix "+a;this.namespaces[a]=e}};return{parse:function(a,g){var i=a;if(typeof a==="string"||Object.prototype.toString.call(a)==="[object String]"){var f;if(typeof module!="undefined")throw"rdfxml parsing not supported in nodejs.";
else if(window.DOMParser)i=new DOMParser,f=i.parseFromString(a,"text/xml");else if(window.ActiveXObject)f=new ActiveXObject("Microsoft.XMLDOM"),f.async="false",f.loadXML(a);i=f}f=new e(g);(new b(f)).parse(i,"http://nobase");return f.statements}}}(),ja={parser:{}};ja.parser.parse=function(a,b){try{return uc.parse(a,b)}catch(e){throw e;}};var Y={RDFLoader:function(a){this.precedences=["text/turtle","text/n3","application/ld+json","application/json","application/rdf+xml"];this.parsers={"text/turtle":ia.parser,
"text/n3":ia.parser,"application/ld+json":na.parser,"application/json":na.parser,"application/rdf+xml":ja.parser,"text/xml":ja.parser,"application/xml":ja.parser};if(a!=null)for(var b in a.parsers)this.parsers[b]=a.parsers[b];if(a&&a.precedences!=null)for(b in this.precedences=a.precedences,a.parsers)s.include(this.precedences,b)||this.precedences.push(b);this.acceptHeaderValue="";for(a=0;a<this.precedences.length;a++)a!=0?this.acceptHeaderValue=this.acceptHeaderValue+","+this.precedences[a]:this.acceptHeaderValue+=
this.precedences[a]}};Y.RDFLoader.prototype.registerParser=function(a,b){this.parsers[a]=b;this.precedences.push(a)};Y.RDFLoader.prototype.unregisterParser=function(a){delete this.parsers[a];for(var b=[],e=0;e<this.precedences.length;e++)this.precedences[e]!=a&&b.push(this.precedences[e]);this.precedences=b};Y.RDFLoader.prototype.setAcceptHeaderPrecedence=function(a){this.precedences=a};Y.RDFLoader.prototype.load=function(a,b,e){var d=this;P.load(a,this.acceptHeaderValue,function(g,i){if(g==!0){var f=
i.headers["Content-Type"]||i.headers["content-type"],h=i.data;if(f!=null){var f=f.split(";")[0],k;for(k in d.parsers)if(k.indexOf("/")!=-1){var o=k.split("/");if(o[1]==="*"){if(f.indexOf(o[0])!=-1)return d.tryToParse(d.parsers[k],b,h,e)}else if(f.indexOf(k)!=-1)return d.tryToParse(d.parsers[k],b,h,e);else if(f.indexOf(o[1])!=-1)return d.tryToParse(d.parsers[k],b,h,e)}else if(f.indexOf(k)!=-1)return d.tryToParse(d.parsers[k],a,b,e);e(!1,"Unknown media type : "+f)}else console.log("Unknown media type"),
console.log(i.headers),e(!1,"Uknown media type")}else e(!1,"Network error: "+i)})};Y.RDFLoader.prototype.loadFromFile=function(a,b,e,d){try{var g=this;require("fs").readFile(e.split("file:/")[1],function(e,i){if(e)throw e;i=i.toString("utf8");g.tryToParse(a,b,i,d)})}catch(i){d(!1,i)}};Y.RDFLoader.prototype.tryToParse=function(a,b,e,d){try{if(typeof e==="string"&&(e=s.normalizeUnicodeLiterals(e)),a.async)a.parse(e,b,d);else{var g=a.parse(e,b);g!=null?d(!0,g):d(!1,"parsing error")}}catch(i){console.log(i.message),
console.log(i.stack),d(!1,"parsing error with mime type : "+i)}};var F={AbstractQueryTree:function(){}};F.AbstractQueryTree.prototype.parseQueryString=function(a){return za.parser.parse(a)};F.AbstractQueryTree.prototype.parseExecutableUnit=function(a){if(a.kind==="select")return this.parseSelect(a);else if(a.kind==="ask")return this.parseSelect(a);else if(a.kind==="modify")return this.parseSelect(a);else if(a.kind==="construct")return this.parseSelect(a);else if(a.kind==="insertdata")return this.parseInsertData(a);
else if(a.kind==="deletedata")return this.parseInsertData(a);else if(a.kind==="load")return a;else if(a.kind==="clear")return a;else if(a.kind==="drop")return a;else if(a.kind==="create")return a;else throw Error("unknown executable unit: "+a.kind);};F.AbstractQueryTree.prototype.parseSelect=function(a){return a==null?(console.log("error parsing query"),null):(a.pattern=this.build(a.pattern,{freshCounter:0}),a)};F.AbstractQueryTree.prototype.parseInsertData=function(a){return a==null?(console.log("error parsing query"),
null):a};F.AbstractQueryTree.prototype.build=function(a,b){if(a.token==="groupgraphpattern")return this._buildGroupGraphPattern(a,b);else if(a.token==="basicgraphpattern"){var e={kind:"BGP",value:a.triplesContext};return e=F.translatePathExpressionsInBGP(e,b)}else if(a.token==="graphunionpattern"){var e=this.build(a.value[0],b),d=this.build(a.value[1],b);return{kind:"UNION",value:[e,d]}}else if(a.token==="graphgraphpattern")return{kind:"GRAPH",value:this.build(a.value,b),graph:a.graph};else throw Error("not supported token in query:"+
a.token);};F.translatePathExpressionsInBGP=function(a,b){var e,d=[],g,i;for(i=0;i<a.value.length;i++)if(a.value[i].predicate&&a.value[i].predicate.token==="path"){e=a.value[i];g=a.value.slice(i+1);var f=F.translatePathExpression(e,b);e=null;if(f.kind==="BGP")d=d.concat(f.value);else if(f.kind==="ZERO_OR_MORE_PATH"||f.kind==="ONE_OR_MORE_PATH"){i=d.length>0?{kind:"JOIN",lvalue:{kind:"BGP",value:d},rvalue:f}:f;if(f.kind==="ZERO_OR_MORE_PATH")if(f.y.token==="var"&&f.y.value.indexOf("fresh:")===0&&f.x.token===
"var"&&f.x.value.indexOf("fresh:")===0)for(var h=0;h<a.value.length;h++){if(a.value[h].object&&a.value[h].object.token==="var"&&a.value[h].object.value===f.x.value)e=s.clone(a.value[h]),e.object=f.y}else if(f.y.token==="var"&&f.y.value.indexOf("fresh:")===0)for(h=0;h<a.value.length;h++)if(a.value[h].subject&&a.value[h].subject.token==="var"&&a.value[h].subject.value===f.y.value)e=s.clone(a.value[h]),e.subject=f.x;return g.length>0?(f=F.translatePathExpressionsInBGP({kind:"BGP",value:g},b),e!=null?
(d=d.concat([e]).concat(g),{kind:"UNION",value:[{kind:"JOIN",lvalue:i,rvalue:f},{kind:"BGP",value:d}]}):{kind:"JOIN",lvalue:i,rvalue:f}):i}else return f}else d.push(a.value[i]);a.value=d;return a};F.translatePathExpression=function(a,b){if(a.predicate.kind==="element")if(a.predicate.modifier==="+"){a.predicate.modifier=null;var e=F.translatePathExpression(a,b);return{kind:"ONE_OR_MORE_PATH",path:e,x:a.subject,y:a.object}}else return a.predicate.modifier==="*"?(a.predicate.modifier=null,e=F.translatePathExpression(a,
b),{kind:"ZERO_OR_MORE_PATH",path:e,x:a.subject,y:a.object}):(a.predicate=a.predicate.value,{kind:"BGP",value:[a]});else if(a.predicate.kind==="sequence"){for(var e=a.subject,d=a.object,g=a.graph,i,f,h=[],k=0;k<a.predicate.value.length;k++){k!=a.predicate.value.length-1?(i={token:"var",value:"fresh:"+b.freshCounter},b.freshCounter++):i=d;f={subject:e,predicate:a.predicate.value[k],object:i};if(g!=null)f.graph=s.clone(g);h.push(f);k!=a.predicate.value.length-1&&(e=s.clone(i))}return F.translatePathExpressionsInBGP({kind:"BGP",
value:h},b)}};F.AbstractQueryTree.prototype._buildGroupGraphPattern=function(a,b){for(var e=a.filters||[],d={kind:"EMPTY_PATTERN"},g=0;g<a.patterns.length;g++){var i=a.patterns[g];i.token==="optionalgraphpattern"?(i=this.build(i.value,b),d=i.kind==="FILTER"?{kind:"LEFT_JOIN",lvalue:d,rvalue:i.value,filter:i.filter}:{kind:"LEFT_JOIN",lvalue:d,rvalue:i,filter:!0}):(i=this.build(i,b),d=d.kind=="EMPTY_PATTERN"?i:{kind:"JOIN",lvalue:d,rvalue:i})}if(e.length!=0)if(d.kind==="EMPTY_PATTERN")return{kind:"FILTER",
filter:e,value:d};else if(d.kind==="LEFT_JOIN"&&d.filter===!0)return{kind:"FILTER",filter:e,value:d};else if(d.kind==="LEFT_JOIN")return{kind:"FILTER",filter:e,value:d};else if(d.kind==="JOIN")return{kind:"FILTER",filter:e,value:d};else if(d.kind==="UNION")return{kind:"FILTER",filter:e,value:d};else if(d.kind==="GRAPH")return{kind:"FILTER",filter:e,value:d};else if(d.kind==="BGP")return{kind:"FILTER",filter:e,value:d};else throw Error("Unknow kind of algebra expression: "+d.kind);else return d};F.AbstractQueryTree.prototype.collectBasicTriples=
function(a,b){b==null&&(b=[]);if(a.kind==="select")b=this.collectBasicTriples(a.pattern,b);else if(a.kind==="BGP")b=b.concat(a.value);else if(a.kind==="ZERO_OR_MORE_PATH")b=this.collectBasicTriples(a.path);else if(a.kind==="UNION")b=this.collectBasicTriples(a.value[0],b),b=this.collectBasicTriples(a.value[1],b);else if(a.kind==="GRAPH")b=this.collectBasicTriples(a.value,b);else if(a.kind==="LEFT_JOIN"||a.kind==="JOIN")b=this.collectBasicTriples(a.lvalue,b),b=this.collectBasicTriples(a.rvalue,b);else if(a.kind===
"FILTER")b=this.collectBasicTriples(a.value,b);else if(a.kind==="construct")b=this.collectBasicTriples(a.pattern,b);else if(a.kind!=="EMPTY_PATTERN")throw"Unknown pattern: "+a.kind;return b};F.AbstractQueryTree.prototype.bind=function(a,b){if(a.graph!=null&&a.graph.token&&a.graph.token==="var"&&b[a.graph.value]!=null)a.graph=b[a.graph.value];if(a.filter!=null){for(var e=[],d=0;d<a.filter.length;d++)a.filter[d].value=this._bindFilter(a.filter[d].value,b),e.push(a.filter[d]);a.filter=e}if(a.kind===
"select")a.pattern=this.bind(a.pattern,b);else if(a.kind==="BGP")a.value=this._bindTripleContext(a.value,b);else if(a.kind==="ZERO_OR_MORE_PATH"){a.path=this._bindTripleContext(a.path,b);if(a.x&&a.x.token==="var"&&b[a.x.value]!=null)a.x=b[a.x.value];if(a.y&&a.y.token==="var"&&b[a.y.value]!=null)a.y=b[a.y.value]}else if(a.kind==="UNION")a.value[0]=this.bind(a.value[0],b),a.value[1]=this.bind(a.value[1],b);else if(a.kind==="GRAPH")a.value=this.bind(a.value,b);else if(a.kind==="LEFT_JOIN"||a.kind===
"JOIN")a.lvalue=this.bind(a.lvalue,b),a.rvalue=this.bind(a.rvalue,b);else if(a.kind==="FILTER")a.filter=this._bindFilter(a.filter[d].value,b);else if(a.kind!=="EMPTY_PATTERN")throw"Unknown pattern: "+a.kind;return a};F.AbstractQueryTree.prototype._bindTripleContext=function(a,b){for(var e=0;e<a.length;e++){delete a[e].graph;delete a[e].variables;for(var d in a[e]){var g=a[e][d];g.token==="var"&&b[g.value]!=null&&(a[e][d]=b[g.value])}}return a};F.AbstractQueryTree.prototype._bindFilter=function(a,
b){if(a.expressionType!=null){var e=a.expressionType;if(e=="relationalexpression")a.op1=this._bindFilter(a.op1,b),a.op2=this._bindFilter(a.op2,b);else if(e=="conditionalor"||e=="conditionaland")for(e=0;e<a.operands.length;e++)a.operands[e]=this._bindFilter(a.operands[e],b);else if(e=="additiveexpression"){a.summand=this._bindFilter(a.summand,b);for(e=0;e<a.summands.length;e++)a.summands[e].expression=this._bindFilter(a.summands[e].expression,b)}else if(e=="builtincall")for(e=0;e<a.args.length;e++)a.args[e]=
this._bindFilter(a.args[e],b);else if(e=="multiplicativeexpression"){a.factor=this._bindFilter(a.factor,b);for(e=0;e<a.factors.length;e++)a.factors[e].expression=this._bindFilter(a.factors[e].expression,b)}else if(e=="unaryexpression")a.expression=this._bindFilter(a.expression,b);else if(e=="irireforfunction")for(e=0;e<a.factors.args;e++)a.args[e]=this._bindFilter(a.args[e],b);else if(e=="atomic"&&a.primaryexpression=="var"&&b[a.value.value]!=null)e=b[a.value.value],a.primaryexpression=e.token===
"uri"?"iri":"literal",a.value=e}return a};F.AbstractQueryTree.prototype.replace=function(a,b,e,d){if(a.graph!=null&&a.graph.token&&a.graph.token===b.token&&a.graph.value==b.value)a.graph=s.clone(e);if(a.filter!=null){for(var g=[],i=0;i<a.filter.length;i++)a.filter[i].value=this._replaceFilter(a.filter[i].value,b,e,d),g.push(a.filter[i]);a.filter=g}if(a.kind==="select")a.pattern=this.replace(a.pattern,b,e,d);else if(a.kind==="BGP")a.value=this._replaceTripleContext(a.value,b,e,d);else if(a.kind===
"ZERO_OR_MORE_PATH"){a.path=this._replaceTripleContext(a.path,b,e,d);if(a.x&&a.x.token===b.token&&a.value===b.value)a.x=s.clone(e);if(a.y&&a.y.token===b.token&&a.value===b.value)a.y=s.clone(e)}else if(a.kind==="UNION")a.value[0]=this.replace(a.value[0],b,e,d),a.value[1]=this.replace(a.value[1],b,e,d);else if(a.kind==="GRAPH")a.value=this.replace(a.value,b,e);else if(a.kind==="LEFT_JOIN"||a.kind==="JOIN")a.lvalue=this.replace(a.lvalue,b,e,d),a.rvalue=this.replace(a.rvalue,b,e,d);else if(a.kind==="FILTER")a.value=
this._replaceFilter(a.value,b,e,d);else if(a.kind!=="EMPTY_PATTERN")throw"Unknown pattern: "+a.kind;return a};F.AbstractQueryTree.prototype._replaceTripleContext=function(a,b,e,d){for(var g=0;g<a.length;g++)for(var i in a[g]){var f=a[g][i];if(f.token==="var"&&b.token==="var"&&f.value===b.value)a[g][i]=e;else if(f.token==="blank"&&b.token==="blank"&&f.value===b.value)a[g][i]=e;else if((f.token==="literal"||f.token==="uri")&&(b.token==="literal"||b.token==="uri")&&f.token===b.token&&s.lexicalFormTerm(f,
d)[f.token]===s.lexicalFormTerm(b,d)[f.token])a[g][i]=e}return a};F.AbstractQueryTree.prototype._replaceFilter=function(a,b,e,d){if(a.expressionType!=null){var g=a.expressionType;if(g=="relationalexpression")a.op1=this._replaceFilter(a.op1,b,e,d),a.op2=this._replaceFilter(a.op2,b,e,d);else if(g=="conditionalor"||g=="conditionaland")for(g=0;g<a.operands.length;g++)a.operands[g]=this._replaceFilter(a.operands[g],b,e,d);else if(g=="additiveexpression"){a.summand=this._replaceFilter(a.summand,b,e,d);
for(g=0;g<a.summands.length;g++)a.summands[g].expression=this._replaceFilter(a.summands[g].expression,b,e,d)}else if(g=="builtincall")for(g=0;g<a.args.length;g++)a.args[g]=this._replaceFilter(a.args[g],b,e,d);else if(g=="multiplicativeexpression"){a.factor=this._replaceFilter(a.factor,b,e,d);for(g=0;g<a.factors.length;g++)a.factors[g].expression=this._replaceFilter(a.factors[g].expression,b,e,d)}else if(g=="unaryexpression")a.expression=this._replaceFilter(a.expression,b,e,d);else if(g=="irireforfunction")for(g=
0;g<a.factors.args;g++)a.args[g]=this._replaceFilter(a.args[g],b,e,d);else if(g=="atomic"){d=null;if(a.primaryexpression==b.token&&a.value==b.value)d=e.value;else if(a.primaryexpression=="iri"&&b.token=="uri"&&a.value==b.value)d=e.value;if(d!=null)a.primaryexpression=e.token==="uri"?"iri":e.token,a.value=d}}return a};F.AbstractQueryTree.prototype.treeWithUnion=function(a){if(a==null)return!1;if(a.kind==null)return!1;if(a.kind==="select")return this.treeWithUnion(a.pattern);else if(a.kind==="BGP")return this.treeWithUnion(a.value);
else if(a.kind==="ZERO_OR_MORE_PATH")return!1;else if(a.kind==="UNION")if(a.value[0].value!=null&&a.value[0].value.variables!=null&&a.value[1].value!=null&&a.value[1].value.variables!=null){if(a.value[0].variables.join("/")===a.values[1].variables.join("/"))return this.treeWithUnion(a.value[0])?!0:this.treeWithUnion(a.value[1])}else return!0;else if(a.kind==="GRAPH")return!1;else if(a.kind==="LEFT_JOIN"||a.kind==="JOIN")if(this.treeWithUnion(a.lvalue))return!0;else this.treeWithUnion(a.rvalue);else return!1};
var za={};za.parser=function(){function a(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var b={parse:function(e,b){function g(a){c<Aa||(c>Aa&&(Aa=c,mb=[]),mb.push(a))}function i(){var a,e,b,ga;j++;ga=b=c;a=f();a!==null?(e=o(),e===null&&(e=t(),e===null&&(e=s(),e===null&&(e=A()))),e!==null?a=[a,e]:(a=null,c=ga)):(a=null,c=ga);
a!==null&&(a={token:"query",kind:"query",prologue:a[0],units:[a[1]]});a===null&&(c=b);j--;j===0&&a===null&&g("[2] Query");return a}function f(){var a,e,b,ga,d,f;j++;f=d=c;a=h();a=a!==null?a:"";if(a!==null){e=[];for(b=l();b!==null;)e.push(b),b=l();if(e!==null){b=[];for(ga=k();ga!==null;)b.push(ga),ga=k();b!==null?a=[a,e,b]:(a=null,c=f)}else a=null,c=f}else a=null,c=f;a!==null&&(a={token:"prologue",base:a[0],prefixes:a[2]});a===null&&(c=d);j--;j===0&&a===null&&g("[3] Prologue");return a}function h(){var a,
b,r,d,B,f;j++;f=B=c;a=[];for(b=l();b!==null;)a.push(b),b=l();if(a!==null)if(e.substr(c,4)==="BASE"?(b="BASE",c+=4):(b=null,j===0&&g('"BASE"')),b===null&&(e.substr(c,4)==="base"?(b="base",c+=4):(b=null,j===0&&g('"base"'))),b!==null){r=[];for(d=l();d!==null;)r.push(d),d=l();r!==null?(d=Ja(),d!==null?a=[a,b,r,d]:(a=null,c=f)):(a=null,c=f)}else a=null,c=f;else a=null,c=f;a!==null&&(a=function(a,x){var c={token:"base"};c.value=x;return c}(B,a[3]));a===null&&(c=B);j--;j===0&&a===null&&g("[4] BaseDecl");
return a}function k(){var a,b,r,d,B,f,i,h;j++;h=i=c;a=[];for(b=l();b!==null;)a.push(b),b=l();if(a!==null)if(e.substr(c,6)==="PREFIX"?(b="PREFIX",c+=6):(b=null,j===0&&g('"PREFIX"')),b===null&&(e.substr(c,6)==="prefix"?(b="prefix",c+=6):(b=null,j===0&&g('"prefix"'))),b!==null){r=[];for(d=l();d!==null;)r.push(d),d=l();if(r!==null)if(d=Ka(),d!==null){B=[];for(f=l();f!==null;)B.push(f),f=l();B!==null?(f=Ja(),f!==null?a=[a,b,r,d,B,f]:(a=null,c=h)):(a=null,c=h)}else a=null,c=h;else a=null,c=h}else a=null,
c=h;else a=null,c=h;a!==null&&(a=function(a,x,c){a={token:"prefix"};a.prefix=x;a.local=c;return a}(i,a[3],a[5]));a===null&&(c=i);j--;j===0&&a===null&&g("[5] PrefixDecl");return a}function o(){var a,e,b,d,B,f,i,h,K,n,k;j++;k=n=c;a=q();if(a!==null){e=[];for(b=l();b!==null;)e.push(b),b=l();if(e!==null){b=[];for(d=y();d!==null;)b.push(d),d=y();if(b!==null){d=[];for(B=l();B!==null;)d.push(B),B=l();if(d!==null)if(B=z(),B!==null){f=[];for(i=l();i!==null;)f.push(i),i=l();if(f!==null)if(i=E(),i!==null){h=
[];for(K=l();K!==null;)h.push(K),K=l();h!==null?(K=Y(),K!==null?a=[a,e,b,d,B,f,i,h,K]:(a=null,c=k)):(a=null,c=k)}else a=null,c=k;else a=null,c=k}else a=null,c=k;else a=null,c=k}else a=null,c=k}else a=null,c=k}else a=null,c=k;a!==null&&(a=function(a,x,c,e,b){for(var a={named:[],implicit:[]},g=0;g<c.length;g++){var r=c[g];r.kind==="default"?a.implicit.push(r.graph):a.named.push(r.graph)}a.named.length===0&&a.implicit.length===0&&a.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});
c={kind:"select",token:"executableunit"};c.dataset=a;c.projection=x.vars;c.modifier=x.modifier;c.pattern=e;if(b!=null&&b.limit!=null)c.limit=b.limit;if(b!=null&&b.offset!=null)c.offset=b.offset;if(b!=null&&b.order!=null&&b.order!="")c.order=b.order;if(b!=null&&b.group!=null)c.group=b.group;return c}(n,a[0],a[2],a[4],a[6]));a===null&&(c=n);j--;j===0&&a===null&&g("[6] SelectQuery");return a}function m(){var a,e,b,d;j++;d=c;a=q();a!==null?(e=z(),e!==null?(b=E(),b!==null?a=[a,e,b]:(a=null,c=d)):(a=null,
c=d)):(a=null,c=d);j--;j===0&&a===null&&g("[7] SubSelect");return a}function q(){var a,b,r,d,B,f,i,h,K,n,k,m,o,w,t,Q,u,s,v,L,y;j++;L=v=c;a=[];for(b=l();b!==null;)a.push(b),b=l();if(a!==null)if(e.substr(c,6)==="SELECT"?(b="SELECT",c+=6):(b=null,j===0&&g('"SELECT"')),b===null&&(e.substr(c,6)==="select"?(b="select",c+=6):(b=null,j===0&&g('"select"'))),b!==null){r=[];for(d=l();d!==null;)r.push(d),d=l();if(r!==null)if(e.substr(c,8)==="DISTINCT"?(d="DISTINCT",c+=8):(d=null,j===0&&g('"DISTINCT"')),d===null&&
(e.substr(c,8)==="distinct"?(d="distinct",c+=8):(d=null,j===0&&g('"distinct"'))),d===null&&(e.substr(c,7)==="REDUCED"?(d="REDUCED",c+=7):(d=null,j===0&&g('"REDUCED"')),d===null&&(e.substr(c,7)==="reduced"?(d="reduced",c+=7):(d=null,j===0&&g('"reduced"')))),d=d!==null?d:"",d!==null){B=[];for(f=l();f!==null;)B.push(f),f=l();if(B!==null){y=c;i=[];for(h=l();h!==null;)i.push(h),h=l();if(i!==null)if(h=N(),h!==null){K=[];for(n=l();n!==null;)K.push(n),n=l();K!==null?i=[i,h,K]:(i=null,c=y)}else i=null,c=y;
else i=null,c=y;if(i===null){y=c;i=[];for(h=l();h!==null;)i.push(h),h=l();if(i!==null)if(e.charCodeAt(c)===40?(h="(",c++):(h=null,j===0&&g('"("')),h!==null){K=[];for(n=l();n!==null;)K.push(n),n=l();if(K!==null)if(n=H(),n!==null){k=[];for(m=l();m!==null;)k.push(m),m=l();if(k!==null)if(e.substr(c,2)==="AS"?(m="AS",c+=2):(m=null,j===0&&g('"AS"')),m===null&&(e.substr(c,2)==="as"?(m="as",c+=2):(m=null,j===0&&g('"as"'))),m!==null){o=[];for(w=l();w!==null;)o.push(w),w=l();if(o!==null)if(w=N(),w!==null){t=
[];for(Q=l();Q!==null;)t.push(Q),Q=l();if(t!==null)if(e.charCodeAt(c)===41?(Q=")",c++):(Q=null,j===0&&g('")"')),Q!==null){u=[];for(s=l();s!==null;)u.push(s),s=l();u!==null?i=[i,h,K,n,k,m,o,w,t,Q,u]:(i=null,c=y)}else i=null,c=y;else i=null,c=y}else i=null,c=y;else i=null,c=y}else i=null,c=y;else i=null,c=y}else i=null,c=y;else i=null,c=y}else i=null,c=y;else i=null,c=y}if(i!==null)for(f=[];i!==null;){f.push(i);y=c;i=[];for(h=l();h!==null;)i.push(h),h=l();if(i!==null)if(h=N(),h!==null){K=[];for(n=l();n!==
null;)K.push(n),n=l();K!==null?i=[i,h,K]:(i=null,c=y)}else i=null,c=y;else i=null,c=y;if(i===null){y=c;i=[];for(h=l();h!==null;)i.push(h),h=l();if(i!==null)if(e.charCodeAt(c)===40?(h="(",c++):(h=null,j===0&&g('"("')),h!==null){K=[];for(n=l();n!==null;)K.push(n),n=l();if(K!==null)if(n=H(),n!==null){k=[];for(m=l();m!==null;)k.push(m),m=l();if(k!==null)if(e.substr(c,2)==="AS"?(m="AS",c+=2):(m=null,j===0&&g('"AS"')),m===null&&(e.substr(c,2)==="as"?(m="as",c+=2):(m=null,j===0&&g('"as"'))),m!==null){o=
[];for(w=l();w!==null;)o.push(w),w=l();if(o!==null)if(w=N(),w!==null){t=[];for(Q=l();Q!==null;)t.push(Q),Q=l();if(t!==null)if(e.charCodeAt(c)===41?(Q=")",c++):(Q=null,j===0&&g('")"')),Q!==null){u=[];for(s=l();s!==null;)u.push(s),s=l();u!==null?i=[i,h,K,n,k,m,o,w,t,Q,u]:(i=null,c=y)}else i=null,c=y;else i=null,c=y}else i=null,c=y;else i=null,c=y}else i=null,c=y;else i=null,c=y}else i=null,c=y;else i=null,c=y}else i=null,c=y;else i=null,c=y}}else f=null;if(f===null){y=c;f=[];for(i=l();i!==null;)f.push(i),
i=l();if(f!==null)if(e.charCodeAt(c)===42?(i="*",c++):(i=null,j===0&&g('"*"')),i!==null){h=[];for(K=l();K!==null;)h.push(K),K=l();h!==null?f=[f,i,h]:(f=null,c=y)}else f=null,c=y;else f=null,c=y}f!==null?a=[a,b,r,d,B,f]:(a=null,c=L)}else a=null,c=L}else a=null,c=L;else a=null,c=L}else a=null,c=L;else a=null,c=L;a!==null&&(a=function(a,x,c){a=[];if(c.length===3&&c[1]==="*")return{vars:[{token:"variable",kind:"*"}],modifier:xb(x)};for(var e=0;e<c.length;e++){var b=c[e];b.length===3?a.push({token:"variable",
kind:"var",value:b[1]}):a.push({token:"variable",kind:"aliased",expression:b[3],alias:b[7]})}return{vars:a,modifier:xb(x)}}(v,a[3],a[5]));a===null&&(c=v);j--;j===0&&a===null&&g("[8] SelectClause");return a}function t(){var a,b,r,d,B,f,i,h,n,k,m,o;j++;o=m=c;a=[];for(b=l();b!==null;)a.push(b),b=l();if(a!==null)if(e.substr(c,9)==="CONSTRUCT"?(b="CONSTRUCT",c+=9):(b=null,j===0&&g('"CONSTRUCT"')),b===null&&(e.substr(c,9)==="construct"?(b="construct",c+=9):(b=null,j===0&&g('"construct"'))),b!==null){r=
[];for(d=l();d!==null;)r.push(d),d=l();if(r!==null)if(d=yb(),d!==null){B=[];for(f=l();f!==null;)B.push(f),f=l();if(B!==null){f=[];for(i=y();i!==null;)f.push(i),i=y();if(f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();if(i!==null)if(h=z(),h!==null){n=[];for(k=l();k!==null;)n.push(k),k=l();n!==null?(k=E(),k!==null?a=[a,b,r,d,B,f,i,h,n,k]:(a=null,c=o)):(a=null,c=o)}else a=null,c=o;else a=null,c=o}else a=null,c=o}else a=null,c=o}else a=null,c=o;else a=null,c=o}else a=null,c=o;else a=null,c=o;a!==null&&
(a=function(a,x,c,e,b){for(var a={named:[],implicit:[]},g=0;g<c.length;g++){var r=c[g];r.kind==="default"?a.implicit.push(r.graph):a.named.push(r.graph)}a.named.length===0&&a.implicit.length===0&&a.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});c={kind:"construct",token:"executableunit"};c.dataset=a;c.template=x;c.pattern=e;if(b!=null&&b.limit!=null)c.limit=b.limit;if(b!=null&&b.offset!=null)c.offset=b.offset;if(b!=null&&b.order!=
null&&b.order!="")c.order=b.order;return c}(m,a[3],a[5],a[7],a[9]));a===null&&(c=m);j--;j===0&&a===null&&g("[9] ConstructQuery");return a}function s(){var a,b,r,d,B,f;j++;f=c;e.substr(c,8)==="DESCRIBE"?(a="DESCRIBE",c+=8):(a=null,j===0&&g('"DESCRIBE"'));if(a!==null){r=ka();if(r!==null)for(b=[];r!==null;)b.push(r),r=ka();else b=null;b===null&&(e.charCodeAt(c)===42?(b="*",c++):(b=null,j===0&&g('"*"')));if(b!==null){r=[];for(d=y();d!==null;)r.push(d),d=y();r!==null?(d=z(),d=d!==null?d:"",d!==null?(B=
E(),B!==null?a=[a,b,r,d,B]:(a=null,c=f)):(a=null,c=f)):(a=null,c=f)}else a=null,c=f}else a=null,c=f;j--;j===0&&a===null&&g("[10] DescribeQuery");return a}function A(){var a,b,r,d,B,f,i,h;j++;h=i=c;a=[];for(b=l();b!==null;)a.push(b),b=l();if(a!==null)if(e.substr(c,3)==="ASK"?(b="ASK",c+=3):(b=null,j===0&&g('"ASK"')),b===null&&(e.substr(c,3)==="ask"?(b="ask",c+=3):(b=null,j===0&&g('"ask"'))),b!==null){r=[];for(d=l();d!==null;)r.push(d),d=l();if(r!==null){d=[];for(B=y();B!==null;)d.push(B),B=y();if(d!==
null){B=[];for(f=l();f!==null;)B.push(f),f=l();B!==null?(f=z(),f!==null?a=[a,b,r,d,B,f]:(a=null,c=h)):(a=null,c=h)}else a=null,c=h}else a=null,c=h}else a=null,c=h;else a=null,c=h;a!==null&&(a=function(a,x,c){for(var a={named:[],implicit:[]},e=0;e<x.length;e++){var b=x[e];b.kind==="implicit"?a.implicit.push(b.graph):a.named.push(b.graph)}a.named.length===0&&a.implicit.length===0&&a.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});
x={kind:"ask",token:"executableunit"};x.dataset=a;x.pattern=c;return x}(i,a[3],a[5]));a===null&&(c=i);j--;j===0&&a===null&&g("[11] AskQuery");return a}function y(){var a,b,r,d,B,f,i;j++;i=f=c;e.substr(c,4)==="FROM"?(a="FROM",c+=4):(a=null,j===0&&g('"FROM"'));a===null&&(e.substr(c,4)==="from"?(a="from",c+=4):(a=null,j===0&&g('"from"')));if(a!==null){b=[];for(r=l();r!==null;)b.push(r),r=l();if(b!==null)if(r=C(),r===null&&(r=D()),r!==null){d=[];for(B=l();B!==null;)d.push(B),B=l();d!==null?a=[a,b,r,d]:
(a=null,c=i)}else a=null,c=i;else a=null,c=i}else a=null,c=i;a!==null&&(a=a[2]);a===null&&(c=f);j--;j===0&&a===null&&g("[12] DatasetClause");return a}function C(){var a,e,b,d;j++;d=b=c;a=[];for(e=l();e!==null;)a.push(e),e=l();a!==null?(e=O(),e!==null?a=[a,e]:(a=null,c=d)):(a=null,c=d);a!==null&&(a={graph:a[1],kind:"default",token:"graphClause"});a===null&&(c=b);j--;j===0&&a===null&&g("[13] DefaultGraphClause");return a}function D(){var a,b,r,d,B;j++;B=d=c;e.substr(c,5)==="NAMED"?(a="NAMED",c+=5):
(a=null,j===0&&g('"NAMED"'));a===null&&(e.substr(c,5)==="named"?(a="named",c+=5):(a=null,j===0&&g('"named"')));if(a!==null){b=[];for(r=l();r!==null;)b.push(r),r=l();b!==null?(r=O(),r!==null?a=[a,b,r]:(a=null,c=B)):(a=null,c=B)}else a=null,c=B;a!==null&&(a={graph:a[2],kind:"named",token:"graphCluase"});a===null&&(c=d);j--;j===0&&a===null&&g("[14] NamedGraphClause");return a}function z(){var a,b,r,d,B,f,i;j++;i=f=c;e.substr(c,5)==="WHERE"?(a="WHERE",c+=5):(a=null,j===0&&g('"WHERE"'));a===null&&(e.substr(c,
5)==="where"?(a="where",c+=5):(a=null,j===0&&g('"where"')));a=a!==null?a:"";if(a!==null){b=[];for(r=l();r!==null;)b.push(r),r=l();if(b!==null)if(r=S(),r!==null){d=[];for(B=l();B!==null;)d.push(B),B=l();d!==null?a=[a,b,r,d]:(a=null,c=i)}else a=null,c=i;else a=null,c=i}else a=null,c=i;a!==null&&(a=a[2]);a===null&&(c=f);j--;j===0&&a===null&&g("[16] WhereClause");return a}function E(){var a,e,b,d,B,f;j++;f=B=c;a=I();a=a!==null?a:"";a!==null?(e=G(),e=e!==null?e:"",e!==null?(b=P(),b=b!==null?b:"",b!==null?
(d=T(),d=d!==null?d:"",d!==null?a=[a,e,b,d]:(a=null,c=f)):(a=null,c=f)):(a=null,c=f)):(a=null,c=f);a!==null&&(a=function(a,x,c,e){a={};if(e!=null){if(e.limit!=null)a.limit=e.limit;if(e.offset!=null)a.offset=e.offset}if(x!=null)a.group=x;a.order=c;return a}(B,a[0],a[2],a[3]));a===null&&(c=B);j--;j===0&&a===null&&g("[17] SolutionModifier");return a}function I(){var a,b,r,d,B,f,i,h;j++;h=i=c;e.substr(c,5)==="GROUP"?(a="GROUP",c+=5):(a=null,j===0&&g('"GROUP"'));a===null&&(e.substr(c,5)==="group"?(a="group",
c+=5):(a=null,j===0&&g('"group"')));if(a!==null){b=[];for(r=l();r!==null;)b.push(r),r=l();if(b!==null)if(e.substr(c,2)==="BY"?(r="BY",c+=2):(r=null,j===0&&g('"BY"')),r===null&&(e.substr(c,2)==="by"?(r="by",c+=2):(r=null,j===0&&g('"by"'))),r!==null){d=[];for(B=l();B!==null;)d.push(B),B=l();if(d!==null){f=F();if(f!==null)for(B=[];f!==null;)B.push(f),f=F();else B=null;B!==null?a=[a,b,r,d,B]:(a=null,c=h)}else a=null,c=h}else a=null,c=h;else a=null,c=h}else a=null,c=h;a!==null&&(a=a[4]);a===null&&(c=i);
j--;j===0&&a===null&&g("[18] GroupClause");return a}function F(){var a,b,r,d,B,f,i,h,n,k,m,o;j++;o=m=c;a=[];for(b=l();b!==null;)a.push(b),b=l();if(a!==null)if(b=Ma(),b!==null){r=[];for(d=l();d!==null;)r.push(d),d=l();r!==null?a=[a,b,r]:(a=null,c=o)}else a=null,c=o;else a=null,c=o;a!==null&&(a=a[1]);a===null&&(c=m);if(a===null){o=m=c;a=[];for(b=l();b!==null;)a.push(b),b=l();if(a!==null)if(b=nb(),b!==null){r=[];for(d=l();d!==null;)r.push(d),d=l();r!==null?a=[a,b,r]:(a=null,c=o)}else a=null,c=o;else a=
null,c=o;a!==null&&(a=a[1]);a===null&&(c=m);if(a===null){o=m=c;a=[];for(b=l();b!==null;)a.push(b),b=l();if(a!==null)if(e.charCodeAt(c)===40?(b="(",c++):(b=null,j===0&&g('"("')),b!==null){r=[];for(d=l();d!==null;)r.push(d),d=l();if(r!==null)if(d=H(),d!==null){B=[];for(f=l();f!==null;)B.push(f),f=l();if(B!==null){n=c;e.substr(c,2)==="AS"?(f="AS",c+=2):(f=null,j===0&&g('"AS"'));f===null&&(e.substr(c,2)==="as"?(f="as",c+=2):(f=null,j===0&&g('"as"')));if(f!==null){i=[];for(h=l();h!==null;)i.push(h),h=
l();i!==null?(h=N(),h!==null?f=[f,i,h]:(f=null,c=n)):(f=null,c=n)}else f=null,c=n;f=f!==null?f:"";if(f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();if(i!==null)if(e.charCodeAt(c)===41?(h=")",c++):(h=null,j===0&&g('")"')),h!==null){n=[];for(k=l();k!==null;)n.push(k),k=l();n!==null?a=[a,b,r,d,B,f,i,h,n]:(a=null,c=o)}else a=null,c=o;else a=null,c=o}else a=null,c=o}else a=null,c=o}else a=null,c=o;else a=null,c=o}else a=null,c=o;else a=null,c=o;a!==null&&(a=a[5].length!=0?{token:"aliased_expression",
expression:a[3],alias:a[5][2]}:a[3]);a===null&&(c=m);if(a===null){o=m=c;a=[];for(b=l();b!==null;)a.push(b),b=l();if(a!==null)if(b=N(),b!==null){r=[];for(d=l();d!==null;)r.push(d),d=l();r!==null?a=[a,b,r]:(a=null,c=o)}else a=null,c=o;else a=null,c=o;a!==null&&(a=a[1]);a===null&&(c=m)}}}j--;j===0&&a===null&&g("[19] GroupCondition");return a}function G(){var a,b,r,d;j++;d=c;e.substr(c,6)==="HAVING"?(a="HAVING",c+=6):(a=null,j===0&&g('"HAVING"'));if(a!==null){r=Ba();if(r!==null)for(b=[];r!==null;)b.push(r),
r=Ba();else b=null;b!==null?a=[a,b]:(a=null,c=d)}else a=null,c=d;j--;j===0&&a===null&&g("[20] HavingClause");return a}function P(){var a,b,r,d,f,i,h,n,k;j++;k=n=c;e.substr(c,5)==="ORDER"?(a="ORDER",c+=5):(a=null,j===0&&g('"ORDER"'));a===null&&(e.substr(c,5)==="order"?(a="order",c+=5):(a=null,j===0&&g('"order"')));if(a!==null){b=[];for(r=l();r!==null;)b.push(r),r=l();if(b!==null)if(e.substr(c,2)==="BY"?(r="BY",c+=2):(r=null,j===0&&g('"BY"')),r===null&&(e.substr(c,2)==="by"?(r="by",c+=2):(r=null,j===
0&&g('"by"'))),r!==null){d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null){i=M();if(i!==null)for(f=[];i!==null;)f.push(i),i=M();else f=null;if(f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?a=[a,b,r,d,f,i]:(a=null,c=k)}else a=null,c=k}else a=null,c=k}else a=null,c=k;else a=null,c=k}else a=null,c=k;a!==null&&(a=a[4]);a===null&&(c=n);j--;j===0&&a===null&&g("[22] OrderClause");return a}function M(){var a,b,r,d,f,i,h;j++;h=i=c;e.substr(c,3)==="ASC"?(a="ASC",c+=3):(a=null,j===0&&g('"ASC"'));
a===null&&(e.substr(c,3)==="asc"?(a="asc",c+=3):(a=null,j===0&&g('"asc"')),a===null&&(e.substr(c,4)==="DESC"?(a="DESC",c+=4):(a=null,j===0&&g('"DESC"')),a===null&&(e.substr(c,4)==="desc"?(a="desc",c+=4):(a=null,j===0&&g('"desc"')))));if(a!==null){b=[];for(r=l();r!==null;)b.push(r),r=l();if(b!==null)if(r=Na(),r!==null){d=[];for(f=l();f!==null;)d.push(f),f=l();d!==null?a=[a,b,r,d]:(a=null,c=h)}else a=null,c=h;else a=null,c=h}else a=null,c=h;a!==null&&(a={direction:a[0].toUpperCase(),expression:a[2]});
a===null&&(c=i);if(a===null){h=i=c;a=Ba();a===null&&(a=N());if(a!==null){b=[];for(r=l();r!==null;)b.push(r),r=l();b!==null?a=[a,b]:(a=null,c=h)}else a=null,c=h;a!==null&&(a=function(a,x){x.token==="var"&&(x={token:"expression",expressionType:"atomic",primaryexpression:"var",value:x});return{direction:"ASC",expression:x}}(i,a[0]));a===null&&(c=i)}j--;j===0&&a===null&&g("[23] OrderCondition");return a}function T(){var a,e,b,d;j++;d=b=c;a=V();a!==null?(e=W(),e=e!==null?e:"",e!==null?a=[a,e]:(a=null,
c=d)):(a=null,c=d);a===null&&(d=c,a=W(),a!==null?(e=V(),e=e!==null?e:"",e!==null?a=[a,e]:(a=null,c=d)):(a=null,c=d));a!==null&&(a=function(a,x){for(var c={},e=0;e<x.length;e++){var b=x[e];if(b.limit!=null)c.limit=b.limit;else if(b.offset!=null)c.offset=b.offset}return c}(b,a));a===null&&(c=b);j--;j===0&&a===null&&g("[24] LimitOffsetClauses");return a}function V(){var a,b,r,d,f,i,h;j++;h=i=c;e.substr(c,5)==="LIMIT"?(a="LIMIT",c+=5):(a=null,j===0&&g('"LIMIT"'));a===null&&(e.substr(c,5)==="limit"?(a=
"limit",c+=5):(a=null,j===0&&g('"limit"')));if(a!==null){b=[];for(r=l();r!==null;)b.push(r),r=l();if(b!==null)if(r=aa(),r!==null){d=[];for(f=l();f!==null;)d.push(f),f=l();d!==null?a=[a,b,r,d]:(a=null,c=h)}else a=null,c=h;else a=null,c=h}else a=null,c=h;a!==null&&(a={limit:parseInt(a[2].value)});a===null&&(c=i);j--;j===0&&a===null&&g("[25] LimitClause");return a}function W(){var a,b,r,d,f,i,h;j++;h=i=c;e.substr(c,6)==="OFFSET"?(a="OFFSET",c+=6):(a=null,j===0&&g('"OFFSET"'));a===null&&(e.substr(c,6)===
"offset"?(a="offset",c+=6):(a=null,j===0&&g('"offset"')));if(a!==null){b=[];for(r=l();r!==null;)b.push(r),r=l();if(b!==null)if(r=aa(),r!==null){d=[];for(f=l();f!==null;)d.push(f),f=l();d!==null?a=[a,b,r,d]:(a=null,c=h)}else a=null,c=h;else a=null,c=h}else a=null,c=h;a!==null&&(a={offset:parseInt(a[2].value)});a===null&&(c=i);j--;j===0&&a===null&&g("[26] OffsetClause");return a}function Y(){var a,b,r,d,f,i,h,l,n;j++;l=c;e.substr(c,8)==="BINDINGS"?(a="BINDINGS",c+=8):(a=null,j===0&&g('"BINDINGS"'));
if(a!==null){b=[];for(r=N();r!==null;)b.push(r),r=N();if(b!==null)if(e.charCodeAt(c)===123?(r="{",c++):(r=null,j===0&&g('"{"')),r!==null){d=[];n=c;e.charCodeAt(c)===40?(f="(",c++):(f=null,j===0&&g('"("'));if(f!==null){h=U();if(h!==null)for(i=[];h!==null;)i.push(h),h=U();else i=null;i!==null?(e.charCodeAt(c)===41?(h=")",c++):(h=null,j===0&&g('")"')),h!==null?f=[f,i,h]:(f=null,c=n)):(f=null,c=n)}else f=null,c=n;for(f===null&&(f=la());f!==null;){d.push(f);n=c;e.charCodeAt(c)===40?(f="(",c++):(f=null,
j===0&&g('"("'));if(f!==null){h=U();if(h!==null)for(i=[];h!==null;)i.push(h),h=U();else i=null;i!==null?(e.charCodeAt(c)===41?(h=")",c++):(h=null,j===0&&g('")"')),h!==null?f=[f,i,h]:(f=null,c=n)):(f=null,c=n)}else f=null,c=n;f===null&&(f=la())}d!==null?(e.charCodeAt(c)===125?(f="}",c++):(f=null,j===0&&g('"}"')),f!==null?a=[a,b,r,d,f]:(a=null,c=l)):(a=null,c=l)}else a=null,c=l;else a=null,c=l}else a=null,c=l;a=a!==null?a:"";j--;j===0&&a===null&&g("[27] BindingsClause");return a}function U(){var a;
j++;a=O();a===null&&(a=Oa(),a===null&&(a=Pa(),a===null&&(a=Qa(),a===null&&(e.substr(c,5)==="UNDEF"?(a="UNDEF",c+=5):(a=null,j===0&&g('"UNDEF"'))))));j--;j===0&&a===null&&g("[28] BindingValue");return a}function $(){var a,b,r,d,B,i,h,n,k,m;j++;k=n=c;a=f();if(a!==null){b=[];for(r=l();r!==null;)b.push(r),r=l();if(b!==null)if(r=ea(),r!==null){m=c;d=[];for(B=l();B!==null;)d.push(B),B=l();if(d!==null)if(e.charCodeAt(c)===59?(B=";",c++):(B=null,j===0&&g('";"')),B!==null){i=[];for(h=l();h!==null;)i.push(h),
h=l();i!==null?(h=$(),h=h!==null?h:"",h!==null?d=[d,B,i,h]:(d=null,c=m)):(d=null,c=m)}else d=null,c=m;else d=null,c=m;d=d!==null?d:"";d!==null?a=[a,b,r,d]:(a=null,c=k)}else a=null,c=k;else a=null,c=k}else a=null,c=k;a!==null&&(a=function(a,x,c,e){a={token:"query",kind:"update"};a.prologue=x;x=[c];e.length!=null&&e[3]!=null&&e[3].units!=null&&(x=x.concat(e[3].units));a.units=x;return a}(n,a[0],a[2],a[3]));a===null&&(c=n);j--;j===0&&a===null&&g("[30] Update");return a}function ea(){var a;j++;a=fa();
a===null&&(a=ha(),a===null&&(a=ia(),a===null&&(a=ja(),a===null&&(a=na(),a===null&&(a=oa(),a===null&&(a=va(),a===null&&(a=wa())))))));j--;j===0&&a===null&&g("[31] Update1");return a}function fa(){var a,b,r,d,f,i,h,n,k,m;j++;k=n=c;e.substr(c,4)==="LOAD"?(a="LOAD",c+=4):(a=null,j===0&&g('"LOAD"'));a===null&&(e.substr(c,4)==="load"?(a="load",c+=4):(a=null,j===0&&g('"load"')));if(a!==null){b=[];for(r=l();r!==null;)b.push(r),r=l();if(b!==null)if(r=O(),r!==null){d=[];for(f=l();f!==null;)d.push(f),f=l();
if(d!==null){m=c;e.substr(c,4)==="INTO"?(f="INTO",c+=4):(f=null,j===0&&g('"INTO"'));f===null&&(e.substr(c,4)==="into"?(f="into",c+=4):(f=null,j===0&&g('"into"')));if(f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?(h=Ia(),h!==null?f=[f,i,h]:(f=null,c=m)):(f=null,c=m)}else f=null,c=m;f=f!==null?f:"";f!==null?a=[a,b,r,d,f]:(a=null,c=k)}else a=null,c=k}else a=null,c=k;else a=null,c=k}else a=null,c=k;a!==null&&(a=function(a,c,x){a={kind:"load",token:"executableunit"};a.sourceGraph=c;a.destinyGraph=
x[2];return a}(n,a[2],a[4]));a===null&&(c=n);j--;j===0&&a===null&&g("[32] Load");return a}function ha(){var a,b,r,d,f,i,h;j++;h=i=c;e.substr(c,5)==="CLEAR"?(a="CLEAR",c+=5):(a=null,j===0&&g('"CLEAR"'));a===null&&(e.substr(c,5)==="clear"?(a="clear",c+=5):(a=null,j===0&&g('"clear"')));if(a!==null){b=[];for(r=l();r!==null;)b.push(r),r=l();if(b!==null)if(e.substr(c,6)==="SILENT"?(r="SILENT",c+=6):(r=null,j===0&&g('"SILENT"')),r===null&&(e.substr(c,6)==="silent"?(r="silent",c+=6):(r=null,j===0&&g('"silent"'))),
r=r!==null?r:"",r!==null){d=[];for(f=l();f!==null;)d.push(f),f=l();d!==null?(f=gb(),f!==null?a=[a,b,r,d,f]:(a=null,c=h)):(a=null,c=h)}else a=null,c=h;else a=null,c=h}else a=null,c=h;a!==null&&(a=function(a,c){var x={kind:"clear",token:"executableunit"};x.destinyGraph=c;return x}(i,a[4]));a===null&&(c=i);j--;j===0&&a===null&&g("[33] Clear");return a}function ia(){var a,b,r,d,f,i,h;j++;h=i=c;e.substr(c,4)==="DROP"?(a="DROP",c+=4):(a=null,j===0&&g('"DROP"'));a===null&&(e.substr(c,4)==="drop"?(a="drop",
c+=4):(a=null,j===0&&g('"drop"')));if(a!==null){b=[];for(r=l();r!==null;)b.push(r),r=l();if(b!==null)if(e.substr(c,6)==="SILENT"?(r="SILENT",c+=6):(r=null,j===0&&g('"SILENT"')),r===null&&(e.substr(c,6)==="silent"?(r="silent",c+=6):(r=null,j===0&&g('"silent"'))),r=r!==null?r:"",r!==null){d=[];for(f=l();f!==null;)d.push(f),f=l();d!==null?(f=gb(),f!==null?a=[a,b,r,d,f]:(a=null,c=h)):(a=null,c=h)}else a=null,c=h;else a=null,c=h}else a=null,c=h;a!==null&&(a=function(a,c){var x={kind:"drop",token:"executableunit"};
x.destinyGraph=c;return x}(i,a[4]));a===null&&(c=i);j--;j===0&&a===null&&g("[34] Drop");return a}function ja(){var a,b,r,d,f,i,h;j++;h=i=c;e.substr(c,6)==="CREATE"?(a="CREATE",c+=6):(a=null,j===0&&g('"CREATE"'));a===null&&(e.substr(c,6)==="create"?(a="create",c+=6):(a=null,j===0&&g('"create"')));if(a!==null){b=[];for(r=l();r!==null;)b.push(r),r=l();if(b!==null)if(e.substr(c,6)==="SILENT"?(r="SILENT",c+=6):(r=null,j===0&&g('"SILENT"')),r===null&&(e.substr(c,6)==="silent"?(r="silent",c+=6):(r=null,
j===0&&g('"silent"'))),r=r!==null?r:"",r!==null){d=[];for(f=l();f!==null;)d.push(f),f=l();d!==null?(f=Ia(),f!==null?a=[a,b,r,d,f]:(a=null,c=h)):(a=null,c=h)}else a=null,c=h;else a=null,c=h}else a=null,c=h;a!==null&&(a=function(a,c){var x={kind:"create",token:"executableunit"};x.destinyGraph=c;return x}(i,a[4]));a===null&&(c=i);j--;j===0&&a===null&&g("[35] Create");return a}function na(){var a,b,r,d,f,i,h;j++;h=i=c;e.substr(c,6)==="INSERT"?(a="INSERT",c+=6):(a=null,j===0&&g('"INSERT"'));a===null&&
(e.substr(c,6)==="insert"?(a="insert",c+=6):(a=null,j===0&&g('"insert"')));if(a!==null){b=[];for(r=l();r!==null;)b.push(r),r=l();if(b!==null)if(e.substr(c,4)==="DATA"?(r="DATA",c+=4):(r=null,j===0&&g('"DATA"')),r===null&&(e.substr(c,4)==="data"?(r="data",c+=4):(r=null,j===0&&g('"data"'))),r!==null){d=[];for(f=l();f!==null;)d.push(f),f=l();d!==null?(f=db(),f!==null?a=[a,b,r,d,f]:(a=null,c=h)):(a=null,c=h)}else a=null,c=h;else a=null,c=h}else a=null,c=h;a!==null&&(a=function(a,c){var x={kind:"insertdata",
token:"executableunit"};x.quads=c;return x}(i,a[4]));a===null&&(c=i);j--;j===0&&a===null&&g("[36] InsertData");return a}function oa(){var a,b,r,d,f,i;j++;i=f=c;e.substr(c,6)==="DELETE"?(a="DELETE",c+=6):(a=null,j===0&&g('"DELETE"'));a===null&&(e.substr(c,6)==="delete"?(a="delete",c+=6):(a=null,j===0&&g('"delete"')));if(a!==null){b=[];for(r=l();r!==null;)b.push(r),r=l();b!==null?(e.substr(c,4)==="DATA"?(r="DATA",c+=4):(r=null,j===0&&g('"DATA"')),r===null&&(e.substr(c,4)==="data"?(r="data",c+=4):(r=
null,j===0&&g('"data"'))),r!==null?(d=db(),d!==null?a=[a,b,r,d]:(a=null,c=i)):(a=null,c=i)):(a=null,c=i)}else a=null,c=i;a!==null&&(a=function(a,c){var e={kind:"deletedata",token:"executableunit"};e.quads=c;return e}(f,a[3]));a===null&&(c=f);j--;j===0&&a===null&&g("[37] DeleteData");return a}function va(){var a,b,r,d,f,i,h;j++;h=i=c;e.substr(c,6)==="DELETE"?(a="DELETE",c+=6):(a=null,j===0&&g('"DELETE"'));a===null&&(e.substr(c,6)==="delete"?(a="delete",c+=6):(a=null,j===0&&g('"delete"')));if(a!==null){b=
[];for(r=l();r!==null;)b.push(r),r=l();if(b!==null)if(e.substr(c,5)==="WHERE"?(r="WHERE",c+=5):(r=null,j===0&&g('"WHERE"')),r===null&&(e.substr(c,5)==="where"?(r="where",c+=5):(r=null,j===0&&g('"where"'))),r!==null){d=[];for(f=l();f!==null;)d.push(f),f=l();d!==null?(f=S(),f!==null?a=[a,b,r,d,f]:(a=null,c=h)):(a=null,c=h)}else a=null,c=h;else a=null,c=h}else a=null,c=h;a!==null&&(a=function(a,c){var e={kind:"modify"};e.pattern=c;e["with"]=null;e.using=null;for(var x=[],b=c.patterns[0],b=b.triplesContext==
null&&b.patterns!=null?b.patterns[0].triplesContext:b.triplesContext,g=0;g<b.length;g++){var r={},d=b[g];r.subject=d.subject;r.predicate=d.predicate;r.object=d.object;r.graph=d.graph;x.push(r)}e["delete"]=x;return e}(i,a[4]));a===null&&(c=i);j--;j===0&&a===null&&g("[38] DeleteWhere");return a}function wa(){var a,b,r,d,f,i,h,n,k,m,o,q,J;j++;i=J=q=c;e.substr(c,4)==="WITH"?(a="WITH",c+=4):(a=null,j===0&&g('"WITH"'));a===null&&(e.substr(c,4)==="with"?(a="with",c+=4):(a=null,j===0&&g('"with"')));if(a!==
null){b=[];for(r=l();r!==null;)b.push(r),r=l();b!==null?(r=O(),r!==null?a=[a,b,r]:(a=null,c=i)):(a=null,c=i)}else a=null,c=i;a=a!==null?a:"";if(a!==null){b=[];for(r=l();r!==null;)b.push(r),r=l();if(b!==null){i=c;r=xa();if(r!==null){d=[];for(f=l();f!==null;)d.push(f),f=l();d!==null?(f=eb(),f=f!==null?f:"",f!==null?r=[r,d,f]:(r=null,c=i)):(r=null,c=i)}else r=null,c=i;r===null&&(r=eb());if(r!==null){d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null){f=[];for(i=fb();i!==null;)f.push(i),i=fb();if(f!==
null){i=[];for(h=l();h!==null;)i.push(h),h=l();if(i!==null)if(e.substr(c,5)==="WHERE"?(h="WHERE",c+=5):(h=null,j===0&&g('"WHERE"')),h===null&&(e.substr(c,5)==="where"?(h="where",c+=5):(h=null,j===0&&g('"where"'))),h!==null){n=[];for(k=l();k!==null;)n.push(k),k=l();if(n!==null)if(k=S(),k!==null){m=[];for(o=l();o!==null;)m.push(o),o=l();m!==null?a=[a,b,r,d,f,i,h,n,k,m]:(a=null,c=J)}else a=null,c=J;else a=null,c=J}else a=null,c=J;else a=null,c=J}else a=null,c=J}else a=null,c=J}else a=null,c=J}else a=
null,c=J}else a=null,c=J;a!==null&&(a=function(a,c,e,b,x){a={kind:"modify"};a["with"]=c!=""?c[2]:null;e.length===3&&e[2]===""?(a["delete"]=e[0],a.insert=null):e.length===3&&e[0].length!=null&&e[1].length!=null&&e[2].length!=null?(a["delete"]=e[0],a.insert=e[2]):(a.insert=e,a["delete"]=null);b!=""&&(a.using=b);a.pattern=x;return a}(q,a[0],a[2],a[4],a[8]));a===null&&(c=q);j--;j===0&&a===null&&g("[39] Modify");return a}function xa(){var a,b,r,d;j++;d=r=c;e.substr(c,6)==="DELETE"?(a="DELETE",c+=6):(a=
null,j===0&&g('"DELETE"'));a===null&&(e.substr(c,6)==="delete"?(a="delete",c+=6):(a=null,j===0&&g('"delete"')));a!==null?(b=cb(),b!==null?a=[a,b]:(a=null,c=d)):(a=null,c=d);a!==null&&(a=a[1]);a===null&&(c=r);j--;j===0&&a===null&&g("[40] DeleteClause");return a}function eb(){var a,b,r,d;j++;d=r=c;e.substr(c,6)==="INSERT"?(a="INSERT",c+=6):(a=null,j===0&&g('"INSERT"'));a===null&&(e.substr(c,6)==="insert"?(a="insert",c+=6):(a=null,j===0&&g('"insert"')));a!==null?(b=cb(),b!==null?a=[a,b]:(a=null,c=d)):
(a=null,c=d);a!==null&&(a=a[1]);a===null&&(c=r);j--;j===0&&a===null&&g("[41] InsertClause");return a}function fb(){var a,b,r,d,f,i,h,n,k;j++;n=h=c;a=[];for(b=l();b!==null;)a.push(b),b=l();if(a!==null)if(e.substr(c,5)==="USING"?(b="USING",c+=5):(b=null,j===0&&g('"USING"')),b===null&&(e.substr(c,5)==="using"?(b="using",c+=5):(b=null,j===0&&g('"using"'))),b!==null){r=[];for(d=l();d!==null;)r.push(d),d=l();if(r!==null){d=O();if(d===null)if(k=c,e.substr(c,5)==="NAMED"?(d="NAMED",c+=5):(d=null,j===0&&g('"NAMED"')),
d===null&&(e.substr(c,5)==="named"?(d="named",c+=5):(d=null,j===0&&g('"named"'))),d!==null){f=[];for(i=l();i!==null;)f.push(i),i=l();f!==null?(i=O(),i!==null?d=[d,f,i]:(d=null,c=k)):(d=null,c=k)}else d=null,c=k;d!==null?a=[a,b,r,d]:(a=null,c=n)}else a=null,c=n}else a=null,c=n;else a=null,c=n;a!==null&&(a=a[3].length!=null?{kind:"named",uri:a[3][2]}:{kind:"default",uri:a[3]});a===null&&(c=h);j--;j===0&&a===null&&g("[42] UsingClause");return a}function Ia(){var a,b,d,f,i;j++;i=f=c;e.substr(c,5)==="GRAPH"?
(a="GRAPH",c+=5):(a=null,j===0&&g('"GRAPH"'));a===null&&(e.substr(c,5)==="graph"?(a="graph",c+=5):(a=null,j===0&&g('"graph"')));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();b!==null?(d=O(),d!==null?a=[a,b,d]:(a=null,c=i)):(a=null,c=i)}else a=null,c=i;a!==null&&(a=a[2]);a===null&&(c=f);j--;j===0&&a===null&&g("[43] GraphRef");return a}function gb(){var a,b;j++;b=c;a=Ia();a===null&&(c=b);a===null&&(b=c,e.substr(c,7)==="DEFAULT"?(a="DEFAULT",c+=7):(a=null,j===0&&g('"DEFAULT"')),a===null&&(e.substr(c,
7)==="default"?(a="default",c+=7):(a=null,j===0&&g('"default"'))),a!==null&&(a="default"),a===null&&(c=b),a===null&&(b=c,e.substr(c,5)==="NAMED"?(a="NAMED",c+=5):(a=null,j===0&&g('"NAMED"')),a===null&&(e.substr(c,5)==="named"?(a="named",c+=5):(a=null,j===0&&g('"named"'))),a!==null&&(a="named"),a===null&&(c=b),a===null&&(b=c,e.substr(c,3)==="ALL"?(a="ALL",c+=3):(a=null,j===0&&g('"ALL"')),a===null&&(e.substr(c,3)==="all"?(a="all",c+=3):(a=null,j===0&&g('"all"'))),a!==null&&(a="all"),a===null&&(c=b))));
j--;j===0&&a===null&&g("[44] GraphRefAll");return a}function cb(){var a,b,d,f,i,h,n,k,m,o;j++;o=m=c;a=[];for(b=l();b!==null;)a.push(b),b=l();if(a!==null)if(e.charCodeAt(c)===123?(b="{",c++):(b=null,j===0&&g('"{"')),b!==null){d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(f=hb(),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();if(i!==null)if(e.charCodeAt(c)===125?(h="}",c++):(h=null,j===0&&g('"}"')),h!==null){n=[];for(k=l();k!==null;)n.push(k),k=l();n!==null?a=[a,b,d,f,i,h,n]:(a=null,c=
o)}else a=null,c=o;else a=null,c=o}else a=null,c=o;else a=null,c=o}else a=null,c=o;else a=null,c=o;a!==null&&(a=a[3].quadsContext);a===null&&(c=m);j--;j===0&&a===null&&g("[45] QuadPattern");return a}function db(){var a,b,d,f,i,h,n,k,m,o;j++;o=m=c;a=[];for(b=l();b!==null;)a.push(b),b=l();if(a!==null)if(e.charCodeAt(c)===123?(b="{",c++):(b=null,j===0&&g('"{"')),b!==null){d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(f=hb(),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();if(i!==null)if(e.charCodeAt(c)===
125?(h="}",c++):(h=null,j===0&&g('"}"')),h!==null){n=[];for(k=l();k!==null;)n.push(k),k=l();n!==null?a=[a,b,d,f,i,h,n]:(a=null,c=o)}else a=null,c=o;else a=null,c=o}else a=null,c=o;else a=null,c=o}else a=null,c=o;else a=null,c=o;a!==null&&(a=a[3].quadsContext);a===null&&(c=m);j--;j===0&&a===null&&g("[46] QuadData");return a}function hb(){var a,b,d,f,i,h,l,n;j++;l=h=c;a=pa();a=a!==null?a:"";if(a!==null){b=[];n=c;d=ib();d!==null?(e.charCodeAt(c)===46?(f=".",c++):(f=null,j===0&&g('"."')),f=f!==null?f:
"",f!==null?(i=pa(),i=i!==null?i:"",i!==null?d=[d,f,i]:(d=null,c=n)):(d=null,c=n)):(d=null,c=n);for(;d!==null;)b.push(d),n=c,d=ib(),d!==null?(e.charCodeAt(c)===46?(f=".",c++):(f=null,j===0&&g('"."')),f=f!==null?f:"",f!==null?(i=pa(),i=i!==null?i:"",i!==null?d=[d,f,i]:(d=null,c=n)):(d=null,c=n)):(d=null,c=n);b!==null?a=[a,b]:(a=null,c=l)}else a=null,c=l;a!==null&&(a=function(a,c,b){a=[];if(c.triplesContext!=null&&c.triplesContext!=null)for(var e=0;e<c.triplesContext.length;e++){var x=c.triplesContext[e];
x.graph=null;a.push(x)}if(b&&b.length>0&&b[0].length>0&&(a=a.concat(b[0][0].quadsContext),b[0][2]!=null&&b[0][2].triplesContext!=null))for(e=0;e<b[0][2].triplesContext.length;e++)x=b[0][2].triplesContext[e],x.graph=null,a.push(x);return{token:"quads",quadsContext:a}}(h,a[0],a[1]));a===null&&(c=h);j--;j===0&&a===null&&g("[47] Quads");return a}function ib(){var a,b,d,f,i,h,n,k,m,o,La,q,J,w;j++;w=J=c;a=[];for(b=l();b!==null;)a.push(b),b=l();if(a!==null)if(e.substr(c,5)==="GRAPH"?(b="GRAPH",c+=5):(b=
null,j===0&&g('"GRAPH"')),b===null&&(e.substr(c,5)==="graph"?(b="graph",c+=5):(b=null,j===0&&g('"graph"'))),b!==null){d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(f=ka(),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();if(i!==null)if(e.charCodeAt(c)===123?(h="{",c++):(h=null,j===0&&g('"{"')),h!==null){n=[];for(k=l();k!==null;)n.push(k),k=l();if(n!==null)if(k=pa(),k=k!==null?k:"",k!==null){m=[];for(o=l();o!==null;)m.push(o),o=l();if(m!==null)if(e.charCodeAt(c)===125?(o="}",c++):(o=null,
j===0&&g('"}"')),o!==null){La=[];for(q=l();q!==null;)La.push(q),q=l();La!==null?a=[a,b,d,f,i,h,n,k,m,o,La]:(a=null,c=w)}else a=null,c=w;else a=null,c=w}else a=null,c=w;else a=null,c=w}else a=null,c=w;else a=null,c=w}else a=null,c=w;else a=null,c=w}else a=null,c=w;else a=null,c=w;a!==null&&(a=function(a,c,b){for(var a=[],e=0;e<b.triplesContext.length;e++){var x=b.triplesContext[e];x.graph=c;a.push(x)}return{token:"quadsnottriples",quadsContext:a}}(J,a[3],a[7]));a===null&&(c=J);j--;j===0&&a===null&&
g("[48] QuadsNotTriples");return a}function pa(){var a,b,d,f,i,h,n,k;j++;n=h=c;a=ob();if(a!==null){k=c;b=[];for(d=l();d!==null;)b.push(d),d=l();if(b!==null)if(e.charCodeAt(c)===46?(d=".",c++):(d=null,j===0&&g('"."')),d!==null){f=[];for(i=l();i!==null;)f.push(i),i=l();f!==null?(i=pa(),i=i!==null?i:"",i!==null?b=[b,d,f,i]:(b=null,c=k)):(b=null,c=k)}else b=null,c=k;else b=null,c=k;b=b!==null?b:"";b!==null?a=[a,b]:(a=null,c=n)}else a=null,c=n;a!==null&&(a=function(a,c,b){a=c.triplesContext;typeof b===
"object"&&b.length!=null&&b[3].triplesContext!=null&&(a=a.concat(b[3].triplesContext));return{token:"triplestemplate",triplesContext:a}}(h,a[0],a[1]));a===null&&(c=h);j--;j===0&&a===null&&g("[49] TriplesTemplate");return a}function S(){var a,b,d,f,i,h,n;j++;n=h=c;e.charCodeAt(c)===123?(a="{",c++):(a=null,j===0&&g('"{"'));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();if(b!==null)if(d=m(),d!==null){f=[];for(i=l();i!==null;)f.push(i),i=l();f!==null?(e.charCodeAt(c)===125?(i="}",c++):(i=null,
j===0&&g('"}"')),i!==null?a=[a,b,d,f,i]:(a=null,c=n)):(a=null,c=n)}else a=null,c=n;else a=null,c=n}else a=null,c=n;a!==null&&(a=a[2]);a===null&&(c=h);if(a===null){n=h=c;e.charCodeAt(c)===123?(a="{",c++):(a=null,j===0&&g('"{"'));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();if(b!==null)if(d=ya(),d!==null){f=[];for(i=l();i!==null;)f.push(i),i=l();f!==null?(e.charCodeAt(c)===125?(i="}",c++):(i=null,j===0&&g('"}"')),i!==null?a=[a,b,d,f,i]:(a=null,c=n)):(a=null,c=n)}else a=null,c=n;else a=null,
c=n}else a=null,c=n;a!==null&&(a=a[2]);a===null&&(c=h)}j--;j===0&&a===null&&g("[50] GroupGraphPattern");return a}function ya(){var a,b,d,f,i,h,n,k,m,o,q;j++;o=m=c;a=Ca();a=a!==null?a:"";if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();if(b!==null){d=[];q=c;f=pb();if(f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();if(i!==null)if(e.charCodeAt(c)===46?(h=".",c++):(h=null,j===0&&g('"."')),h=h!==null?h:"",h!==null){n=[];for(k=l();k!==null;)n.push(k),k=l();n!==null?(k=Ca(),k=k!==null?k:"",k!==null?
f=[f,i,h,n,k]:(f=null,c=q)):(f=null,c=q)}else f=null,c=q;else f=null,c=q}else f=null,c=q;for(;f!==null;)if(d.push(f),q=c,f=pb(),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();if(i!==null)if(e.charCodeAt(c)===46?(h=".",c++):(h=null,j===0&&g('"."')),h=h!==null?h:"",h!==null){n=[];for(k=l();k!==null;)n.push(k),k=l();n!==null?(k=Ca(),k=k!==null?k:"",k!==null?f=[f,i,h,n,k]:(f=null,c=q)):(f=null,c=q)}else f=null,c=q;else f=null,c=q}else f=null,c=q;d!==null?a=[a,b,d]:(a=null,c=o)}else a=null,c=o}else a=
null,c=o;a!==null&&(a=function(a,c,b){a=[];c!=null&&c!=[]&&a.push(c);for(c=0;c<b.length;c++)for(var e=0;e<b[c].length;e++)b[c][e].token!=null&&a.push(b[c][e]);for(var b=[],x=[],g=[],c=0;c<a.length;c++)if(a[c].token!="triplespattern"&&a[c].token!="filter"){if(x.length!=0||g.length!=0){for(var d=[],e=0;e<x.length;e++)d=d.concat(x[e].triplesContext);d.length>0&&b.push({token:"basicgraphpattern",triplesContext:d});x=[]}b.push(a[c])}else a[c].token==="triplespattern"?x.push(a[c]):g.push(a[c]);if(x.length!=
0||g.length!=0){d=[];for(e=0;e<x.length;e++)d=d.concat(x[e].triplesContext);d.length>0&&b.push({token:"basicgraphpattern",triplesContext:d})}return{token:"groupgraphpattern",patterns:b,filters:g}}(m,a[0],a[2]));a===null&&(c=m);j--;j===0&&a===null&&g("[51] GroupGraphPatternSub");return a}function Ca(){var a,b,d,f,i,h,n;j++;h=i=c;a=zb();if(a!==null){n=c;b=[];for(d=l();d!==null;)b.push(d),d=l();b!==null?(e.charCodeAt(c)===46?(d=".",c++):(d=null,j===0&&g('"."')),d!==null?(f=Ca(),f=f!==null?f:"",f!==null?
b=[b,d,f]:(b=null,c=n)):(b=null,c=n)):(b=null,c=n);b=b!==null?b:"";b!==null?a=[a,b]:(a=null,c=h)}else a=null,c=h;a!==null&&(a=function(a,c,b){a=c.triplesContext;typeof b==="object"&&b.length!=null&&b[2].triplesContext!=null&&(a=a.concat(b[2].triplesContext));return{token:"triplespattern",triplesContext:a}}(i,a[0],a[1]));a===null&&(c=i);j--;j===0&&a===null&&g("[54] TriplesBlock");return a}function pb(){var a;j++;a=Ab();a===null&&(a=za(),a===null&&(a=Bb(),a===null&&(a=Cb(),a===null&&(a=Db(),a===null&&
(a=Eb())))));j--;j===0&&a===null&&g("[53] GraphPatternNotTriples");return a}function za(){var a,b,d,f,i,h;j++;h=i=c;a=[];for(b=l();b!==null;)a.push(b),b=l();if(a!==null)if(e.substr(c,8)==="OPTIONAL"?(b="OPTIONAL",c+=8):(b=null,j===0&&g('"OPTIONAL"')),b===null&&(e.substr(c,8)==="optional"?(b="optional",c+=8):(b=null,j===0&&g('"optional"'))),b!==null){d=[];for(f=l();f!==null;)d.push(f),f=l();d!==null?(f=S(),f!==null?a=[a,b,d,f]:(a=null,c=h)):(a=null,c=h)}else a=null,c=h;else a=null,c=h;a!==null&&(a=
{token:"optionalgraphpattern",value:a[3]});a===null&&(c=i);j--;j===0&&a===null&&g("[54] OptionalGraphPattern");return a}function Cb(){var a,b,d,f,i,h,n,k;j++;k=n=c;a=[];for(b=l();b!==null;)a.push(b),b=l();if(a!==null)if(e.substr(c,5)==="GRAPH"?(b="GRAPH",c+=5):(b=null,j===0&&g('"GRAPH"')),b===null&&(e.substr(c,5)==="graph"?(b="graph",c+=5):(b=null,j===0&&g('"graph"'))),b!==null){d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(f=ka(),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?
(h=S(),h!==null?a=[a,b,d,f,i,h]:(a=null,c=k)):(a=null,c=k)}else a=null,c=k;else a=null,c=k}else a=null,c=k;else a=null,c=k;a!==null&&(a=function(a,b,c){for(a=0;a<c.patterns.length;a++)for(var e=c.patterns[a],x=0;x<e.triplesContext.length;x++)e.triplesContext[x].graph=b;c.token="groupgraphpattern";return c}(n,a[3],a[5]));a===null&&(c=n);j--;j===0&&a===null&&g("[55] GraphGraphPattern");return a}function Db(){var a,b,d,f,i;j++;i=f=c;e.substr(c,7)==="SERVICE"?(a="SERVICE",c+=7):(a=null,j===0&&g('"SERVICE"'));
a!==null?(b=ka(),b!==null?(d=S(),d!==null?a=[a,b,d]:(a=null,c=i)):(a=null,c=i)):(a=null,c=i);a!==null&&(a={token:"servicegraphpattern",status:"todo",value:[a[1],a[2]]});a===null&&(c=f);j--;j===0&&a===null&&g("[56] ServiceGraphPattern");return a}function Bb(){var a,b,d,f;j++;f=d=c;e.substr(c,5)==="MINUS"?(a="MINUS",c+=5):(a=null,j===0&&g('"MINUS"'));a!==null?(b=S(),b!==null?a=[a,b]:(a=null,c=f)):(a=null,c=f);a!==null&&(a={token:"minusgraphpattern",status:"todo",value:a[1]});a===null&&(c=d);j--;j===
0&&a===null&&g("[57] MinusGraphPattern");return a}function Ab(){var a,b,d,f,i,h,n,k,m;j++;k=n=c;a=S();if(a!==null){b=[];m=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.substr(c,5)==="UNION"?(f="UNION",c+=5):(f=null,j===0&&g('"UNION"')),f===null&&(e.substr(c,5)==="union"?(f="union",c+=5):(f=null,j===0&&g('"union"'))),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?(h=S(),h!==null?d=[d,f,i,h]:(d=null,c=m)):(d=null,c=m)}else d=null,c=m;else d=null,c=m;for(;d!==null;){b.push(d);
m=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.substr(c,5)==="UNION"?(f="UNION",c+=5):(f=null,j===0&&g('"UNION"')),f===null&&(e.substr(c,5)==="union"?(f="union",c+=5):(f=null,j===0&&g('"union"'))),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?(h=S(),h!==null?d=[d,f,i,h]:(d=null,c=m)):(d=null,c=m)}else d=null,c=m;else d=null,c=m}b!==null?a=[a,b]:(a=null,c=k)}else a=null,c=k;a!==null&&(a=function(a,b,c){if(c.length===0)return b;else{a={token:"graphunionpattern",value:[b]};
for(b=0;b<c.length;b++)b==c.length-1?a.value.push(c[b][3]):(a.value.push(c[b][3]),a={token:"graphunionpattern",value:[a]});return a}}(n,a[0],a[1]));a===null&&(c=n);j--;j===0&&a===null&&g("[58] GroupOrUnionGraphPattern");return a}function Eb(){var a,b,d,f,i,h;j++;h=i=c;a=[];for(b=l();b!==null;)a.push(b),b=l();if(a!==null)if(e.substr(c,6)==="FILTER"?(b="FILTER",c+=6):(b=null,j===0&&g('"FILTER"')),b===null&&(e.substr(c,6)==="filter"?(b="filter",c+=6):(b=null,j===0&&g('"filter"'))),b!==null){d=[];for(f=
l();f!==null;)d.push(f),f=l();d!==null?(f=Ba(),f!==null?a=[a,b,d,f]:(a=null,c=h)):(a=null,c=h)}else a=null,c=h;else a=null,c=h;a!==null&&(a={token:"filter",value:a[3]});a===null&&(c=i);j--;j===0&&a===null&&g("[59] Filter");return a}function Ba(){var a;j++;a=Na();a===null&&(a=Ma(),a===null&&(a=nb()));j--;j===0&&a===null&&g("[60] Constraint");return a}function nb(){var a,b,e,d;j++;d=e=c;a=O();a!==null?(b=qb(),b!==null?a=[a,b]:(a=null,c=d)):(a=null,c=d);a!==null&&(a=function(a,b,c){a={token:"expression",
expressionType:"irireforfunction"};a.iriref=b;a.args=c.value;return a}(e,a[0],a[1]));a===null&&(c=e);j--;j===0&&a===null&&g("[61] FunctionCall");return a}function qb(){var a,b,d,f,i,h,l,n,k;j++;l=c;a=la();a!==null&&(a={token:"args",value:[]});a===null&&(c=l);if(a===null){n=l=c;e.charCodeAt(c)===40?(a="(",c++):(a=null,j===0&&g('"("'));if(a!==null)if(e.substr(c,8)==="DISTINCT"?(b="DISTINCT",c+=8):(b=null,j===0&&g('"DISTINCT"')),b===null&&(e.substr(c,8)==="distinct"?(b="distinct",c+=8):(b=null,j===0&&
g('"distinct"'))),b=b!==null?b:"",b!==null)if(d=H(),d!==null){f=[];k=c;e.charCodeAt(c)===44?(i=",",c++):(i=null,j===0&&g('","'));i!==null?(h=H(),h!==null?i=[i,h]:(i=null,c=k)):(i=null,c=k);for(;i!==null;)f.push(i),k=c,e.charCodeAt(c)===44?(i=",",c++):(i=null,j===0&&g('","')),i!==null?(h=H(),h!==null?i=[i,h]:(i=null,c=k)):(i=null,c=k);f!==null?(e.charCodeAt(c)===41?(i=")",c++):(i=null,j===0&&g('")"')),i!==null?a=[a,b,d,f,i]:(a=null,c=n)):(a=null,c=n)}else a=null,c=n;else a=null,c=n;else a=null,c=n;
a!==null&&(a=function(a,b,c,e){for(var a=[],x=0;x<e.length;x++)a.push(e[x][1]);e={token:"args"};e.value=[c].concat(a);e.distinct=b!=null&&b.toUpperCase()==="DISTINCT"?!0:!1;return e}(l,a[1],a[2],a[3]));a===null&&(c=l)}j--;j===0&&a===null&&g("[62] ArgList");return a}function qa(){var a,b,d,f,i,h,n,k,m,o;j++;k=c;a=la();a!==null&&(a={token:"args",value:[]});a===null&&(c=k);if(a===null){m=k=c;e.charCodeAt(c)===40?(a="(",c++):(a=null,j===0&&g('"("'));if(a!==null)if(b=H(),b!==null){d=[];o=c;f=[];for(i=
l();i!==null;)f.push(i),i=l();if(f!==null)if(e.charCodeAt(c)===44?(i=",",c++):(i=null,j===0&&g('","')),i!==null){h=[];for(n=l();n!==null;)h.push(n),n=l();h!==null?(n=H(),n!==null?f=[f,i,h,n]:(f=null,c=o)):(f=null,c=o)}else f=null,c=o;else f=null,c=o;for(;f!==null;){d.push(f);o=c;f=[];for(i=l();i!==null;)f.push(i),i=l();if(f!==null)if(e.charCodeAt(c)===44?(i=",",c++):(i=null,j===0&&g('","')),i!==null){h=[];for(n=l();n!==null;)h.push(n),n=l();h!==null?(n=H(),n!==null?f=[f,i,h,n]:(f=null,c=o)):(f=null,
c=o)}else f=null,c=o;else f=null,c=o}d!==null?(e.charCodeAt(c)===41?(f=")",c++):(f=null,j===0&&g('")"')),f!==null?a=[a,b,d,f]:(a=null,c=m)):(a=null,c=m)}else a=null,c=m;else a=null,c=m;a!==null&&(a=function(a,b,c){for(var a=[],e=0;e<c.length;e++)a.push(c[e][3]);c={token:"args"};c.value=[b].concat(a);return c}(k,a[1],a[2]));a===null&&(c=k)}j--;j===0&&a===null&&g("[63] ExpressionList");return a}function yb(){var a,b,d,f,i,h,n;j++;n=h=c;e.charCodeAt(c)===123?(a="{",c++):(a=null,j===0&&g('"{"'));if(a!==
null){b=[];for(d=l();d!==null;)b.push(d),d=l();if(b!==null)if(d=rb(),d=d!==null?d:"",d!==null){f=[];for(i=l();i!==null;)f.push(i),i=l();f!==null?(e.charCodeAt(c)===125?(i="}",c++):(i=null,j===0&&g('"}"')),i!==null?a=[a,b,d,f,i]:(a=null,c=n)):(a=null,c=n)}else a=null,c=n;else a=null,c=n}else a=null,c=n;a!==null&&(a=a[2]);a===null&&(c=h);j--;j===0&&a===null&&g("[64] ConstructTemplate");return a}function rb(){var a,b,d,f,i,h,n,k;j++;n=h=c;a=ob();if(a!==null){k=c;b=[];for(d=l();d!==null;)b.push(d),d=
l();if(b!==null)if(e.charCodeAt(c)===46?(d=".",c++):(d=null,j===0&&g('"."')),d!==null){f=[];for(i=l();i!==null;)f.push(i),i=l();f!==null?(i=rb(),i=i!==null?i:"",i!==null?b=[b,d,f,i]:(b=null,c=k)):(b=null,c=k)}else b=null,c=k;else b=null,c=k;b=b!==null?b:"";b!==null?a=[a,b]:(a=null,c=n)}else a=null,c=n;a!==null&&(a=function(a,b,c){a=b.triplesContext;typeof c==="object"&&c.length!=null&&c[3].triplesContext!=null&&(a=a.concat(c[3].triplesContext));return{token:"triplestemplate",triplesContext:a}}(h,
a[0],a[1]));a===null&&(c=h);j--;j===0&&a===null&&g("[65] ConstructTriples");return a}function ob(){var a,b,e,d,f,i;j++;i=f=c;a=[];for(b=l();b!==null;)a.push(b),b=l();if(a!==null)if(b=Ra(),b!==null){e=[];for(d=l();d!==null;)e.push(d),d=l();e!==null?(d=Da(),d!==null?a=[a,b,e,d]:(a=null,c=i)):(a=null,c=i)}else a=null,c=i;else a=null,c=i;a!==null&&(a=function(a,b,c){a=c.triplesContext;if(c.pairs)for(var e=0;e<c.pairs.length;e++){var x=c.pairs[e],g=null;x[1].length!=null&&(x[1]=x[1][0]);b.token&&b.token===
"triplesnodecollection"?(g={subject:b.chainSubject[0],predicate:x[0],object:x[1]},a.push(g),a=a.concat(b.triplesContext)):(g={subject:b,predicate:x[0],object:x[1]},a.push(g))}c={token:"triplessamesubject"};c.triplesContext=a;c.chainSubject=b;return c}(f,a[1],a[3]));a===null&&(c=f);if(a===null){i=f=c;a=[];for(b=l();b!==null;)a.push(b),b=l();if(a!==null)if(b=Sa(),b!==null){e=[];for(d=l();d!==null;)e.push(d),d=l();e!==null?(d=Fb(),d!==null?a=[a,b,e,d]:(a=null,c=i)):(a=null,c=i)}else a=null,c=i;else a=
null,c=i;a!==null&&(a=function(a,b,c){var a=b.triplesContext,e=b.chainSubject;if(c.pairs)for(var x=0;x<c.pairs.length;x++){var g=c.pairs[x];g[1].length!=null&&(g[1]=g[1][0]);if(b.token==="triplesnodecollection")for(var d=0;d<e.length;d++){var f=e[d];if(f.triplesContext!=null){var r={subject:f.chainSubject,predicate:g[0],object:g[1]};a.concat(f.triplesContext)}else r={subject:e[d],predicate:g[0],object:g[1]},a.push(r)}else r={subject:e,predicate:g[0],object:g[1]},a.push(r)}b={token:"triplessamesubject"};
b.triplesContext=a;b.chainSubject=e;return b}(f,a[1],a[3]));a===null&&(c=f)}j--;j===0&&a===null&&g("[66] TriplesSameSubject");return a}function Da(){var a,b,d,f,i,h,n,k,m,o,q,t,J,w;j++;t=q=c;a=Ta();if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();if(b!==null)if(d=ma(),d!==null){f=[];J=c;i=[];for(h=l();h!==null;)i.push(h),h=l();if(i!==null)if(e.charCodeAt(c)===59?(h=";",c++):(h=null,j===0&&g('";"')),h!==null){n=[];for(k=l();k!==null;)n.push(k),k=l();if(n!==null){w=c;k=Ta();if(k!==null){m=[];for(o=
l();o!==null;)m.push(o),o=l();m!==null?(o=ma(),o!==null?k=[k,m,o]:(k=null,c=w)):(k=null,c=w)}else k=null,c=w;k=k!==null?k:"";k!==null?i=[i,h,n,k]:(i=null,c=J)}else i=null,c=J}else i=null,c=J;else i=null,c=J;for(;i!==null;){f.push(i);J=c;i=[];for(h=l();h!==null;)i.push(h),h=l();if(i!==null)if(e.charCodeAt(c)===59?(h=";",c++):(h=null,j===0&&g('";"')),h!==null){n=[];for(k=l();k!==null;)n.push(k),k=l();if(n!==null){w=c;k=Ta();if(k!==null){m=[];for(o=l();o!==null;)m.push(o),o=l();m!==null?(o=ma(),o!==
null?k=[k,m,o]:(k=null,c=w)):(k=null,c=w)}else k=null,c=w;k=k!==null?k:"";k!==null?i=[i,h,n,k]:(i=null,c=J)}else i=null,c=J}else i=null,c=J;else i=null,c=J}f!==null?a=[a,b,d,f]:(a=null,c=t)}else a=null,c=t;else a=null,c=t}else a=null,c=t;a!==null&&(a=function(a,b,c,e){for(var a={token:"propertylist"},x=[],g=[],d=0;d<c.length;d++)c[d].triplesContext!=null?(x=x.concat(c[d].triplesContext),c[d].token==="triplesnodecollection"&&c[d].chainSubject.length!=null?g.push([b,c[d].chainSubject[0]]):g.push([b,
c[d].chainSubject])):g.push([b,c[d]]);for(d=0;d<e.length;d++)for(var c=e[d][3],b=c[0],c=c[2]||[],f=0;f<c.length;f++)c[f].triplesContext!=null?(x=x.concat(c[f].triplesContext),g.push([b,c[f].chainSubject])):g.push([b,c[f]]);a.pairs=g;a.triplesContext=x;return a}(q,a[0],a[2],a[3]));a===null&&(c=q);j--;j===0&&a===null&&g("[67] PropertyListNotEmpty");return a}function Fb(){var a;j++;a=Da();a=a!==null?a:"";j--;j===0&&a===null&&g("[68] PropertyList");return a}function ma(){var a,b,d,f,i,h,n,k,m;j++;k=n=
c;a=ra();if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();if(b!==null){d=[];m=c;e.charCodeAt(c)===44?(f=",",c++):(f=null,j===0&&g('","'));if(f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?(h=ra(),h!==null?f=[f,i,h]:(f=null,c=m)):(f=null,c=m)}else f=null,c=m;for(;f!==null;)if(d.push(f),m=c,e.charCodeAt(c)===44?(f=",",c++):(f=null,j===0&&g('","')),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?(h=ra(),h!==null?f=[f,i,h]:(f=null,c=m)):(f=null,c=m)}else f=null,c=m;d!==null?
a=[a,b,d]:(a=null,c=k)}else a=null,c=k}else a=null,c=k;a!==null&&(a=function(a,b,c){a=[];a.push(b);for(b=0;b<c.length;b++)for(var e=0;e<c[b].length;e++)typeof c[b][e]=="object"&&c[b][e].token!=null&&a.push(c[b][e]);return a}(n,a[0],a[2]));a===null&&(c=n);j--;j===0&&a===null&&g("[69] ObjectList");return a}function Ta(){var a,b;j++;a=ka();a===null&&(b=c,e.charCodeAt(c)===97?(a="a",c++):(a=null,j===0&&g('"a"')),a!==null&&(a={token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"}),
a===null&&(c=b));j--;j===0&&a===null&&g("[71] Verb");return a}function zb(){var a,b,e,d,f,i;j++;i=f=c;a=[];for(b=l();b!==null;)a.push(b),b=l();if(a!==null)if(b=Ra(),b!==null){e=[];for(d=l();d!==null;)e.push(d),d=l();e!==null?(d=Gb(),d!==null?a=[a,b,e,d]:(a=null,c=i)):(a=null,c=i)}else a=null,c=i;else a=null,c=i;a!==null&&(a=function(a,b,c){a=c.triplesContext;if(c.pairs)for(var e=0;e<c.pairs.length;e++){var x=c.pairs[e],g=null;x[1].length!=null&&(x[1]=x[1][0]);b.token&&b.token==="triplesnodecollection"?
(g={subject:b.chainSubject[0],predicate:x[0],object:x[1]},a.push(g),a=a.concat(b.triplesContext)):(g={subject:b,predicate:x[0],object:x[1]},a.push(g))}c={token:"triplessamesubject"};c.triplesContext=a;c.chainSubject=b;return c}(f,a[1],a[3]));a===null&&(c=f);if(a===null){i=f=c;a=[];for(b=l();b!==null;)a.push(b),b=l();if(a!==null)if(b=Sa(),b!==null){e=[];for(d=l();d!==null;)e.push(d),d=l();e!==null?(d=Hb(),d!==null?a=[a,b,e,d]:(a=null,c=i)):(a=null,c=i)}else a=null,c=i;else a=null,c=i;a!==null&&(a=
function(a,b,c){var a=b.triplesContext,e=b.chainSubject;if(c.pairs)for(var x=0;x<c.pairs.length;x++){var g=c.pairs[x];g[1].length!=null&&(g[1]=g[1][0]);if(b.token==="triplesnodecollection")for(var d=0;d<e.length;d++){var f=e[d];if(f.triplesContext!=null){var r={subject:f.chainSubject,predicate:g[0],object:g[1]};a.concat(f.triplesContext)}else r={subject:e[d],predicate:g[0],object:g[1]},a.push(r)}else r={subject:e,predicate:g[0],object:g[1]},a.push(r)}b={token:"triplessamesubject"};b.triplesContext=
a;b.chainSubject=e;return b}(f,a[1],a[3]));a===null&&(c=f)}j--;j===0&&a===null&&g("[72] TriplesSameSubjectPath");return a}function Gb(){var a,b,d,f,i,h,n,k,m,o,q,t,J;j++;q=o=c;a=Ua();a===null&&(a=N());if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();if(b!==null)if(d=ma(),d!==null){f=[];t=c;i=[];for(h=l();h!==null;)i.push(h),h=l();if(i!==null)if(e.charCodeAt(c)===59?(h=";",c++):(h=null,j===0&&g('";"')),h!==null){n=[];for(k=l();k!==null;)n.push(k),k=l();n!==null?(J=c,k=Ua(),k===null&&(k=N()),k!==
null?(m=ma(),m!==null?k=[k,m]:(k=null,c=J)):(k=null,c=J),k=k!==null?k:"",k!==null?i=[i,h,n,k]:(i=null,c=t)):(i=null,c=t)}else i=null,c=t;else i=null,c=t;for(;i!==null;){f.push(i);t=c;i=[];for(h=l();h!==null;)i.push(h),h=l();if(i!==null)if(e.charCodeAt(c)===59?(h=";",c++):(h=null,j===0&&g('";"')),h!==null){n=[];for(k=l();k!==null;)n.push(k),k=l();n!==null?(J=c,k=Ua(),k===null&&(k=N()),k!==null?(m=ma(),m!==null?k=[k,m]:(k=null,c=J)):(k=null,c=J),k=k!==null?k:"",k!==null?i=[i,h,n,k]:(i=null,c=t)):(i=
null,c=t)}else i=null,c=t;else i=null,c=t}f!==null?a=[a,b,d,f]:(a=null,c=q)}else a=null,c=q;else a=null,c=q}else a=null,c=q;a!==null&&(a=function(a,b,c,e){token={token:"propertylist"};for(var a=[],x=[],g=0;g<c.length;g++)c[g].triplesContext!=null?(a=a.concat(c[g].triplesContext),c[g].token==="triplesnodecollection"&&c[g].chainSubject.length!=null?x.push([b,c[g].chainSubject[0]]):x.push([b,c[g].chainSubject])):x.push([b,c[g]]);for(g=0;g<e.length;g++)for(var c=e[g][3],b=c[0],c=c[1]||[],d=0;d<c.length;d++)c[d].triplesContext!=
null?(a=a.concat(c[d].triplesContext),x.push([b,c[d].chainSubject])):x.push([b,c[d]]);token.pairs=x;token.triplesContext=a;return token}(o,a[0],a[2],a[3]));a===null&&(c=o);j--;j===0&&a===null&&g("[73] PropertyListNotEmptyPath");return a}function Hb(){var a;j++;a=Da();a=a!==null?a:"";j--;j===0&&a===null&&g("[74] PropertyListPath");return a}function Ua(){var a,b;j++;b=c;a=sb();a===null&&(c=b);j--;j===0&&a===null&&g("[75]");return a}function sb(){var a,b,d,f,i,h,l;j++;h=i=c;a=Va();if(a!==null){b=[];
l=c;e.charCodeAt(c)===124?(d="|",c++):(d=null,j===0&&g('"|"'));d!==null?(f=Va(),f!==null?d=[d,f]:(d=null,c=l)):(d=null,c=l);for(;d!==null;)b.push(d),l=c,e.charCodeAt(c)===124?(d="|",c++):(d=null,j===0&&g('"|"')),d!==null?(f=Va(),f!==null?d=[d,f]:(d=null,c=l)):(d=null,c=l);b!==null?a=[a,b]:(a=null,c=h)}else a=null,c=h;a!==null&&(a=function(a,b,c){if(c==null||c.length===0)return b;else{a=[];for(b=0;b<c.length;b++)a.push(c[1]);c={token:"path",kind:"alternative"};c.value=a;return c}}(i,a[0],a[1]));a===
null&&(c=i);j--;j===0&&a===null&&g("[78] PathAlternative");return a}function Va(){var a,b,d,f,i,h,l;j++;h=i=c;a=Wa();if(a!==null){b=[];l=c;e.charCodeAt(c)===47?(d="/",c++):(d=null,j===0&&g('"/"'));d!==null?(f=Wa(),f!==null?d=[d,f]:(d=null,c=l)):(d=null,c=l);for(;d!==null;)b.push(d),l=c,e.charCodeAt(c)===47?(d="/",c++):(d=null,j===0&&g('"/"')),d!==null?(f=Wa(),f!==null?d=[d,f]:(d=null,c=l)):(d=null,c=l);b!==null?a=[a,b]:(a=null,c=h)}else a=null,c=h;a!==null&&(a=function(a,b,c){if(c==null||c.length===
0)return b;else{a=[b];for(b=0;b<c.length;b++)a.push(c[b][1]);c={token:"path",kind:"sequence"};c.value=a;return c}}(i,a[0],a[1]));a===null&&(c=i);j--;j===0&&a===null&&g("[79] PathSequence");return a}function tb(){var a,b,e,d;j++;d=e=c;a=Ib();a!==null?(b=Jb(),b=b!==null?b:"",b!==null?a=[a,b]:(a=null,c=d)):(a=null,c=d);a!==null&&(a=function(a,b,c){if(b.token&&b.token!="path"&&c=="")return b;else if(b.token&&b.token!=e&&c!=""){var e={token:"path",kind:"element"};e.value=b;e.modifier=c;return e}else return b.modifier=
c,b}(e,a[0],a[1]));a===null&&(c=e);j--;j===0&&a===null&&g("[88] PathElt");return a}function Wa(){var a,b,d,f;j++;a=tb();a===null&&(f=d=c,e.charCodeAt(c)===94?(a="^",c++):(a=null,j===0&&g('"^"')),a!==null?(b=tb(),b!==null?a=[a,b]:(a=null,c=f)):(a=null,c=f),a!==null&&(a=function(a,b){var c={token:"path",kind:"inversePath"};c.value=b;return c}(d,a[1])),a===null&&(c=d));j--;j===0&&a===null&&g("[81] PathEltOrInverse");return a}function Jb(){var a,b,d,f,i,h,l,k,n;j++;e.charCodeAt(c)===42?(a="*",c++):(a=
null,j===0&&g('"*"'));a===null&&(e.charCodeAt(c)===63?(a="?",c++):(a=null,j===0&&g('"?"')),a===null&&(e.charCodeAt(c)===43?(a="+",c++):(a=null,j===0&&g('"+"')),a===null&&(h=c,e.charCodeAt(c)===123?(a="{",c++):(a=null,j===0&&g('"{"')),a!==null?(l=c,b=aa(),b!==null?(k=c,e.charCodeAt(c)===44?(d=",",c++):(d=null,j===0&&g('","')),d!==null?(e.charCodeAt(c)===125?(f="}",c++):(f=null,j===0&&g('"}"')),f===null&&(n=c,f=aa(),f!==null?(e.charCodeAt(c)===125?(i="}",c++):(i=null,j===0&&g('"}"')),i!==null?f=[f,
i]:(f=null,c=n)):(f=null,c=n)),f!==null?d=[d,f]:(d=null,c=k)):(d=null,c=k),d===null&&(e.charCodeAt(c)===125?(d="}",c++):(d=null,j===0&&g('"}"'))),d!==null?b=[b,d]:(b=null,c=l)):(b=null,c=l),b===null&&(l=c,e.charCodeAt(c)===44?(b=",",c++):(b=null,j===0&&g('","')),b!==null?(d=aa(),d!==null?(e.charCodeAt(c)===125?(f="}",c++):(f=null,j===0&&g('"}"')),f!==null?b=[b,d,f]:(b=null,c=l)):(b=null,c=l)):(b=null,c=l)),b!==null?a=[a,b]:(a=null,c=h)):(a=null,c=h))));j--;j===0&&a===null&&g("[82] PathMod");return a}
function Ib(){var a,b,d,f,i;j++;a=O();a===null&&(f=c,e.charCodeAt(c)===97?(a="a",c++):(a=null,j===0&&g('"a"')),a!==null&&(a={token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"}),a===null&&(c=f),a===null&&(f=c,e.charCodeAt(c)===33?(a="!",c++):(a=null,j===0&&g('"!"')),a!==null?(b=Kb(),b!==null?a=[a,b]:(a=null,c=f)):(a=null,c=f),a===null&&(i=f=c,e.charCodeAt(c)===40?(a="(",c++):(a=null,j===0&&g('"("')),a!==null?(b=sb(),b!==null?(e.charCodeAt(c)===41?(d=")",c++):
(d=null,j===0&&g('")"')),d!==null?a=[a,b,d]:(a=null,c=i)):(a=null,c=i)):(a=null,c=i),a!==null&&(a=a[1]),a===null&&(c=f))));j--;j===0&&a===null&&g("[83] PathPrimary");return a}function Kb(){var a,b,d,f,i,h,l,k;a=Ea();if(a===null)if(h=c,e.charCodeAt(c)===40?(a="(",c++):(a=null,j===0&&g('"("')),a!==null){l=c;b=Ea();if(b!==null){d=[];k=c;e.charCodeAt(c)===124?(f="|",c++):(f=null,j===0&&g('"|"'));f!==null?(i=Ea(),i!==null?f=[f,i]:(f=null,c=k)):(f=null,c=k);for(;f!==null;)d.push(f),k=c,e.charCodeAt(c)===
124?(f="|",c++):(f=null,j===0&&g('"|"')),f!==null?(i=Ea(),i!==null?f=[f,i]:(f=null,c=k)):(f=null,c=k);d!==null?b=[b,d]:(b=null,c=l)}else b=null,c=l;b=b!==null?b:"";b!==null?(e.charCodeAt(c)===41?(d=")",c++):(d=null,j===0&&g('")"')),d!==null?a=[a,b,d]:(a=null,c=h)):(a=null,c=h)}else a=null,c=h;return a}function Ea(){var a,b,d;j++;a=O();a===null&&(e.charCodeAt(c)===97?(a="a",c++):(a=null,j===0&&g('"a"')),a===null&&(d=c,e.charCodeAt(c)===94?(a="^",c++):(a=null,j===0&&g('"^"')),a!==null?(b=O(),b===null&&
(e.charCodeAt(c)===97?(b="a",c++):(b=null,j===0&&g('"a"'))),b!==null?a=[a,b]:(a=null,c=d)):(a=null,c=d)));j--;j===0&&a===null&&g("[85] PathOneInPropertySet");return a}function Sa(){var a,b;j++;b=c;a=Lb();a!==null&&(a=function(a,b){for(var c=[],e=[],d=null,g=0;g<b.length;g++)ba++,d=null,b[g].chainSubject==null&&b[g].triplesContext==null?d=b[g]:(d=b[g].chainSubject,c=c.concat(nextSubject.triplesContext)),d={subject:{token:"blank",value:"_:"+ba},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#first"},
object:d},g==0&&e.push(d.subject),c.push(d),d=g===b.length-1?{subject:{token:"blank",value:"_:"+ba},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}}:{subject:{token:"blank",value:"_:"+ba},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"blank",value:"_:"+(ba+1)}},c.push(d);return{token:"triplesnodecollection",
triplesContext:c,chainSubject:e}}(b,a));a===null&&(c=b);a===null&&(a=Mb());j--;j===0&&a===null&&g("[87] TriplesNode");return a}function Mb(){var a,b,d,f,i,h,k,n,m,o;j++;o=m=c;a=[];for(b=l();b!==null;)a.push(b),b=l();if(a!==null)if(e.charCodeAt(c)===91?(b="[",c++):(b=null,j===0&&g('"["')),b!==null){d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(f=Da(),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();if(i!==null)if(e.charCodeAt(c)===93?(h="]",c++):(h=null,j===0&&g('"]"')),h!==null){k=[];
for(n=l();n!==null;)k.push(n),n=l();k!==null?a=[a,b,d,f,i,h,k]:(a=null,c=o)}else a=null,c=o;else a=null,c=o}else a=null,c=o;else a=null,c=o}else a=null,c=o;else a=null,c=o;a!==null&&(a=function(a,b){ba++;for(var c={token:"blank",value:"_:"+ba},e=[],d=0;d<b.pairs.length;d++){var g=b.pairs[d],x={};x.subject=c;x.predicate=g[0];g[1].length!=null&&(g[1]=g[1][0]);x.object=g[1];e.push(x)}return{token:"triplesnode",kind:"blanknodepropertylist",triplesContext:b.triplesContext.concat(e),chainSubject:c}}(m,
a[3]));a===null&&(c=m);j--;j===0&&a===null&&g("[88] BlankNodePropertyList");return a}function Lb(){var a,b,d,f,i,h,k,n,m,o;j++;o=m=c;a=[];for(b=l();b!==null;)a.push(b),b=l();if(a!==null)if(e.charCodeAt(c)===40?(b="(",c++):(b=null,j===0&&g('"("')),b!==null){d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null){i=ra();if(i!==null)for(f=[];i!==null;)f.push(i),i=ra();else f=null;if(f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();if(i!==null)if(e.charCodeAt(c)===41?(h=")",c++):(h=null,j===0&&g('")"')),
h!==null){k=[];for(n=l();n!==null;)k.push(n),n=l();k!==null?a=[a,b,d,f,i,h,k]:(a=null,c=o)}else a=null,c=o;else a=null,c=o}else a=null,c=o}else a=null,c=o}else a=null,c=o;else a=null,c=o;a!==null&&(a=a[3]);a===null&&(c=m);j--;j===0&&a===null&&g("[89] Collection");return a}function ra(){var a,b,e,d,f,i;j++;i=f=c;a=[];for(b=l();b!==null;)a.push(b),b=l();if(a!==null)if(b=Ra(),b!==null){e=[];for(d=l();d!==null;)e.push(d),d=l();e!==null?a=[a,b,e]:(a=null,c=i)}else a=null,c=i;else a=null,c=i;if(a===null){i=
c;a=[];for(b=l();b!==null;)a.push(b),b=l();if(a!==null)if(b=Sa(),b!==null){e=[];for(d=l();d!==null;)e.push(d),d=l();e!==null?a=[a,b,e]:(a=null,c=i)}else a=null,c=i;else a=null,c=i}a!==null&&(a=a[1]);a===null&&(c=f);j--;j===0&&a===null&&g("[90] GraphNode");return a}function Ra(){var a;j++;a=N();a===null&&(a=Nb());j--;j===0&&a===null&&g("[91] VarOrTerm");return a}function ka(){var a;j++;a=N();a===null&&(a=O());j--;j===0&&a===null&&g("[92] VarOrIRIref");return a}function N(){var a,b;j++;b=c;a=Ob();a===
null&&(a=Pb());a!==null&&(a=function(a,b){var c={token:"var"};c.value=b;return c}(b,a));a===null&&(c=b);j--;j===0&&a===null&&g("[93] Var");return a}function Nb(){var a;j++;a=O();a===null&&(a=Oa(),a===null&&(a=Pa(),a===null&&(a=Qa(),a===null&&(a=Qb(),a===null&&(a=la())))));j--;j===0&&a===null&&g("[94] GraphTerm");return a}function H(){var a,b,d,f,i,h,k,n,m;j++;n=k=c;a=Xa();if(a!==null){b=[];m=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.substr(c,2)==="||"?(f="||",c+=2):(f=null,j===0&&
g('"||"')),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?(h=Xa(),h!==null?d=[d,f,i,h]:(d=null,c=m)):(d=null,c=m)}else d=null,c=m;else d=null,c=m;for(;d!==null;){b.push(d);m=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.substr(c,2)==="||"?(f="||",c+=2):(f=null,j===0&&g('"||"')),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?(h=Xa(),h!==null?d=[d,f,i,h]:(d=null,c=m)):(d=null,c=m)}else d=null,c=m;else d=null,c=m}b!==null?a=[a,b]:(a=null,c=n)}else a=null,c=n;a!==
null&&(a=function(a,b,c){if(c.length===0)return b;for(var a={token:"expression",expressionType:"conditionalor"},b=[b],e=0;e<c.length;e++)b.push(c[e][3]);a.operands=b;return a}(k,a[0],a[1]));a===null&&(c=k);j--;j===0&&a===null&&g("[96] ConditionalOrExpression");return a}function Xa(){var a,b,d,f,i,h,k,n,m;j++;n=k=c;a=Ya();if(a!==null){b=[];m=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.substr(c,2)==="&&"?(f="&&",c+=2):(f=null,j===0&&g('"&&"')),f!==null){i=[];for(h=l();h!==null;)i.push(h),
h=l();i!==null?(h=Ya(),h!==null?d=[d,f,i,h]:(d=null,c=m)):(d=null,c=m)}else d=null,c=m;else d=null,c=m;for(;d!==null;){b.push(d);m=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.substr(c,2)==="&&"?(f="&&",c+=2):(f=null,j===0&&g('"&&"')),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?(h=Ya(),h!==null?d=[d,f,i,h]:(d=null,c=m)):(d=null,c=m)}else d=null,c=m;else d=null,c=m}b!==null?a=[a,b]:(a=null,c=n)}else a=null,c=n;a!==null&&(a=function(a,b,c){if(c.length===0)return b;for(var a=
{token:"expression",expressionType:"conditionaland"},b=[b],e=0;e<c.length;e++)b.push(c[e][3]);a.operands=b;return a}(k,a[0],a[1]));a===null&&(c=k);j--;j===0&&a===null&&g("[97] ConditionalAndExpression");return a}function Ya(){var a,b,d,f,i,h,k,n,m,o,q,t,J,w;j++;J=t=c;a=R();if(a!==null){b=[];w=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.charCodeAt(c)===61?(f="=",c++):(f=null,j===0&&g('"="')),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?(h=R(),h!==null?d=[d,f,i,h]:(d=
null,c=w)):(d=null,c=w)}else d=null,c=w;else d=null,c=w;if(d===null){w=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.substr(c,2)==="!="?(f="!=",c+=2):(f=null,j===0&&g('"!="')),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?(h=R(),h!==null?d=[d,f,i,h]:(d=null,c=w)):(d=null,c=w)}else d=null,c=w;else d=null,c=w;if(d===null){w=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.charCodeAt(c)===60?(f="<",c++):(f=null,j===0&&g('"<"')),f!==null){i=[];for(h=l();h!==null;)i.push(h),
h=l();i!==null?(h=R(),h!==null?d=[d,f,i,h]:(d=null,c=w)):(d=null,c=w)}else d=null,c=w;else d=null,c=w;if(d===null){w=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.charCodeAt(c)===62?(f=">",c++):(f=null,j===0&&g('">"')),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?(h=R(),h!==null?d=[d,f,i,h]:(d=null,c=w)):(d=null,c=w)}else d=null,c=w;else d=null,c=w;if(d===null){w=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.substr(c,2)==="<="?(f="<=",c+=2):(f=null,j===0&&
g('"<="')),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?(h=R(),h!==null?d=[d,f,i,h]:(d=null,c=w)):(d=null,c=w)}else d=null,c=w;else d=null,c=w;if(d===null){w=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.substr(c,2)===">="?(f=">=",c+=2):(f=null,j===0&&g('">="')),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?(h=R(),h!==null?d=[d,f,i,h]:(d=null,c=w)):(d=null,c=w)}else d=null,c=w;else d=null,c=w;if(d===null){w=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==
null)if(e.charCodeAt(c)===73?(f="I",c++):(f=null,j===0&&g('"I"')),f===null&&(e.charCodeAt(c)===105?(f="i",c++):(f=null,j===0&&g('"i"'))),f!==null)if(e.charCodeAt(c)===78?(i="N",c++):(i=null,j===0&&g('"N"')),i===null&&(e.charCodeAt(c)===110?(i="n",c++):(i=null,j===0&&g('"n"'))),i!==null){h=[];for(k=l();k!==null;)h.push(k),k=l();h!==null?(k=qa(),k!==null?d=[d,f,i,h,k]:(d=null,c=w)):(d=null,c=w)}else d=null,c=w;else d=null,c=w;else d=null,c=w;if(d===null){w=c;d=[];for(f=l();f!==null;)d.push(f),f=l();
if(d!==null)if(e.charCodeAt(c)===78?(f="N",c++):(f=null,j===0&&g('"N"')),f===null&&(e.charCodeAt(c)===110?(f="n",c++):(f=null,j===0&&g('"n"'))),f!==null)if(e.charCodeAt(c)===79?(i="O",c++):(i=null,j===0&&g('"O"')),i===null&&(e.charCodeAt(c)===111?(i="o",c++):(i=null,j===0&&g('"o"'))),i!==null)if(e.charCodeAt(c)===84?(h="T",c++):(h=null,j===0&&g('"T"')),h===null&&(e.charCodeAt(c)===116?(h="t",c++):(h=null,j===0&&g('"t"'))),h!==null){k=[];for(n=l();n!==null;)k.push(n),n=l();if(k!==null)if(e.charCodeAt(c)===
73?(n="I",c++):(n=null,j===0&&g('"I"')),n===null&&(e.charCodeAt(c)===105?(n="i",c++):(n=null,j===0&&g('"i"'))),n!==null)if(e.charCodeAt(c)===78?(m="N",c++):(m=null,j===0&&g('"N"')),m===null&&(e.charCodeAt(c)===110?(m="n",c++):(m=null,j===0&&g('"n"'))),m!==null){o=[];for(q=l();q!==null;)o.push(q),q=l();o!==null?(q=qa(),q!==null?d=[d,f,i,h,k,n,m,o,q]:(d=null,c=w)):(d=null,c=w)}else d=null,c=w;else d=null,c=w;else d=null,c=w}else d=null,c=w;else d=null,c=w;else d=null,c=w;else d=null,c=w}}}}}}}for(;d!==
null;){b.push(d);w=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.charCodeAt(c)===61?(f="=",c++):(f=null,j===0&&g('"="')),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?(h=R(),h!==null?d=[d,f,i,h]:(d=null,c=w)):(d=null,c=w)}else d=null,c=w;else d=null,c=w;if(d===null){w=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.substr(c,2)==="!="?(f="!=",c+=2):(f=null,j===0&&g('"!="')),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?(h=R(),h!==null?d=[d,f,i,
h]:(d=null,c=w)):(d=null,c=w)}else d=null,c=w;else d=null,c=w;if(d===null){w=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.charCodeAt(c)===60?(f="<",c++):(f=null,j===0&&g('"<"')),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?(h=R(),h!==null?d=[d,f,i,h]:(d=null,c=w)):(d=null,c=w)}else d=null,c=w;else d=null,c=w;if(d===null){w=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.charCodeAt(c)===62?(f=">",c++):(f=null,j===0&&g('">"')),f!==null){i=[];for(h=l();h!==null;)i.push(h),
h=l();i!==null?(h=R(),h!==null?d=[d,f,i,h]:(d=null,c=w)):(d=null,c=w)}else d=null,c=w;else d=null,c=w;if(d===null){w=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.substr(c,2)==="<="?(f="<=",c+=2):(f=null,j===0&&g('"<="')),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?(h=R(),h!==null?d=[d,f,i,h]:(d=null,c=w)):(d=null,c=w)}else d=null,c=w;else d=null,c=w;if(d===null){w=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.substr(c,2)===">="?(f=">=",c+=2):(f=null,j===
0&&g('">="')),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?(h=R(),h!==null?d=[d,f,i,h]:(d=null,c=w)):(d=null,c=w)}else d=null,c=w;else d=null,c=w;if(d===null){w=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.charCodeAt(c)===73?(f="I",c++):(f=null,j===0&&g('"I"')),f===null&&(e.charCodeAt(c)===105?(f="i",c++):(f=null,j===0&&g('"i"'))),f!==null)if(e.charCodeAt(c)===78?(i="N",c++):(i=null,j===0&&g('"N"')),i===null&&(e.charCodeAt(c)===110?(i="n",c++):(i=null,j===0&&g('"n"'))),
i!==null){h=[];for(k=l();k!==null;)h.push(k),k=l();h!==null?(k=qa(),k!==null?d=[d,f,i,h,k]:(d=null,c=w)):(d=null,c=w)}else d=null,c=w;else d=null,c=w;else d=null,c=w;if(d===null){w=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.charCodeAt(c)===78?(f="N",c++):(f=null,j===0&&g('"N"')),f===null&&(e.charCodeAt(c)===110?(f="n",c++):(f=null,j===0&&g('"n"'))),f!==null)if(e.charCodeAt(c)===79?(i="O",c++):(i=null,j===0&&g('"O"')),i===null&&(e.charCodeAt(c)===111?(i="o",c++):(i=null,j===0&&g('"o"'))),
i!==null)if(e.charCodeAt(c)===84?(h="T",c++):(h=null,j===0&&g('"T"')),h===null&&(e.charCodeAt(c)===116?(h="t",c++):(h=null,j===0&&g('"t"'))),h!==null){k=[];for(n=l();n!==null;)k.push(n),n=l();if(k!==null)if(e.charCodeAt(c)===73?(n="I",c++):(n=null,j===0&&g('"I"')),n===null&&(e.charCodeAt(c)===105?(n="i",c++):(n=null,j===0&&g('"i"'))),n!==null)if(e.charCodeAt(c)===78?(m="N",c++):(m=null,j===0&&g('"N"')),m===null&&(e.charCodeAt(c)===110?(m="n",c++):(m=null,j===0&&g('"n"'))),m!==null){o=[];for(q=l();q!==
null;)o.push(q),q=l();o!==null?(q=qa(),q!==null?d=[d,f,i,h,k,n,m,o,q]:(d=null,c=w)):(d=null,c=w)}else d=null,c=w;else d=null,c=w;else d=null,c=w}else d=null,c=w;else d=null,c=w;else d=null,c=w;else d=null,c=w}}}}}}}}b!==null?a=[a,b]:(a=null,c=J)}else a=null,c=J;a!==null&&(a=function(a,b,c){if(c.length===0)return b;else{if(c[0][1]==="i"||c[0][1]==="I"||c[0][1]==="n"||c[0][1]==="N"){a={};if(c[0][1]==="i"||c[0][1]==="I"){var e="=";a.expressionType="conditionalor"}else e="!=",a.expressionType="conditionaland";
for(var d=[],g=0;g<c[0].length;g++)if(c[0][g].token==="args"){d=c[0][g].value;break}a.token="expression";a.operands=[];for(c=0;c<d.length;c++)g={token:"expression",expressionType:"relationalexpression"},g.operator=e,g.op1=b,g.op2=d[c],a.operands.push(g)}else a={expressionType:"relationalexpression"},a.operator=c[0][1],a.op1=b,a.op2=c[0][3],a.token="expression";return a}}(t,a[0],a[1]));a===null&&(c=t);j--;j===0&&a===null&&g("[99] RelationalExpression");return a}function R(){var a,b,d,f,i,h,k,n,m,o,
q;j++;m=n=c;a=sa();if(a!==null){b=[];o=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.charCodeAt(c)===43?(f="+",c++):(f=null,j===0&&g('"+"')),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?(h=sa(),h!==null?d=[d,f,i,h]:(d=null,c=o)):(d=null,c=o)}else d=null,c=o;else d=null,c=o;if(d===null){o=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.charCodeAt(c)===45?(f="-",c++):(f=null,j===0&&g('"-"')),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?(h=sa(),
h!==null?d=[d,f,i,h]:(d=null,c=o)):(d=null,c=o)}else d=null,c=o;else d=null,c=o;if(d===null)if(o=c,d=ta(),d===null&&(d=ta()),d!==null){q=c;f=[];for(i=l();i!==null;)f.push(i),i=l();if(f!==null)if(e.charCodeAt(c)===42?(i="*",c++):(i=null,j===0&&g('"*"')),i!==null){h=[];for(k=l();k!==null;)h.push(k),k=l();h!==null?(k=Z(),k!==null?f=[f,i,h,k]:(f=null,c=q)):(f=null,c=q)}else f=null,c=q;else f=null,c=q;if(f===null){q=c;f=[];for(i=l();i!==null;)f.push(i),i=l();if(f!==null)if(e.charCodeAt(c)===47?(i="/",
c++):(i=null,j===0&&g('"/"')),i!==null){h=[];for(k=l();k!==null;)h.push(k),k=l();h!==null?(k=Z(),k!==null?f=[f,i,h,k]:(f=null,c=q)):(f=null,c=q)}else f=null,c=q;else f=null,c=q}f=f!==null?f:"";f!==null?d=[d,f]:(d=null,c=o)}else d=null,c=o}for(;d!==null;){b.push(d);o=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.charCodeAt(c)===43?(f="+",c++):(f=null,j===0&&g('"+"')),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?(h=sa(),h!==null?d=[d,f,i,h]:(d=null,c=o)):(d=null,c=o)}else d=
null,c=o;else d=null,c=o;if(d===null){o=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.charCodeAt(c)===45?(f="-",c++):(f=null,j===0&&g('"-"')),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?(h=sa(),h!==null?d=[d,f,i,h]:(d=null,c=o)):(d=null,c=o)}else d=null,c=o;else d=null,c=o;if(d===null)if(o=c,d=ta(),d===null&&(d=ta()),d!==null){q=c;f=[];for(i=l();i!==null;)f.push(i),i=l();if(f!==null)if(e.charCodeAt(c)===42?(i="*",c++):(i=null,j===0&&g('"*"')),i!==null){h=[];for(k=l();k!==
null;)h.push(k),k=l();h!==null?(k=Z(),k!==null?f=[f,i,h,k]:(f=null,c=q)):(f=null,c=q)}else f=null,c=q;else f=null,c=q;if(f===null){q=c;f=[];for(i=l();i!==null;)f.push(i),i=l();if(f!==null)if(e.charCodeAt(c)===47?(i="/",c++):(i=null,j===0&&g('"/"')),i!==null){h=[];for(k=l();k!==null;)h.push(k),k=l();h!==null?(k=Z(),k!==null?f=[f,i,h,k]:(f=null,c=q)):(f=null,c=q)}else f=null,c=q;else f=null,c=q}f=f!==null?f:"";f!==null?d=[d,f]:(d=null,c=o)}else d=null,c=o}}b!==null?a=[a,b]:(a=null,c=m)}else a=null,
c=m;a!==null&&(a=function(a,b,c){if(c.length===0)return b;a={token:"expression",expressionType:"additiveexpression"};a.summand=b;a.summands=[];for(b=0;b<c.length;b++){var e=c[b],d={};if(e.length==4&&typeof e[1]==="string")d.operator=e[1],d.expression=e[3];else{var e={},f=d[0],g=d[1][1],x=d[1][3],g=null;f.value<0?(d.operator="-",f.value=-f.value):d.operator="+";e.token="expression";e.expressionType="multiplicativeexpression";e.operator=f;e.factors=[{operator:g,expression:x}];d.expression=e}a.summands.push(d)}return a}(n,
a[0],a[1]));a===null&&(c=n);j--;j===0&&a===null&&g("[101] AdditiveExpression");return a}function sa(){var a,b,d,f,i,h,k,n,m;j++;n=k=c;a=Z();if(a!==null){b=[];m=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.charCodeAt(c)===42?(f="*",c++):(f=null,j===0&&g('"*"')),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?(h=Z(),h!==null?d=[d,f,i,h]:(d=null,c=m)):(d=null,c=m)}else d=null,c=m;else d=null,c=m;if(d===null){m=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.charCodeAt(c)===
47?(f="/",c++):(f=null,j===0&&g('"/"')),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?(h=Z(),h!==null?d=[d,f,i,h]:(d=null,c=m)):(d=null,c=m)}else d=null,c=m;else d=null,c=m}for(;d!==null;){b.push(d);m=c;d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.charCodeAt(c)===42?(f="*",c++):(f=null,j===0&&g('"*"')),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?(h=Z(),h!==null?d=[d,f,i,h]:(d=null,c=m)):(d=null,c=m)}else d=null,c=m;else d=null,c=m;if(d===null){m=c;d=[];for(f=
l();f!==null;)d.push(f),f=l();if(d!==null)if(e.charCodeAt(c)===47?(f="/",c++):(f=null,j===0&&g('"/"')),f!==null){i=[];for(h=l();h!==null;)i.push(h),h=l();i!==null?(h=Z(),h!==null?d=[d,f,i,h]:(d=null,c=m)):(d=null,c=m)}else d=null,c=m;else d=null,c=m}}b!==null?a=[a,b]:(a=null,c=n)}else a=null,c=n;a!==null&&(a=function(a,b,c){if(c.length===0)return b;a={token:"expression",expressionType:"multiplicativeexpression"};a.factor=b;a.factors=[];for(b=0;b<c.length;b++){var e=c[b],d={};d.operator=e[1];d.expression=
e[3];a.factors.push(d)}return a}(k,a[0],a[1]));a===null&&(c=k);j--;j===0&&a===null&&g("[102] MultiplicativeExpression");return a}function Z(){var a,b,d,f,i;j++;i=f=c;e.charCodeAt(c)===33?(a="!",c++):(a=null,j===0&&g('"!"'));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();b!==null?(d=Fa(),d!==null?a=[a,b,d]:(a=null,c=i)):(a=null,c=i)}else a=null,c=i;a!==null&&(a=function(a,b){var c={token:"expression",expressionType:"unaryexpression",unaryexpression:"!"};c.expression=b;return c}(f,a[2]));a===
null&&(c=f);if(a===null){i=f=c;e.charCodeAt(c)===43?(a="+",c++):(a=null,j===0&&g('"+"'));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();b!==null?(d=Fa(),d!==null?a=[a,b,d]:(a=null,c=i)):(a=null,c=i)}else a=null,c=i;a!==null&&(a=function(a,b){var c={token:"expression",expressionType:"unaryexpression",unaryexpression:"+"};c.expression=b;return c}(f,a[2]));a===null&&(c=f);if(a===null){i=f=c;e.charCodeAt(c)===45?(a="-",c++):(a=null,j===0&&g('"-"'));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),
d=l();b!==null?(d=Fa(),d!==null?a=[a,b,d]:(a=null,c=i)):(a=null,c=i)}else a=null,c=i;a!==null&&(a=function(a,b){var c={token:"expression",expressionType:"unaryexpression",unaryexpression:"-"};c.expression=b;return c}(f,a[2]));a===null&&(c=f);a===null&&(a=Fa())}}j--;j===0&&a===null&&g("[103] UnaryExpression");return a}function Fa(){var a,b;j++;a=Na();a===null&&(a=Ma(),a===null&&(a=Rb(),a===null&&(b=c,a=Oa(),a!==null&&(a=function(a,b){var c={token:"expression",expressionType:"atomic",primaryexpression:"rdfliteral"};
c.value=b;return c}(b,a)),a===null&&(c=b),a===null&&(b=c,a=Pa(),a!==null&&(a=function(a,b){var c={token:"expression",expressionType:"atomic",primaryexpression:"numericliteral"};c.value=b;return c}(b,a)),a===null&&(c=b),a===null&&(b=c,a=Qa(),a!==null&&(a=function(a,b){var c={token:"expression",expressionType:"atomic",primaryexpression:"booleanliteral"};c.value=b;return c}(b,a)),a===null&&(c=b),a===null&&(a=Sb(),a===null&&(b=c,a=N(),a!==null&&(a=function(a,b){var c={token:"expression",expressionType:"atomic",
primaryexpression:"var"};c.value=b;return c}(b,a)),a===null&&(c=b))))))));j--;j===0&&a===null&&g("[104] PrimaryExpression");return a}function Na(){var a,b,d,f,i,h,k;j++;k=h=c;e.charCodeAt(c)===40?(a="(",c++):(a=null,j===0&&g('"("'));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();if(b!==null)if(d=H(),d!==null){f=[];for(i=l();i!==null;)f.push(i),i=l();f!==null?(e.charCodeAt(c)===41?(i=")",c++):(i=null,j===0&&g('")"')),i!==null?a=[a,b,d,f,i]:(a=null,c=k)):(a=null,c=k)}else a=null,c=k;else a=null,
c=k}else a=null,c=k;a!==null&&(a=a[2]);a===null&&(c=h);j--;j===0&&a===null&&g("[105] BrackettedExpression");return a}function Ma(){var a,b,d,f,i,h,k,n,m,o,q,t,s,w,y,v,u;j++;u=v=c;e.substr(c,3)==="STR"?(a="STR",c+=3):(a=null,j===0&&g('"STR"'));a===null&&(e.substr(c,3)==="str"?(a="str",c+=3):(a=null,j===0&&g('"str"')));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();if(b!==null)if(e.charCodeAt(c)===40?(d="(",c++):(d=null,j===0&&g('"("')),d!==null){f=[];for(i=l();i!==null;)f.push(i),i=l();if(f!==
null)if(i=H(),i!==null){h=[];for(k=l();k!==null;)h.push(k),k=l();h!==null?(e.charCodeAt(c)===41?(k=")",c++):(k=null,j===0&&g('")"')),k!==null?a=[a,b,d,f,i,h,k]:(a=null,c=u)):(a=null,c=u)}else a=null,c=u;else a=null,c=u}else a=null,c=u;else a=null,c=u}else a=null,c=u;a!==null&&(a=function(a,b){var c={token:"expression",expressionType:"builtincall",builtincall:"str"};c.args=[b];return c}(v,a[4]));a===null&&(c=v);if(a===null){u=v=c;e.substr(c,4)==="LANG"?(a="LANG",c+=4):(a=null,j===0&&g('"LANG"'));a===
null&&(e.substr(c,4)==="lang"?(a="lang",c+=4):(a=null,j===0&&g('"lang"')));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();if(b!==null)if(e.charCodeAt(c)===40?(d="(",c++):(d=null,j===0&&g('"("')),d!==null){f=[];for(i=l();i!==null;)f.push(i),i=l();if(f!==null)if(i=H(),i!==null){h=[];for(k=l();k!==null;)h.push(k),k=l();h!==null?(e.charCodeAt(c)===41?(k=")",c++):(k=null,j===0&&g('")"')),k!==null?a=[a,b,d,f,i,h,k]:(a=null,c=u)):(a=null,c=u)}else a=null,c=u;else a=null,c=u}else a=null,c=u;else a=
null,c=u}else a=null,c=u;a!==null&&(a=function(a,b){var c={token:"expression",expressionType:"builtincall",builtincall:"lang"};c.args=[b];return c}(v,a[4]));a===null&&(c=v);if(a===null){u=v=c;e.substr(c,11)==="LANGMATCHES"?(a="LANGMATCHES",c+=11):(a=null,j===0&&g('"LANGMATCHES"'));a===null&&(e.substr(c,11)==="langmatches"?(a="langmatches",c+=11):(a=null,j===0&&g('"langmatches"')));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();if(b!==null)if(e.charCodeAt(c)===40?(d="(",c++):(d=null,j===0&&
g('"("')),d!==null){f=[];for(i=l();i!==null;)f.push(i),i=l();if(f!==null)if(i=H(),i!==null){h=[];for(k=l();k!==null;)h.push(k),k=l();if(h!==null)if(e.charCodeAt(c)===44?(k=",",c++):(k=null,j===0&&g('","')),k!==null){n=[];for(m=l();m!==null;)n.push(m),m=l();if(n!==null)if(m=H(),m!==null){o=[];for(q=l();q!==null;)o.push(q),q=l();o!==null?(e.charCodeAt(c)===41?(q=")",c++):(q=null,j===0&&g('")"')),q!==null?a=[a,b,d,f,i,h,k,n,m,o,q]:(a=null,c=u)):(a=null,c=u)}else a=null,c=u;else a=null,c=u}else a=null,
c=u;else a=null,c=u}else a=null,c=u;else a=null,c=u}else a=null,c=u;else a=null,c=u}else a=null,c=u;a!==null&&(a=function(a,b,c){a={token:"expression",expressionType:"builtincall",builtincall:"langmatches"};a.args=[b,c];return a}(v,a[4],a[8]));a===null&&(c=v);if(a===null){u=v=c;e.substr(c,8)==="DATATYPE"?(a="DATATYPE",c+=8):(a=null,j===0&&g('"DATATYPE"'));a===null&&(e.substr(c,8)==="datatype"?(a="datatype",c+=8):(a=null,j===0&&g('"datatype"')));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();
if(b!==null)if(e.charCodeAt(c)===40?(d="(",c++):(d=null,j===0&&g('"("')),d!==null){f=[];for(i=l();i!==null;)f.push(i),i=l();if(f!==null)if(i=H(),i!==null){h=[];for(k=l();k!==null;)h.push(k),k=l();h!==null?(e.charCodeAt(c)===41?(k=")",c++):(k=null,j===0&&g('")"')),k!==null?a=[a,b,d,f,i,h,k]:(a=null,c=u)):(a=null,c=u)}else a=null,c=u;else a=null,c=u}else a=null,c=u;else a=null,c=u}else a=null,c=u;a!==null&&(a=function(a,b){var c={token:"expression",expressionType:"builtincall",builtincall:"datatype"};
c.args=[b];return c}(v,a[4]));a===null&&(c=v);if(a===null){u=v=c;e.substr(c,5)==="BOUND"?(a="BOUND",c+=5):(a=null,j===0&&g('"BOUND"'));a===null&&(e.substr(c,5)==="bound"?(a="bound",c+=5):(a=null,j===0&&g('"bound"')));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();if(b!==null)if(e.charCodeAt(c)===40?(d="(",c++):(d=null,j===0&&g('"("')),d!==null){f=[];for(i=l();i!==null;)f.push(i),i=l();if(f!==null)if(i=N(),i!==null){h=[];for(k=l();k!==null;)h.push(k),k=l();h!==null?(e.charCodeAt(c)===41?(k=
")",c++):(k=null,j===0&&g('")"')),k!==null?a=[a,b,d,f,i,h,k]:(a=null,c=u)):(a=null,c=u)}else a=null,c=u;else a=null,c=u}else a=null,c=u;else a=null,c=u}else a=null,c=u;a!==null&&(a=function(a,b){var c={token:"expression",expressionType:"builtincall",builtincall:"bound"};c.args=[b];return c}(v,a[4]));a===null&&(c=v);if(a===null){u=v=c;e.substr(c,3)==="IRI"?(a="IRI",c+=3):(a=null,j===0&&g('"IRI"'));a===null&&(e.substr(c,3)==="iri"?(a="iri",c+=3):(a=null,j===0&&g('"iri"')));if(a!==null){b=[];for(d=l();d!==
null;)b.push(d),d=l();if(b!==null)if(e.charCodeAt(c)===40?(d="(",c++):(d=null,j===0&&g('"("')),d!==null){f=[];for(i=l();i!==null;)f.push(i),i=l();if(f!==null)if(i=H(),i!==null){h=[];for(k=l();k!==null;)h.push(k),k=l();h!==null?(e.charCodeAt(c)===41?(k=")",c++):(k=null,j===0&&g('")"')),k!==null?a=[a,b,d,f,i,h,k]:(a=null,c=u)):(a=null,c=u)}else a=null,c=u;else a=null,c=u}else a=null,c=u;else a=null,c=u}else a=null,c=u;a!==null&&(a=function(a,b){var c={token:"expression",expressionType:"builtincall",
builtincall:"iri"};c.args=[b];return c}(v,a[4]));a===null&&(c=v);if(a===null){u=v=c;e.substr(c,3)==="URI"?(a="URI",c+=3):(a=null,j===0&&g('"URI"'));a===null&&(e.substr(c,3)==="uri"?(a="uri",c+=3):(a=null,j===0&&g('"uri"')));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();if(b!==null)if(e.charCodeAt(c)===40?(d="(",c++):(d=null,j===0&&g('"("')),d!==null){f=[];for(i=l();i!==null;)f.push(i),i=l();if(f!==null)if(i=H(),i!==null){h=[];for(k=l();k!==null;)h.push(k),k=l();h!==null?(e.charCodeAt(c)===
41?(k=")",c++):(k=null,j===0&&g('")"')),k!==null?a=[a,b,d,f,i,h,k]:(a=null,c=u)):(a=null,c=u)}else a=null,c=u;else a=null,c=u}else a=null,c=u;else a=null,c=u}else a=null,c=u;a!==null&&(a=function(a,b){var c={token:"expression",expressionType:"builtincall",builtincall:"uri"};c.args=[b];return c}(v,a[4]));a===null&&(c=v);if(a===null){u=v=c;e.substr(c,5)==="BNODE"?(a="BNODE",c+=5):(a=null,j===0&&g('"BNODE"'));a===null&&(e.substr(c,5)==="bnode"?(a="bnode",c+=5):(a=null,j===0&&g('"bnode"')));if(a!==null){b=
[];for(d=l();d!==null;)b.push(d),d=l();if(b!==null){m=c;e.charCodeAt(c)===40?(d="(",c++):(d=null,j===0&&g('"("'));if(d!==null){f=[];for(i=l();i!==null;)f.push(i),i=l();if(f!==null)if(i=H(),i!==null){h=[];for(k=l();k!==null;)h.push(k),k=l();h!==null?(e.charCodeAt(c)===41?(k=")",c++):(k=null,j===0&&g('")"')),k!==null?d=[d,f,i,h,k]:(d=null,c=m)):(d=null,c=m)}else d=null,c=m;else d=null,c=m}else d=null,c=m;d===null&&(d=la());d!==null?a=[a,b,d]:(a=null,c=u)}else a=null,c=u}else a=null,c=u;a!==null&&(a=
function(a,b){var c={token:"expression",expressionType:"builtincall",builtincall:"bnode"};c.args=b.length===5?[b[2]]:null;return c}(v,a[2]));a===null&&(c=v);if(a===null){u=v=c;e.substr(c,8)==="COALESCE"?(a="COALESCE",c+=8):(a=null,j===0&&g('"COALESCE"'));a===null&&(e.substr(c,8)==="coalesce"?(a="coalesce",c+=8):(a=null,j===0&&g('"coalesce"')));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();b!==null?(d=qa(),d!==null?a=[a,b,d]:(a=null,c=u)):(a=null,c=u)}else a=null,c=u;a!==null&&(a=function(a,
b){var c={token:"expression",expressionType:"builtincall",builtincall:"coalesce"};c.args=b;return c}(v,a[2]));a===null&&(c=v);if(a===null){u=v=c;e.substr(c,2)==="IF"?(a="IF",c+=2):(a=null,j===0&&g('"IF"'));a===null&&(e.substr(c,2)==="if"?(a="if",c+=2):(a=null,j===0&&g('"if"')));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();if(b!==null)if(e.charCodeAt(c)===40?(d="(",c++):(d=null,j===0&&g('"("')),d!==null){f=[];for(i=l();i!==null;)f.push(i),i=l();if(f!==null)if(i=H(),i!==null){h=[];for(k=l();k!==
null;)h.push(k),k=l();if(h!==null)if(e.charCodeAt(c)===44?(k=",",c++):(k=null,j===0&&g('","')),k!==null){n=[];for(m=l();m!==null;)n.push(m),m=l();if(n!==null)if(m=H(),m!==null){o=[];for(q=l();q!==null;)o.push(q),q=l();if(o!==null)if(e.charCodeAt(c)===44?(q=",",c++):(q=null,j===0&&g('","')),q!==null){t=[];for(s=l();s!==null;)t.push(s),s=l();if(t!==null)if(s=H(),s!==null){w=[];for(y=l();y!==null;)w.push(y),y=l();w!==null?(e.charCodeAt(c)===41?(y=")",c++):(y=null,j===0&&g('")"')),y!==null?a=[a,b,d,f,
i,h,k,n,m,o,q,t,s,w,y]:(a=null,c=u)):(a=null,c=u)}else a=null,c=u;else a=null,c=u}else a=null,c=u;else a=null,c=u}else a=null,c=u;else a=null,c=u}else a=null,c=u;else a=null,c=u}else a=null,c=u;else a=null,c=u}else a=null,c=u;else a=null,c=u}else a=null,c=u;a!==null&&(a=function(a,b,c,e){a={token:"expression",expressionType:"builtincall",builtincall:"if"};a.args=[b,c,e];return a}(v,a[4],a[8],a[12]));a===null&&(c=v);if(a===null){u=v=c;e.substr(c,9)==="ISLITERAL"?(a="ISLITERAL",c+=9):(a=null,j===0&&
g('"ISLITERAL"'));a===null&&(e.substr(c,9)==="isliteral"?(a="isliteral",c+=9):(a=null,j===0&&g('"isliteral"')));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();if(b!==null)if(e.charCodeAt(c)===40?(d="(",c++):(d=null,j===0&&g('"("')),d!==null){f=[];for(i=l();i!==null;)f.push(i),i=l();if(f!==null)if(i=H(),i!==null){h=[];for(k=l();k!==null;)h.push(k),k=l();h!==null?(e.charCodeAt(c)===41?(k=")",c++):(k=null,j===0&&g('")"')),k!==null?a=[a,b,d,f,i,h,k]:(a=null,c=u)):(a=null,c=u)}else a=null,c=u;else a=
null,c=u}else a=null,c=u;else a=null,c=u}else a=null,c=u;a!==null&&(a=function(a,b){var c={token:"expression",expressionType:"builtincall",builtincall:"isliteral"};c.args=[b];return c}(v,a[4]));a===null&&(c=v);if(a===null){u=v=c;e.substr(c,7)==="ISBLANK"?(a="ISBLANK",c+=7):(a=null,j===0&&g('"ISBLANK"'));a===null&&(e.substr(c,7)==="isblank"?(a="isblank",c+=7):(a=null,j===0&&g('"isblank"')));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();if(b!==null)if(e.charCodeAt(c)===40?(d="(",c++):(d=null,
j===0&&g('"("')),d!==null){f=[];for(i=l();i!==null;)f.push(i),i=l();if(f!==null)if(i=H(),i!==null){h=[];for(k=l();k!==null;)h.push(k),k=l();h!==null?(e.charCodeAt(c)===41?(k=")",c++):(k=null,j===0&&g('")"')),k!==null?a=[a,b,d,f,i,h,k]:(a=null,c=u)):(a=null,c=u)}else a=null,c=u;else a=null,c=u}else a=null,c=u;else a=null,c=u}else a=null,c=u;a!==null&&(a=function(a,b){var c={token:"expression",expressionType:"builtincall",builtincall:"isblank"};c.args=[b];return c}(v,a[4]));a===null&&(c=v);if(a===null){u=
v=c;e.substr(c,8)==="SAMETERM"?(a="SAMETERM",c+=8):(a=null,j===0&&g('"SAMETERM"'));a===null&&(e.substr(c,8)==="sameterm"?(a="sameterm",c+=8):(a=null,j===0&&g('"sameterm"')));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();if(b!==null)if(e.charCodeAt(c)===40?(d="(",c++):(d=null,j===0&&g('"("')),d!==null){f=[];for(i=l();i!==null;)f.push(i),i=l();if(f!==null)if(i=H(),i!==null){h=[];for(k=l();k!==null;)h.push(k),k=l();if(h!==null)if(e.charCodeAt(c)===44?(k=",",c++):(k=null,j===0&&g('","')),k!==
null){n=[];for(m=l();m!==null;)n.push(m),m=l();if(n!==null)if(m=H(),m!==null){o=[];for(q=l();q!==null;)o.push(q),q=l();o!==null?(e.charCodeAt(c)===41?(q=")",c++):(q=null,j===0&&g('")"')),q!==null?a=[a,b,d,f,i,h,k,n,m,o,q]:(a=null,c=u)):(a=null,c=u)}else a=null,c=u;else a=null,c=u}else a=null,c=u;else a=null,c=u}else a=null,c=u;else a=null,c=u}else a=null,c=u;else a=null,c=u}else a=null,c=u;a!==null&&(a=function(a,b,c){a={token:"expression",expressionType:"builtincall",builtincall:"sameterm"};a.args=
[b,c];return a}(v,a[4],a[8]));a===null&&(c=v);if(a===null){u=v=c;e.substr(c,5)==="ISURI"?(a="ISURI",c+=5):(a=null,j===0&&g('"ISURI"'));a===null&&(e.substr(c,5)==="isuri"?(a="isuri",c+=5):(a=null,j===0&&g('"isuri"')),a===null&&(e.substr(c,5)==="ISIRI"?(a="ISIRI",c+=5):(a=null,j===0&&g('"ISIRI"')),a===null&&(e.substr(c,5)==="isiri"?(a="isiri",c+=5):(a=null,j===0&&g('"isiri"')))));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();if(b!==null)if(e.charCodeAt(c)===40?(d="(",c++):(d=null,j===0&&g('"("')),
d!==null){f=[];for(i=l();i!==null;)f.push(i),i=l();if(f!==null)if(i=H(),i!==null){h=[];for(k=l();k!==null;)h.push(k),k=l();h!==null?(e.charCodeAt(c)===41?(k=")",c++):(k=null,j===0&&g('")"')),k!==null?a=[a,b,d,f,i,h,k]:(a=null,c=u)):(a=null,c=u)}else a=null,c=u;else a=null,c=u}else a=null,c=u;else a=null,c=u}else a=null,c=u;a!==null&&(a=function(a,b){var c={token:"expression",expressionType:"builtincall",builtincall:"isuri"};c.args=[b];return c}(v,a[4]));a===null&&(c=v);if(a===null){u=v=c;e.substr(c,
7)==="custom:"?(a="custom:",c+=7):(a=null,j===0&&g('"custom:"'));a===null&&(e.substr(c,7)==="CUSTOM:"?(a="CUSTOM:",c+=7):(a=null,j===0&&g('"CUSTOM:"')));if(a!==null){/^[a-zA-Z0-9_]/.test(e.charAt(c))?(d=e.charAt(c),c++):(d=null,j===0&&g("[a-zA-Z0-9_]"));if(d!==null)for(b=[];d!==null;)b.push(d),/^[a-zA-Z0-9_]/.test(e.charAt(c))?(d=e.charAt(c),c++):(d=null,j===0&&g("[a-zA-Z0-9_]"));else b=null;if(b!==null){d=[];for(f=l();f!==null;)d.push(f),f=l();if(d!==null)if(e.charCodeAt(c)===40?(f="(",c++):(f=null,
j===0&&g('"("')),f!==null){i=[];m=c;h=[];for(k=l();k!==null;)h.push(k),k=l();h!==null?(k=H(),k!==null?(e.charCodeAt(c)===44?(n=",",c++):(n=null,j===0&&g('","')),n!==null?h=[h,k,n]:(h=null,c=m)):(h=null,c=m)):(h=null,c=m);for(;h!==null;){i.push(h);m=c;h=[];for(k=l();k!==null;)h.push(k),k=l();h!==null?(k=H(),k!==null?(e.charCodeAt(c)===44?(n=",",c++):(n=null,j===0&&g('","')),n!==null?h=[h,k,n]:(h=null,c=m)):(h=null,c=m)):(h=null,c=m)}if(i!==null){h=[];for(k=l();k!==null;)h.push(k),k=l();if(h!==null)if(k=
H(),k!==null){n=[];for(m=l();m!==null;)n.push(m),m=l();n!==null?(e.charCodeAt(c)===41?(m=")",c++):(m=null,j===0&&g('")"')),m!==null?a=[a,b,d,f,i,h,k,n,m]:(a=null,c=u)):(a=null,c=u)}else a=null,c=u;else a=null,c=u}else a=null,c=u}else a=null,c=u;else a=null,c=u}else a=null,c=u}else a=null,c=u;a!==null&&(a=function(a,b,c,e){a={token:"expression",expressionType:"custom"};a.name=b.join("");for(var b=[],d=0;d<c.length;d++)b.push(c[d][1]);b.push(e);a.args=b;return a}(v,a[1],a[4],a[6]));a===null&&(c=v);
a===null&&(a=Tb(),a===null&&(a=Ub(),a===null&&(a=Vb())))}}}}}}}}}}}}}}j--;j===0&&a===null&&g("[106] BuiltInCall");return a}function Tb(){var a,b,d,f,i,h,k,n,m,o,q,t,v,w,s,y;j++;s=w=c;e.substr(c,5)==="REGEX"?(a="REGEX",c+=5):(a=null,j===0&&g('"REGEX"'));a===null&&(e.substr(c,5)==="regex"?(a="regex",c+=5):(a=null,j===0&&g('"regex"')));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();if(b!==null)if(e.charCodeAt(c)===40?(d="(",c++):(d=null,j===0&&g('"("')),d!==null){f=[];for(i=l();i!==null;)f.push(i),
i=l();if(f!==null)if(i=H(),i!==null){h=[];for(k=l();k!==null;)h.push(k),k=l();if(h!==null)if(e.charCodeAt(c)===44?(k=",",c++):(k=null,j===0&&g('","')),k!==null){n=[];for(m=l();m!==null;)n.push(m),m=l();if(n!==null)if(m=H(),m!==null){o=[];for(q=l();q!==null;)o.push(q),q=l();if(o!==null){y=c;e.charCodeAt(c)===44?(q=",",c++):(q=null,j===0&&g('","'));if(q!==null){t=[];for(v=l();v!==null;)t.push(v),v=l();t!==null?(v=H(),v!==null?q=[q,t,v]:(q=null,c=y)):(q=null,c=y)}else q=null,c=y;q=q!==null?q:"";if(q!==
null){t=[];for(v=l();v!==null;)t.push(v),v=l();t!==null?(e.charCodeAt(c)===41?(v=")",c++):(v=null,j===0&&g('")"')),v!==null?a=[a,b,d,f,i,h,k,n,m,o,q,t,v]:(a=null,c=s)):(a=null,c=s)}else a=null,c=s}else a=null,c=s}else a=null,c=s;else a=null,c=s}else a=null,c=s;else a=null,c=s}else a=null,c=s;else a=null,c=s}else a=null,c=s;else a=null,c=s}else a=null,c=s;a!==null&&(a=function(a,b,c,e){a={token:"expression",expressionType:"regex"};a.text=b;a.pattern=c;a.flags=e[2];return a}(w,a[4],a[8],a[10]));a===
null&&(c=w);j--;j===0&&a===null&&g("[107] RegexExpression");return a}function Ub(){var a,b,d,f,i;j++;i=f=c;e.substr(c,6)==="EXISTS"?(a="EXISTS",c+=6):(a=null,j===0&&g('"EXISTS"'));a===null&&(e.substr(c,6)==="exists"?(a="exists",c+=6):(a=null,j===0&&g('"exists"')));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();b!==null?(d=S(),d!==null?a=[a,b,d]:(a=null,c=i)):(a=null,c=i)}else a=null,c=i;a!==null&&(a=function(a,b){var c={token:"expression",expressionType:"builtincall",builtincall:"exists"};
c.args=[b];return c}(f,a[2]));a===null&&(c=f);j--;j===0&&a===null&&g("[108] ExistsFunc");return a}function Vb(){var a,b,d,f,i,h,k;j++;k=h=c;e.substr(c,3)==="NOT"?(a="NOT",c+=3):(a=null,j===0&&g('"NOT"'));a===null&&(e.substr(c,3)==="not"?(a="not",c+=3):(a=null,j===0&&g('"not"')));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();if(b!==null)if(e.substr(c,6)==="EXISTS"?(d="EXISTS",c+=6):(d=null,j===0&&g('"EXISTS"')),d===null&&(e.substr(c,6)==="exists"?(d="exists",c+=6):(d=null,j===0&&g('"exists"'))),
d!==null){f=[];for(i=l();i!==null;)f.push(i),i=l();f!==null?(i=S(),i!==null?a=[a,b,d,f,i]:(a=null,c=k)):(a=null,c=k)}else a=null,c=k;else a=null,c=k}else a=null,c=k;a!==null&&(a=function(a,b){var c={token:"expression",expressionType:"builtincall",builtincall:"notexists"};c.args=[b];return c}(h,a[4]));a===null&&(c=h);j--;j===0&&a===null&&g("[109] NotExistsFunc");return a}function Sb(){var a,b,d,f,i,h,k,n,m,o,q,t,v;j++;v=t=c;e.substr(c,5)==="COUNT"?(a="COUNT",c+=5):(a=null,j===0&&g('"COUNT"'));a===
null&&(e.substr(c,5)==="count"?(a="count",c+=5):(a=null,j===0&&g('"count"')));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();if(b!==null)if(e.charCodeAt(c)===40?(d="(",c++):(d=null,j===0&&g('"("')),d!==null){f=[];for(i=l();i!==null;)f.push(i),i=l();if(f!==null)if(e.substr(c,8)==="DISTINCT"?(i="DISTINCT",c+=8):(i=null,j===0&&g('"DISTINCT"')),i===null&&(e.substr(c,8)==="distinct"?(i="distinct",c+=8):(i=null,j===0&&g('"distinct"'))),i=i!==null?i:"",i!==null){h=[];for(k=l();k!==null;)h.push(k),
k=l();if(h!==null)if(e.charCodeAt(c)===42?(k="*",c++):(k=null,j===0&&g('"*"')),k===null&&(k=H()),k!==null){n=[];for(m=l();m!==null;)n.push(m),m=l();if(n!==null)if(e.charCodeAt(c)===41?(m=")",c++):(m=null,j===0&&g('")"')),m!==null){o=[];for(q=l();q!==null;)o.push(q),q=l();o!==null?a=[a,b,d,f,i,h,k,n,m,o]:(a=null,c=v)}else a=null,c=v;else a=null,c=v}else a=null,c=v;else a=null,c=v}else a=null,c=v;else a=null,c=v}else a=null,c=v;else a=null,c=v}else a=null,c=v;a!==null&&(a=function(a,b,c){a={token:"expression",
expressionType:"aggregate",aggregateType:"count"};a.distinct=b!=""?"DISTINCT":b;a.expression=c;return a}(t,a[4],a[6]));a===null&&(c=t);if(a===null){v=t=c;e.substr(c,3)==="SUM"?(a="SUM",c+=3):(a=null,j===0&&g('"SUM"'));a===null&&(e.substr(c,3)==="sum"?(a="sum",c+=3):(a=null,j===0&&g('"sum"')));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();if(b!==null)if(e.charCodeAt(c)===40?(d="(",c++):(d=null,j===0&&g('"("')),d!==null){f=[];for(i=l();i!==null;)f.push(i),i=l();if(f!==null)if(e.substr(c,8)===
"DISTINCT"?(i="DISTINCT",c+=8):(i=null,j===0&&g('"DISTINCT"')),i===null&&(e.substr(c,8)==="distinct"?(i="distinct",c+=8):(i=null,j===0&&g('"distinct"'))),i=i!==null?i:"",i!==null){h=[];for(k=l();k!==null;)h.push(k),k=l();if(h!==null)if(k=H(),k!==null){n=[];for(m=l();m!==null;)n.push(m),m=l();if(n!==null)if(e.charCodeAt(c)===41?(m=")",c++):(m=null,j===0&&g('")"')),m!==null){o=[];for(q=l();q!==null;)o.push(q),q=l();o!==null?a=[a,b,d,f,i,h,k,n,m,o]:(a=null,c=v)}else a=null,c=v;else a=null,c=v}else a=
null,c=v;else a=null,c=v}else a=null,c=v;else a=null,c=v}else a=null,c=v;else a=null,c=v}else a=null,c=v;a!==null&&(a=function(a,b,c){a={token:"expression",expressionType:"aggregate",aggregateType:"sum"};a.distinct=b!=""?"DISTINCT":b;a.expression=c;return a}(t,a[4],a[6]));a===null&&(c=t);if(a===null){v=t=c;e.substr(c,3)==="MIN"?(a="MIN",c+=3):(a=null,j===0&&g('"MIN"'));a===null&&(e.substr(c,3)==="min"?(a="min",c+=3):(a=null,j===0&&g('"min"')));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();
if(b!==null)if(e.charCodeAt(c)===40?(d="(",c++):(d=null,j===0&&g('"("')),d!==null){f=[];for(i=l();i!==null;)f.push(i),i=l();if(f!==null)if(e.substr(c,8)==="DISTINCT"?(i="DISTINCT",c+=8):(i=null,j===0&&g('"DISTINCT"')),i===null&&(e.substr(c,8)==="distinct"?(i="distinct",c+=8):(i=null,j===0&&g('"distinct"'))),i=i!==null?i:"",i!==null){h=[];for(k=l();k!==null;)h.push(k),k=l();if(h!==null)if(k=H(),k!==null){n=[];for(m=l();m!==null;)n.push(m),m=l();if(n!==null)if(e.charCodeAt(c)===41?(m=")",c++):(m=null,
j===0&&g('")"')),m!==null){o=[];for(q=l();q!==null;)o.push(q),q=l();o!==null?a=[a,b,d,f,i,h,k,n,m,o]:(a=null,c=v)}else a=null,c=v;else a=null,c=v}else a=null,c=v;else a=null,c=v}else a=null,c=v;else a=null,c=v}else a=null,c=v;else a=null,c=v}else a=null,c=v;a!==null&&(a=function(a,b,c){a={token:"expression",expressionType:"aggregate",aggregateType:"min"};a.distinct=b!=""?"DISTINCT":b;a.expression=c;return a}(t,a[4],a[6]));a===null&&(c=t);if(a===null){v=t=c;e.substr(c,3)==="MAX"?(a="MAX",c+=3):(a=
null,j===0&&g('"MAX"'));a===null&&(e.substr(c,3)==="max"?(a="max",c+=3):(a=null,j===0&&g('"max"')));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();if(b!==null)if(e.charCodeAt(c)===40?(d="(",c++):(d=null,j===0&&g('"("')),d!==null){f=[];for(i=l();i!==null;)f.push(i),i=l();if(f!==null)if(e.substr(c,8)==="DISTINCT"?(i="DISTINCT",c+=8):(i=null,j===0&&g('"DISTINCT"')),i===null&&(e.substr(c,8)==="distinct"?(i="distinct",c+=8):(i=null,j===0&&g('"distinct"'))),i=i!==null?i:"",i!==null){h=[];for(k=l();k!==
null;)h.push(k),k=l();if(h!==null)if(k=H(),k!==null){n=[];for(m=l();m!==null;)n.push(m),m=l();if(n!==null)if(e.charCodeAt(c)===41?(m=")",c++):(m=null,j===0&&g('")"')),m!==null){o=[];for(q=l();q!==null;)o.push(q),q=l();o!==null?a=[a,b,d,f,i,h,k,n,m,o]:(a=null,c=v)}else a=null,c=v;else a=null,c=v}else a=null,c=v;else a=null,c=v}else a=null,c=v;else a=null,c=v}else a=null,c=v;else a=null,c=v}else a=null,c=v;a!==null&&(a=function(a,b,c){a={token:"expression",expressionType:"aggregate",aggregateType:"max"};
a.distinct=b!=""?"DISTINCT":b;a.expression=c;return a}(t,a[4],a[6]));a===null&&(c=t);if(a===null){v=t=c;e.substr(c,3)==="AVG"?(a="AVG",c+=3):(a=null,j===0&&g('"AVG"'));a===null&&(e.substr(c,3)==="avg"?(a="avg",c+=3):(a=null,j===0&&g('"avg"')));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();if(b!==null)if(e.charCodeAt(c)===40?(d="(",c++):(d=null,j===0&&g('"("')),d!==null){f=[];for(i=l();i!==null;)f.push(i),i=l();if(f!==null)if(e.substr(c,8)==="DISTINCT"?(i="DISTINCT",c+=8):(i=null,j===0&&g('"DISTINCT"')),
i===null&&(e.substr(c,8)==="distinct"?(i="distinct",c+=8):(i=null,j===0&&g('"distinct"'))),i=i!==null?i:"",i!==null){h=[];for(k=l();k!==null;)h.push(k),k=l();if(h!==null)if(k=H(),k!==null){n=[];for(m=l();m!==null;)n.push(m),m=l();if(n!==null)if(e.charCodeAt(c)===41?(m=")",c++):(m=null,j===0&&g('")"')),m!==null){o=[];for(q=l();q!==null;)o.push(q),q=l();o!==null?a=[a,b,d,f,i,h,k,n,m,o]:(a=null,c=v)}else a=null,c=v;else a=null,c=v}else a=null,c=v;else a=null,c=v}else a=null,c=v;else a=null,c=v}else a=
null,c=v;else a=null,c=v}else a=null,c=v;a!==null&&(a=function(a,b,c){a={token:"expression",expressionType:"aggregate",aggregateType:"avg"};a.distinct=b!=""?"DISTINCT":b;a.expression=c;return a}(t,a[4],a[6]));a===null&&(c=t)}}}}j--;j===0&&a===null&&g("[110] Aggregate");return a}function Rb(){var a,b,e,d;j++;d=e=c;a=O();a!==null?(b=qb(),b=b!==null?b:"",b!==null?a=[a,b]:(a=null,c=d)):(a=null,c=d);a!==null&&(a=function(a,b,c){a={token:"expression",expressionType:"irireforfunction"};a.iriref=b;a.args=
c.value;return a}(e,a[0],a[1]));a===null&&(c=e);j--;j===0&&a===null&&g("[117] IRIrefOrFunction");return a}function Oa(){var a,b,d,f,i,h;j++;i=f=c;a=Wb();a!==null?(b=Xb(),b===null&&(h=c,e.substr(c,2)==="^^"?(b="^^",c+=2):(b=null,j===0&&g('"^^"')),b!==null?(d=O(),d!==null?b=[b,d]:(b=null,c=h)):(b=null,c=h)),b=b!==null?b:"",b!==null?a=[a,b]:(a=null,c=i)):(a=null,c=i);a!==null&&(a=function(a,b,c){return typeof c==="string"&&c.length>0?{token:"literal",value:b.value,lang:c.slice(1),type:null}:typeof c===
"object"?(c.shift(),{token:"literal",value:b.value,lang:null,type:c[0]}):{token:"literal",value:b.value,lang:null,type:null}}(f,a[0],a[1]));a===null&&(c=f);j--;j===0&&a===null&&g("[112] RDFLiteral");return a}function Pa(){var a;j++;a=Yb();a===null&&(a=Zb(),a===null&&(a=ta()));j--;j===0&&a===null&&g("[113] NumericLiteral");return a}function Yb(){var a;j++;a=Za();a===null&&(a=$a(),a===null&&(a=aa()));j--;j===0&&a===null&&g("[114] NumericLiteralUnsigned");return a}function Zb(){var a;j++;a=$b();a===
null&&(a=ac(),a===null&&(a=bc()));j--;j===0&&a===null&&g("[115] NumericLiteralPositive");return a}function ta(){var a;j++;a=cc();a===null&&(a=dc(),a===null&&(a=ec()));j--;j===0&&a===null&&g("[116] NumericLiteralNegative");return a}function Qa(){var a,b;j++;b=c;e.substr(c,4)==="TRUE"?(a="TRUE",c+=4):(a=null,j===0&&g('"TRUE"'));a===null&&(e.substr(c,4)==="true"?(a="true",c+=4):(a=null,j===0&&g('"true"')));a!==null&&(a={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#boolean",value:!0});
a===null&&(c=b);a===null&&(b=c,e.substr(c,5)==="FALSE"?(a="FALSE",c+=5):(a=null,j===0&&g('"FALSE"')),a===null&&(e.substr(c,5)==="false"?(a="false",c+=5):(a=null,j===0&&g('"false"'))),a!==null&&(a={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#boolean",value:!1}),a===null&&(c=b));j--;j===0&&a===null&&g("[117] BooleanLiteral");return a}function Wb(){var a,b;j++;b=c;a=fc();a!==null&&(a={token:"string",value:a});a===null&&(c=b);a===null&&(b=c,a=gc(),a!==null&&(a={token:"string",value:a}),
a===null&&(c=b),a===null&&(b=c,a=hc(),a!==null&&(a={token:"string",value:a}),a===null&&(c=b),a===null&&(b=c,a=ic(),a!==null&&(a={token:"string",value:a}),a===null&&(c=b))));j--;j===0&&a===null&&g("[118] String");return a}function O(){var a,b;j++;b=c;a=Ja();a!==null&&(a={token:"uri",prefix:null,suffix:null,value:a});a===null&&(c=b);a===null&&(b=c,a=jc(),a===null&&(c=b));j--;j===0&&a===null&&g("[119] IRIref");return a}function jc(){var a,b;j++;b=c;a=kc();a!==null&&(a={token:"uri",prefix:a[0],suffix:a[1],
value:null});a===null&&(c=b);a===null&&(b=c,a=Ka(),a!==null&&(a={token:"uri",prefix:a,suffix:"",value:null}),a===null&&(c=b));j--;j===0&&a===null&&g("[120] PrefixedName");return a}function Qb(){var a,b;j++;b=c;a=lc();a!==null&&(a={token:"blank",value:a});a===null&&(c=b);a===null&&(b=c,a=mc(),a!==null&&(ba++,a={token:"blank",value:"_:"+ba}),a===null&&(c=b));j--;j===0&&a===null&&g("[121] BlankNode");return a}function Ja(){var a,b,d,f,i;j++;i=f=c;e.charCodeAt(c)===60?(a="<",c++):(a=null,j===0&&g('"<"'));
if(a!==null){b=[];/^[^<>"{}|^`\\]/.test(e.charAt(c))?(d=e.charAt(c),c++):(d=null,j===0&&g('[^<>"{}|^`\\\\]'));for(;d!==null;)b.push(d),/^[^<>"{}|^`\\]/.test(e.charAt(c))?(d=e.charAt(c),c++):(d=null,j===0&&g('[^<>"{}|^`\\\\]'));b!==null?(e.charCodeAt(c)===62?(d=">",c++):(d=null,j===0&&g('">"')),d!==null?a=[a,b,d]:(a=null,c=i)):(a=null,c=i)}else a=null,c=i;a!==null&&(a=a[1].join(""));a===null&&(c=f);j--;j===0&&a===null&&g("[122] IRI_REF");return a}function Ka(){var a,b,d,f;j++;f=d=c;a=nc();a=a!==null?
a:"";a!==null?(e.charCodeAt(c)===58?(b=":",c++):(b=null,j===0&&g('":"')),b!==null?a=[a,b]:(a=null,c=f)):(a=null,c=f);a!==null&&(a=a[0]);a===null&&(c=d);j--;j===0&&a===null&&g("[123] PNAME_NS");return a}function kc(){var a,b,e,d;j++;d=e=c;a=Ka();a!==null?(b=ub(),b!==null?a=[a,b]:(a=null,c=d)):(a=null,c=d);a!==null&&(a=[a[0],a[1]]);a===null&&(c=e);j--;j===0&&a===null&&g("[124] PNAME_LN");return a}function lc(){var a,b,d,f;j++;f=d=c;e.substr(c,2)==="_:"?(a="_:",c+=2):(a=null,j===0&&g('"_:"'));a!==null?
(b=ub(),b!==null?a=[a,b]:(a=null,c=f)):(a=null,c=f);a!==null&&(a=a[1]);a===null&&(c=d);j--;j===0&&a===null&&g("[125] BLANK_NODE_LABEL");return a}function Ob(){var a,b,d,f;j++;f=d=c;e.charCodeAt(c)===63?(a="?",c++):(a=null,j===0&&g('"?"'));a!==null?(b=vb(),b!==null?a=[a,b]:(a=null,c=f)):(a=null,c=f);a!==null&&(a=a[1]);a===null&&(c=d);j--;j===0&&a===null&&g("[126] VAR1");return a}function Pb(){var a,b,d,f;j++;f=d=c;e.charCodeAt(c)===36?(a="$",c++):(a=null,j===0&&g('"$"'));a!==null?(b=vb(),b!==null?
a=[a,b]:(a=null,c=f)):(a=null,c=f);a!==null&&(a=a[1]);a===null&&(c=d);j--;j===0&&a===null&&g("[127] VAR2");return a}function Xb(){var a,b,d,f,i,h,k,l,n;j++;l=k=c;e.charCodeAt(c)===64?(a="@",c++):(a=null,j===0&&g('"@"'));if(a!==null){/^[a-zA-Z]/.test(e.charAt(c))?(d=e.charAt(c),c++):(d=null,j===0&&g("[a-zA-Z]"));if(d!==null)for(b=[];d!==null;)b.push(d),/^[a-zA-Z]/.test(e.charAt(c))?(d=e.charAt(c),c++):(d=null,j===0&&g("[a-zA-Z]"));else b=null;if(b!==null){d=[];n=c;e.charCodeAt(c)===45?(f="-",c++):
(f=null,j===0&&g('"-"'));if(f!==null){/^[a-zA-Z0-9]/.test(e.charAt(c))?(h=e.charAt(c),c++):(h=null,j===0&&g("[a-zA-Z0-9]"));if(h!==null)for(i=[];h!==null;)i.push(h),/^[a-zA-Z0-9]/.test(e.charAt(c))?(h=e.charAt(c),c++):(h=null,j===0&&g("[a-zA-Z0-9]"));else i=null;i!==null?f=[f,i]:(f=null,c=n)}else f=null,c=n;for(;f!==null;)if(d.push(f),n=c,e.charCodeAt(c)===45?(f="-",c++):(f=null,j===0&&g('"-"')),f!==null){/^[a-zA-Z0-9]/.test(e.charAt(c))?(h=e.charAt(c),c++):(h=null,j===0&&g("[a-zA-Z0-9]"));if(h!==
null)for(i=[];h!==null;)i.push(h),/^[a-zA-Z0-9]/.test(e.charAt(c))?(h=e.charAt(c),c++):(h=null,j===0&&g("[a-zA-Z0-9]"));else i=null;i!==null?f=[f,i]:(f=null,c=n)}else f=null,c=n;d!==null?a=[a,b,d]:(a=null,c=l)}else a=null,c=l}else a=null,c=l;a!==null&&(a=a[2].length===0?("@"+a[1].join("")).toLowerCase():("@"+a[1].join("")+"-"+a[2][0][1].join("")).toLowerCase());a===null&&(c=k);j--;j===0&&a===null&&g("[128] LANGTAG");return a}function aa(){var a,b,d;j++;d=c;/^[0-9]/.test(e.charAt(c))?(b=e.charAt(c),
c++):(b=null,j===0&&g("[0-9]"));if(b!==null)for(a=[];b!==null;)a.push(b),/^[0-9]/.test(e.charAt(c))?(b=e.charAt(c),c++):(b=null,j===0&&g("[0-9]"));else a=null;a!==null&&(a=function(a,b){var c={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#integer"};c.value=X(b);return c}(d,a));a===null&&(c=d);j--;j===0&&a===null&&g("[129] INTEGER");return a}function $a(){var a,b,d,f,i,h;j++;h=i=c;/^[0-9]/.test(e.charAt(c))?(b=e.charAt(c),c++):(b=null,j===0&&g("[0-9]"));if(b!==null)for(a=[];b!==
null;)a.push(b),/^[0-9]/.test(e.charAt(c))?(b=e.charAt(c),c++):(b=null,j===0&&g("[0-9]"));else a=null;if(a!==null)if(e.charCodeAt(c)===46?(b=".",c++):(b=null,j===0&&g('"."')),b!==null){d=[];/^[0-9]/.test(e.charAt(c))?(f=e.charAt(c),c++):(f=null,j===0&&g("[0-9]"));for(;f!==null;)d.push(f),/^[0-9]/.test(e.charAt(c))?(f=e.charAt(c),c++):(f=null,j===0&&g("[0-9]"));d!==null?a=[a,b,d]:(a=null,c=h)}else a=null,c=h;else a=null,c=h;a!==null&&(a=function(a,b,c,e){a={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#decimal"};
a.value=X([b,c,e]);return a}(i,a[0],a[1],a[2]));a===null&&(c=i);if(a===null){h=i=c;e.charCodeAt(c)===46?(a=".",c++):(a=null,j===0&&g('"."'));if(a!==null){/^[0-9]/.test(e.charAt(c))?(d=e.charAt(c),c++):(d=null,j===0&&g("[0-9]"));if(d!==null)for(b=[];d!==null;)b.push(d),/^[0-9]/.test(e.charAt(c))?(d=e.charAt(c),c++):(d=null,j===0&&g("[0-9]"));else b=null;b!==null?a=[a,b]:(a=null,c=h)}else a=null,c=h;a!==null&&(a=function(a,b,c){a={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#decimal"};
a.value=X([b,c]);return a}(i,a[0],a[1]));a===null&&(c=i)}j--;j===0&&a===null&&g("[130] DECIMAL");return a}function Za(){var a,b,d,f,i,h;j++;h=i=c;/^[0-9]/.test(e.charAt(c))?(b=e.charAt(c),c++):(b=null,j===0&&g("[0-9]"));if(b!==null)for(a=[];b!==null;)a.push(b),/^[0-9]/.test(e.charAt(c))?(b=e.charAt(c),c++):(b=null,j===0&&g("[0-9]"));else a=null;if(a!==null)if(e.charCodeAt(c)===46?(b=".",c++):(b=null,j===0&&g('"."')),b!==null){d=[];/^[0-9]/.test(e.charAt(c))?(f=e.charAt(c),c++):(f=null,j===0&&g("[0-9]"));
for(;f!==null;)d.push(f),/^[0-9]/.test(e.charAt(c))?(f=e.charAt(c),c++):(f=null,j===0&&g("[0-9]"));d!==null?(f=ab(),f!==null?a=[a,b,d,f]:(a=null,c=h)):(a=null,c=h)}else a=null,c=h;else a=null,c=h;a!==null&&(a=function(a,b,c,e,d){a={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#double"};a.value=X([b,c,e,d]);return a}(i,a[0],a[1],a[2],a[3]));a===null&&(c=i);if(a===null){h=i=c;e.charCodeAt(c)===46?(a=".",c++):(a=null,j===0&&g('"."'));if(a!==null){/^[0-9]/.test(e.charAt(c))?(d=e.charAt(c),
c++):(d=null,j===0&&g("[0-9]"));if(d!==null)for(b=[];d!==null;)b.push(d),/^[0-9]/.test(e.charAt(c))?(d=e.charAt(c),c++):(d=null,j===0&&g("[0-9]"));else b=null;b!==null?(d=ab(),d!==null?a=[a,b,d]:(a=null,c=h)):(a=null,c=h)}else a=null,c=h;a!==null&&(a=function(a,b,c,e){a={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#double"};a.value=X([b,c,e]);return a}(i,a[0],a[1],a[2]));a===null&&(c=i);if(a===null){h=i=c;/^[0-9]/.test(e.charAt(c))?(b=e.charAt(c),c++):(b=null,j===0&&g("[0-9]"));
if(b!==null)for(a=[];b!==null;)a.push(b),/^[0-9]/.test(e.charAt(c))?(b=e.charAt(c),c++):(b=null,j===0&&g("[0-9]"));else a=null;a!==null?(b=ab(),b!==null?a=[a,b]:(a=null,c=h)):(a=null,c=h);a!==null&&(a=function(a,b,c){a={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#double"};a.value=X([b,c]);return a}(i,a[0],a[1]));a===null&&(c=i)}}j--;j===0&&a===null&&g("[131] DOUBLE");return a}function bc(){var a,b,d,f;j++;f=d=c;e.charCodeAt(c)===43?(a="+",c++):(a=null,j===0&&g('"+"'));a!==null?
(b=aa(),b!==null?a=[a,b]:(a=null,c=f)):(a=null,c=f);a!==null&&(a=function(a,b){b.value="+"+b.value;return b}(d,a[1]));a===null&&(c=d);j--;j===0&&a===null&&g("[132] INTEGER_POSITIVE");return a}function ac(){var a,b,d,f;j++;f=d=c;e.charCodeAt(c)===43?(a="+",c++):(a=null,j===0&&g('"+"'));a!==null?(b=$a(),b!==null?a=[a,b]:(a=null,c=f)):(a=null,c=f);a!==null&&(a=function(a,b){b.value="+"+b.value;return b}(d,a[1]));a===null&&(c=d);j--;j===0&&a===null&&g("[133] DECIMAL_POSITIVE");return a}function $b(){var a,
b,d,f;j++;f=d=c;e.charCodeAt(c)===43?(a="+",c++):(a=null,j===0&&g('"+"'));a!==null?(b=Za(),b!==null?a=[a,b]:(a=null,c=f)):(a=null,c=f);a!==null&&(a=function(a,b){b.value="+"+b.value;return b}(d,a[1]));a===null&&(c=d);j--;j===0&&a===null&&g("[134] DOUBLE_POSITIVE");return a}function ec(){var a,b,d,f;j++;f=d=c;e.charCodeAt(c)===45?(a="-",c++):(a=null,j===0&&g('"-"'));a!==null?(b=aa(),b!==null?a=[a,b]:(a=null,c=f)):(a=null,c=f);a!==null&&(a=function(a,b){b.value="-"+b.value;return b}(d,a[1]));a===null&&
(c=d);j--;j===0&&a===null&&g("[135] INTEGER_NEGATIVE");return a}function dc(){var a,b,d,f;j++;f=d=c;e.charCodeAt(c)===45?(a="-",c++):(a=null,j===0&&g('"-"'));a!==null?(b=$a(),b!==null?a=[a,b]:(a=null,c=f)):(a=null,c=f);a!==null&&(a=function(a,b){b.value="-"+b.value;return b}(d,a[1]));a===null&&(c=d);j--;j===0&&a===null&&g("[136] DECIMAL_NEGATIVE");return a}function cc(){var a,b,d,f;j++;f=d=c;e.charCodeAt(c)===45?(a="-",c++):(a=null,j===0&&g('"-"'));a!==null?(b=Za(),b!==null?a=[a,b]:(a=null,c=f)):
(a=null,c=f);a!==null&&(a=function(a,b){b.value="-"+b.value;return b}(d,a[1]));a===null&&(c=d);j--;j===0&&a===null&&g("[137] DOUBLE_NEGATIVE");return a}function ab(){var a,b,d,f,i,h;j++;h=i=c;/^[eE]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,j===0&&g("[eE]"));if(a!==null)if(/^[+\-]/.test(e.charAt(c))?(b=e.charAt(c),c++):(b=null,j===0&&g("[+\\-]")),b=b!==null?b:"",b!==null){/^[0-9]/.test(e.charAt(c))?(f=e.charAt(c),c++):(f=null,j===0&&g("[0-9]"));if(f!==null)for(d=[];f!==null;)d.push(f),/^[0-9]/.test(e.charAt(c))?
(f=e.charAt(c),c++):(f=null,j===0&&g("[0-9]"));else d=null;d!==null?a=[a,b,d]:(a=null,c=h)}else a=null,c=h;else a=null,c=h;a!==null&&(a=X([a[0],a[1],a[2]]));a===null&&(c=i);j--;j===0&&a===null&&g("[138] EXPONENT");return a}function hc(){var a,b,d,f,i;j++;i=f=c;e.charCodeAt(c)===39?(a="'",c++):(a=null,j===0&&g('"\'"'));if(a!==null){b=[];/^[^'\\\n\r]/.test(e.charAt(c))?(d=e.charAt(c),c++):(d=null,j===0&&g("[^'\\\\\\n\\r]"));for(d===null&&(d=ca());d!==null;)b.push(d),/^[^'\\\n\r]/.test(e.charAt(c))?
(d=e.charAt(c),c++):(d=null,j===0&&g("[^'\\\\\\n\\r]")),d===null&&(d=ca());b!==null?(e.charCodeAt(c)===39?(d="'",c++):(d=null,j===0&&g('"\'"')),d!==null?a=[a,b,d]:(a=null,c=i)):(a=null,c=i)}else a=null,c=i;a!==null&&(a=X(a[1]));a===null&&(c=f);j--;j===0&&a===null&&g("[139] STRING_LITERAL1");return a}function ic(){var a,b,d,f,i;j++;i=f=c;e.charCodeAt(c)===34?(a='"',c++):(a=null,j===0&&g('"\\""'));if(a!==null){b=[];/^[^"\\\n\r]/.test(e.charAt(c))?(d=e.charAt(c),c++):(d=null,j===0&&g('[^"\\\\\\n\\r]'));
for(d===null&&(d=ca());d!==null;)b.push(d),/^[^"\\\n\r]/.test(e.charAt(c))?(d=e.charAt(c),c++):(d=null,j===0&&g('[^"\\\\\\n\\r]')),d===null&&(d=ca());b!==null?(e.charCodeAt(c)===34?(d='"',c++):(d=null,j===0&&g('"\\""')),d!==null?a=[a,b,d]:(a=null,c=i)):(a=null,c=i)}else a=null,c=i;a!==null&&(a=X(a[1]));a===null&&(c=f);j--;j===0&&a===null&&g("[140] STRING_LITERAL2");return a}function fc(){var a,b,d,f,i;j++;i=f=c;e.substr(c,3)==="'''"?(a="'''",c+=3):(a=null,j===0&&g("\"'''\""));if(a!==null){b=[];/^[^'\\]/.test(e.charAt(c))?
(d=e.charAt(c),c++):(d=null,j===0&&g("[^'\\\\]"));for(d===null&&(d=ca());d!==null;)b.push(d),/^[^'\\]/.test(e.charAt(c))?(d=e.charAt(c),c++):(d=null,j===0&&g("[^'\\\\]")),d===null&&(d=ca());b!==null?(e.substr(c,3)==="'''"?(d="'''",c+=3):(d=null,j===0&&g("\"'''\"")),d!==null?a=[a,b,d]:(a=null,c=i)):(a=null,c=i)}else a=null,c=i;a!==null&&(a=X(a[1]));a===null&&(c=f);j--;j===0&&a===null&&g("[141] STRING_LITERAL_LONG1");return a}function gc(){var a,b,d,f,i;j++;i=f=c;e.substr(c,3)==='"""'?(a='"""',c+=3):
(a=null,j===0&&g('"\\"\\"\\""'));if(a!==null){b=[];/^[^"\\]/.test(e.charAt(c))?(d=e.charAt(c),c++):(d=null,j===0&&g('[^"\\\\]'));for(d===null&&(d=ca());d!==null;)b.push(d),/^[^"\\]/.test(e.charAt(c))?(d=e.charAt(c),c++):(d=null,j===0&&g('[^"\\\\]')),d===null&&(d=ca());b!==null?(e.substr(c,3)==='"""'?(d='"""',c+=3):(d=null,j===0&&g('"\\"\\"\\""')),d!==null?a=[a,b,d]:(a=null,c=i)):(a=null,c=i)}else a=null,c=i;a!==null&&(a=X(a[1]));a===null&&(c=f);j--;j===0&&a===null&&g("[142] STRING_LITERAL_LONG2");
return a}function ca(){var a,b,d;j++;d=c;e.charCodeAt(c)===92?(a="\\",c++):(a=null,j===0&&g('"\\\\"'));a!==null?(/^[tbnrf"']/.test(e.charAt(c))?(b=e.charAt(c),c++):(b=null,j===0&&g("[tbnrf\"']")),b!==null?a=[a,b]:(a=null,c=d)):(a=null,c=d);j--;j===0&&a===null&&g("[143] ECHAR");return a}function la(){var a,b,d,f,i;j++;i=f=c;e.charCodeAt(c)===40?(a="(",c++):(a=null,j===0&&g('"("'));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();b!==null?(e.charCodeAt(c)===41?(d=")",c++):(d=null,j===0&&g('")"')),
d!==null?a=[a,b,d]:(a=null,c=i)):(a=null,c=i)}else a=null,c=i;a!==null&&(a={token:"triplesnodecollection",triplesContext:[],chainSubject:[{token:"uri",value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}]});a===null&&(c=f);j--;j===0&&a===null&&g("[144] NIL");return a}function l(){var a;j++;/^[ ]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,j===0&&g("[ ]"));a===null&&(/^[\t]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,j===0&&g("[\\t]")),a===null&&(/^[\r]/.test(e.charAt(c))?(a=e.charAt(c),c++):
(a=null,j===0&&g("[\\r]")),a===null&&(/^[\n]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,j===0&&g("[\\n]")),a===null&&(a=oc()))));j--;j===0&&a===null&&g("[145] WS");return a}function oc(){var a,b,d,f;j++;f=c;e.charCodeAt(c)===35?(a="#",c++):(a=null,j===0&&g('"#"'));if(a!==null){b=[];/^[^\n\r]/.test(e.charAt(c))?(d=e.charAt(c),c++):(d=null,j===0&&g("[^\\n\\r]"));for(;d!==null;)b.push(d),/^[^\n\r]/.test(e.charAt(c))?(d=e.charAt(c),c++):(d=null,j===0&&g("[^\\n\\r]"));b!==null?a=[a,b]:(a=null,c=f)}else a=
null,c=f;j--;j===0&&a===null&&g(" COMMENT");return a}function mc(){var a,b,d,f;j++;f=c;e.charCodeAt(c)===91?(a="[",c++):(a=null,j===0&&g('"["'));if(a!==null){b=[];for(d=l();d!==null;)b.push(d),d=l();b!==null?(e.charCodeAt(c)===93?(d="]",c++):(d=null,j===0&&g('"]"')),d!==null?a=[a,b,d]:(a=null,c=f)):(a=null,c=f)}else a=null,c=f;j--;j===0&&a===null&&g("[146] ANON");return a}function wb(){var a;j++;/^[A-Z]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,j===0&&g("[A-Z]"));a===null&&(/^[a-z]/.test(e.charAt(c))?
(a=e.charAt(c),c++):(a=null,j===0&&g("[a-z]")),a===null&&(/^[\xC0-\xD6]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,j===0&&g("[\\xC0-\\xD6]")),a===null&&(/^[\xD8-\xF6]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,j===0&&g("[\\xD8-\\xF6]")),a===null&&(/^[\xF8-\u02FF]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,j===0&&g("[\\xF8-\\u02FF]")),a===null&&(/^[\u0370-\u037D]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,j===0&&g("[\\u0370-\\u037D]")),a===null&&(/^[\u037F-\u1FFF]/.test(e.charAt(c))?
(a=e.charAt(c),c++):(a=null,j===0&&g("[\\u037F-\\u1FFF]")),a===null&&(/^[\u200C-\u200D]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,j===0&&g("[\\u200C-\\u200D]")),a===null&&(/^[\u2070-\u218F]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,j===0&&g("[\\u2070-\\u218F]")),a===null&&(/^[\u2C00-\u2FEF]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,j===0&&g("[\\u2C00-\\u2FEF]")),a===null&&(/^[\u3001-\uD7FF]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,j===0&&g("[\\u3001-\\uD7FF]")),a===null&&(/^[\uF900-\uFDCF]/.test(e.charAt(c))?
(a=e.charAt(c),c++):(a=null,j===0&&g("[\\uF900-\\uFDCF]")),a===null&&(/^[\uFDF0-\uFFFD]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,j===0&&g("[\\uFDF0-\\uFFFD]")),a===null&&(/^[\u1000-\uEFFF]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,j===0&&g("[\\u1000-\\uEFFF]")))))))))))))));j--;j===0&&a===null&&g("[147] PN_CHARS_BASE");return a}function ua(){var a;j++;a=wb();a===null&&(e.charCodeAt(c)===95?(a="_",c++):(a=null,j===0&&g('"_"')));j--;j===0&&a===null&&g("[148] PN_CHARS_U");return a}function vb(){var a,
b,d,f,i;j++;i=f=c;a=ua();a===null&&(/^[0-9]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,j===0&&g("[0-9]")));if(a!==null){b=[];d=ua();d===null&&(/^[0-9]/.test(e.charAt(c))?(d=e.charAt(c),c++):(d=null,j===0&&g("[0-9]")),d===null&&(/^[\xB7]/.test(e.charAt(c))?(d=e.charAt(c),c++):(d=null,j===0&&g("[\\xB7]")),d===null&&(/^[\u0300-\u036F]/.test(e.charAt(c))?(d=e.charAt(c),c++):(d=null,j===0&&g("[\\u0300-\\u036F]")),d===null&&(/^[\u203F-\u2040]/.test(e.charAt(c))?(d=e.charAt(c),c++):(d=null,j===0&&g("[\\u203F-\\u2040]"))))));
for(;d!==null;)b.push(d),d=ua(),d===null&&(/^[0-9]/.test(e.charAt(c))?(d=e.charAt(c),c++):(d=null,j===0&&g("[0-9]")),d===null&&(/^[\xB7]/.test(e.charAt(c))?(d=e.charAt(c),c++):(d=null,j===0&&g("[\\xB7]")),d===null&&(/^[\u0300-\u036F]/.test(e.charAt(c))?(d=e.charAt(c),c++):(d=null,j===0&&g("[\\u0300-\\u036F]")),d===null&&(/^[\u203F-\u2040]/.test(e.charAt(c))?(d=e.charAt(c),c++):(d=null,j===0&&g("[\\u203F-\\u2040]"))))));b!==null?a=[a,b]:(a=null,c=i)}else a=null,c=i;a!==null&&(a=a[0]+a[1].join(""));
a===null&&(c=f);j--;j===0&&a===null&&g("[149] VARNAME");return a}function Ga(){var a;j++;a=ua();a===null&&(e.charCodeAt(c)===45?(a="-",c++):(a=null,j===0&&g('"-"')),a===null&&(/^[0-9]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,j===0&&g("[0-9]")),a===null&&(/^[\xB7]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,j===0&&g("[\\xB7]")),a===null&&(/^[\u0300-\u036F]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,j===0&&g("[\\u0300-\\u036F]")),a===null&&(/^[\u203F-\u2040]/.test(e.charAt(c))?(a=e.charAt(c),
c++):(a=null,j===0&&g("[\\u203F-\\u2040]")))))));j--;j===0&&a===null&&g("[150] PN_CHARS");return a}function nc(){var a,b,d,f,i;j++;i=f=c;a=wb();if(a!==null){b=[];d=Ga();d===null&&(e.charCodeAt(c)===46?(d=".",c++):(d=null,j===0&&g('"."')));for(;d!==null;)b.push(d),d=Ga(),d===null&&(e.charCodeAt(c)===46?(d=".",c++):(d=null,j===0&&g('"."')));b!==null?a=[a,b]:(a=null,c=i)}else a=null,c=i;a!==null&&(a=function(a,b,c){if(c[c.length-1]==".")throw Error("Wrong PN_PREFIX, cannot finish with '.'");else return b+
c.join("")}(f,a[0],a[1]));a===null&&(c=f);j--;j===0&&a===null&&g("[151] PN_PREFIX");return a}function ub(){var a,b,d,f,i;j++;i=f=c;a=ua();a===null&&(/^[0-9]/.test(e.charAt(c))?(a=e.charAt(c),c++):(a=null,j===0&&g("[0-9]")));if(a!==null){b=[];for(d=Ga();d!==null;)b.push(d),d=Ga();b!==null?a=[a,b]:(a=null,c=i)}else a=null,c=i;a!==null&&(a=a[0]+a[1].join(""));a===null&&(c=f);j--;j===0&&a===null&&g("[152] PN_LOCAL");return a}function jb(a){a.sort();for(var b=null,c=[],d=0;d<a.length;d++)a[d]!==b&&(c.push(a[d]),
b=a[d]);return c}function kb(){for(var a=1,b=1,d=!1,f=0;f<Math.max(c,Aa);f++){var i=e.charAt(f);i==="\n"?(d||a++,b=1,d=!1):i==="\r"||i==="\u2028"||i==="\u2029"?(a++,b=1,d=!0):(b++,d=!1)}return{line:a,column:b}}var da={SPARQL:function(){var a;a=i();a===null&&(a=$());return a},Query:i,Prologue:f,BaseDecl:h,PrefixDecl:k,SelectQuery:o,SubSelect:m,SelectClause:q,ConstructQuery:t,DescribeQuery:s,AskQuery:A,DatasetClause:y,DefaultGraphClause:C,NamedGraphClause:D,WhereClause:z,SolutionModifier:E,GroupClause:I,
GroupCondition:F,HavingClause:G,OrderClause:P,OrderCondition:M,LimitOffsetClauses:T,LimitClause:V,OffsetClause:W,BindingsClause:Y,BindingValue:U,Update:$,Update1:ea,Load:fa,Clear:ha,Drop:ia,Create:ja,InsertData:na,DeleteData:oa,DeleteWhere:va,Modify:wa,DeleteClause:xa,InsertClause:eb,UsingClause:fb,GraphRef:Ia,GraphRefAll:gb,QuadPattern:cb,QuadData:db,Quads:hb,QuadsNotTriples:ib,TriplesTemplate:pa,GroupGraphPattern:S,GroupGraphPatternSub:ya,TriplesBlock:Ca,GraphPatternNotTriples:pb,OptionalGraphPattern:za,
GraphGraphPattern:Cb,ServiceGraphPattern:Db,MinusGraphPattern:Bb,GroupOrUnionGraphPattern:Ab,Filter:Eb,Constraint:Ba,FunctionCall:nb,ArgList:qb,ExpressionList:qa,ConstructTemplate:yb,ConstructTriples:rb,TriplesSameSubject:ob,PropertyListNotEmpty:Da,PropertyList:Fb,ObjectList:ma,Verb:Ta,TriplesSameSubjectPath:zb,PropertyListNotEmptyPath:Gb,PropertyListPath:Hb,VerbPath:Ua,PathAlternative:sb,PathSequence:Va,PathElt:tb,PathEltOrInverse:Wa,PathMod:Jb,PathPrimary:Ib,PathNegatedPropertySet:Kb,PathOneInPropertySet:Ea,
TriplesNode:Sa,BlankNodePropertyList:Mb,Collection:Lb,GraphNode:ra,VarOrTerm:Ra,VarOrIRIref:ka,Var:N,GraphTerm:Nb,ConditionalOrExpression:H,ConditionalAndExpression:Xa,RelationalExpression:Ya,AdditiveExpression:R,MultiplicativeExpression:sa,UnaryExpression:Z,PrimaryExpression:Fa,BrackettedExpression:Na,BuiltInCall:Ma,RegexExpression:Tb,ExistsFunc:Ub,NotExistsFunc:Vb,Aggregate:Sb,IRIrefOrFunction:Rb,RDFLiteral:Oa,NumericLiteral:Pa,NumericLiteralUnsigned:Yb,NumericLiteralPositive:Zb,NumericLiteralNegative:ta,
BooleanLiteral:Qa,String:Wb,IRIref:O,PrefixedName:jc,BlankNode:Qb,IRI_REF:Ja,PNAME_NS:Ka,PNAME_LN:kc,BLANK_NODE_LABEL:lc,VAR1:Ob,VAR2:Pb,LANGTAG:Xb,INTEGER:aa,DECIMAL:$a,DOUBLE:Za,INTEGER_POSITIVE:bc,DECIMAL_POSITIVE:ac,DOUBLE_POSITIVE:$b,INTEGER_NEGATIVE:ec,DECIMAL_NEGATIVE:dc,DOUBLE_NEGATIVE:cc,EXPONENT:ab,STRING_LITERAL1:hc,STRING_LITERAL2:ic,STRING_LITERAL_LONG1:fc,STRING_LITERAL_LONG2:gc,ECHAR:ca,NIL:la,WS:l,COMMENT:oc,ANON:mc,PN_CHARS_BASE:wb,PN_CHARS_U:ua,VARNAME:vb,PN_CHARS:Ga,PN_PREFIX:nc,
PN_LOCAL:ub};if(b!==void 0){if(da[b]===void 0)throw Error("Invalid rule name: "+a(b)+".");}else b="SPARQL";var c=0,j=0,Aa=0,mb=[],X=function(a){for(var b="",c=0;c<a.length;c++)b+=typeof a[c]==="string"?a[c]:a[c].join("");return b},ba=0,xb=function(a){for(var b="",c=0;c<a.length;c++)b+=a[c];return b.toUpperCase()},da=da[b]();if(da===null||c!==e.length){var da=Math.max(c,Aa),lb=da<e.length?e.charAt(da):null,pc=kb();throw new this.SyntaxError(jb(mb),lb,da,pc.line,pc.column);}return da},toSource:function(){return this._source},
SyntaxError:function(b,d,g,i,f){this.name="SyntaxError";this.expected=b;this.found=d;this.message=function(b,d){var e,f;switch(b.length){case 0:e="end of input";break;case 1:e=b[0];break;default:e=b.slice(0,b.length-1).join(", ")+" or "+b[b.length-1]}f=d?a(d):"end of input";return"Expected "+e+" but "+f+" found."}(b,d);this.offset=g;this.line=i;this.column=f}};b.SyntaxError.prototype=Error.prototype;return b}();var q={defaultContext:{rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",
owl:"http://www.w3.org/2002/07/owl#",xsd:"http://www.w3.org/2001/XMLSchema#",dcterms:"http://purl.org/dc/terms/",foaf:"http://xmlns.com/foaf/0.1/",cal:"http://www.w3.org/2002/12/cal/ical#",vcard:"http://www.w3.org/2006/vcard/ns# ",geo:"http://www.w3.org/2003/01/geo/wgs84_pos#",cc:"http://creativecommons.org/ns#",sioc:"http://rdfs.org/sioc/ns#",doap:"http://usefulinc.com/ns/doap#",com:"http://purl.org/commerce#",ps:"http://purl.org/payswarm#",gr:"http://purl.org/goodrelations/v1#",sig:"http://purl.org/signature#",
ccard:"http://purl.org/commerce/creditcard#"},UrisMap:function(){this.defaultNs="";this.interfaceProperties=["get","remove","set","setDefault","addAll","resolve","shrink"]}};q.UrisMap.prototype.values=function(){var a={},b;for(b in this)!s.include(this.interfaceProperties,b)&&typeof this[b]!=="function"&&b!=="defaultNs"&&b!=="interfaceProperties"&&(a[b]=this[b]);return a};q.UrisMap.prototype.get=function(a){if(a.indexOf(" ")!=-1)throw"Prefix must not contain any whitespaces";return this[a]};q.UrisMap.prototype.remove=
function(a){if(a.indexOf(" ")!=-1)throw"Prefix must not contain any whitespaces";delete this[a];return null};q.UrisMap.prototype.set=function(a,b){if(a.indexOf(" ")!=-1)throw"Prefix must not contain any whitespaces";this[a]=b};q.UrisMap.prototype.setDefault=function(a){this.defaultNs=a};q.UrisMap.prototype.addAll=function(a,b){for(var e in a)s.include(this.interfaceProperties,e)||(this[e]!=null?b===!0&&(this[e]=a[e]):this[e]=a[e]);return this};q.UrisMap.prototype.resolve=function(a){var b=a.split(":"),
a=b[0],b=b[1];return a===""?this.defaultNs==null?null:this.defaultNs+b:this[a]!=null?this[a]+b:null};q.UrisMap.prototype.shrink=function(a){for(var b in this){var e=this[b];if(a.indexOf(e)===0&&e!==""&&b!="defaultNs")return a=a.split(e)[1],b+":"+a}return a};q.Profile=function(){this.prefixes=new q.UrisMap;this.terms=new q.UrisMap};q.Profile.prototype.importProfile=function(a,b){this.prefixes.addAll(a.prefixes,b);this.terms.addAll(a.terms,b)};q.Profile.prototype.resolve=function(a){return a.indexOf(":")!=
-1?this.prefixes.resolve(a):this.terms[a]!=null?this.terms.resolve(a):null};q.Profile.prototype.setDefaultPrefix=function(a){this.prefixes.setDefault(a)};q.Profile.prototype.setDefaultVocabulary=function(a){this.terms.setDefault(a)};q.Profile.prototype.setPrefix=function(a,b){this.prefixes.set(a,b)};q.Profile.prototype.setTerm=function(a,b){this.terms.set(a,b)};q.RDFEnvironment=function(){this.blankNodeCounter=0;var a=this;this.filters={s:function(a){return function(b){return b.subject.equals(a)}},
p:function(a){return function(b){return b.predicate.equals(a)}},o:function(a){return function(b){return b.object.equals(a)}},sp:function(a,b){return function(g){return g.subject.equals(a)&&g.predicate.equals(b)}},so:function(a,b){return function(g){return g.subject.equals(a)&&g.object.equals(b)}},po:function(a,b){return function(g){return g.predicate.equals(a)&&g.object.equals(b)}},spo:function(a,b,g){return function(i){return i.subject.equals(a)&&i.predicate.equals(b)&&i.object.equals(g)}},describes:function(a){return function(b){return b.subject.equals(a)||
b.object.equals(a)}},type:function(b){var d=a.resolve("rdf:type");return function(a){return a.predicate.equals(d)&&a.object.equals(b)}}};for(var b in q.defaultContext)this.prefixes.set(b,q.defaultContext[b])};s["extends"](q.Profile,q.RDFEnvironment);q.RDFEnvironment.prototype.createBlankNode=function(){var a=new q.BlankNode(this.blankNodeCounter);this.blankNodeCounter++;return a};q.RDFEnvironment.prototype.createNamedNode=function(a){var b=this.resolve(a);return b!=null?new q.NamedNode(b):new q.NamedNode(a)};
q.RDFEnvironment.prototype.createLiteral=function(a,b,e){return e!=null?new q.Literal(a,b,e.toString()):new q.Literal(a,b,e)};q.RDFEnvironment.prototype.createTriple=function(a,b,e){return new q.Triple(a,b,e)};q.RDFEnvironment.prototype.createGraph=function(a){var b=new q.Graph;if(a!=null)for(var e=0;e<a.length;e++)b.add(a[e]);return b};q.RDFEnvironment.prototype.createAction=function(a,b){return function(e){return a(e)?b(e):e}};q.RDFEnvironment.prototype.createProfile=function(a){return a===!0?new q.RDFEnvironment.Profile:
(a=new q.RDFEnvironment.Profile,a.importProfile(this),a)};q.RDFEnvironment.prototype.createTermMap=function(a){if(a===!0)return new q.UrisMap;else{var a=this.terms.values(),b=new q.UrisMap,e;for(e in a)b[e]=a[e];return b}};q.RDFEnvironment.prototype.createPrefixMap=function(a){if(a===!0)return new q.UrisMap;else{var a=this.prefixes.values(),b=new q.UrisMap,e;for(e in a)b[e]=a[e];return b}};q.RDFNode=function(a){this.interfaceName=a;this.attributes=["interfaceName","nominalValue"]};q.RDFNode.prototype.equals=
function(a){if(a.interfaceName==null)return this.valueOf()==a;else{for(var b in this.attributes){var e=this.attributes[b];if(this[e]!=a[e])return!1}return!0}};q.BlankNode=function(a){q.RDFNode.call(this,"BlankNode");this.nominalValue="_:"+a;this.bnodeId=a};s["extends"](q.RDFNode,q.BlankNode);q.BlankNode.prototype.toString=function(){return this.nominalValue};q.BlankNode.prototype.toNT=function(){return this.nominalValue};q.BlankNode.prototype.valueOf=function(){return this.nominalValue};q.Literal=
function(a,b,e){q.RDFNode.call(this,"Literal");this.nominalValue=a;if(b!=null)this.language=b;else if(e!=null)this.datatype=e};s["extends"](q.RDFNode,q.Literal);q.Literal.prototype.toString=function(){var a='"'+this.nominalValue+'"';if(this.language!=null)a=a+"@"+this.language;else if(this.datatype!=null||this.type)a=a+"^^<"+(this.datatype||this.type)+">";return a};q.Literal.prototype.toNT=function(){return this.toString()};q.Literal.prototype.valueOf=function(){return h.effectiveTypeValue({token:"literal",
type:this.type||this.datatype,value:this.nominalValue,language:this.language})};q.NamedNode=function(a){q.RDFNode.call(this,"NamedNode");this.nominalValue=a.value!=null?a.value:a};s["extends"](q.RDFNode,q.NamedNode);q.NamedNode.prototype.toString=function(){return this.nominalValue};q.NamedNode.prototype.toNT=function(){return"<"+this.toString()+">"};q.NamedNode.prototype.valueOf=function(){return this.nominalValue};q.Triple=function(a,b,e){this.subject=a;this.predicate=b;this.object=e};q.Triple.prototype.equals=
function(a){return this.subject.equals(a.subject)&&this.predicate.equals(a.predicate)&&this.object.equals(a.object)};q.Triple.prototype.toString=function(){return this.subject.toNT()+" "+this.predicate.toNT()+" "+this.object.toNT()+" . \r\n"};q.Graph=function(){this.triples=[];this.duplicates={};this.actions=[];this.length=0};q.Graph.prototype.add=function(a){for(var b=0;b<this.actions.length;b++)a=this.actions[b](a);b=a.subject.toString()+a.predicate.toString()+a.object.toString();this.duplicates[b]||
(this.duplicates[b]=!0,this.triples.push(a));this.length=this.triples.length;return this};q.Graph.prototype.addAction=function(a,b){this.actions.push(a);if(b==!0)for(var e=0;e<this.triples.length;e++)this.triples[e]=a(this.triples[e]);return this};q.Graph.prototype.addAll=function(a){for(var a=a.toArray(),b=0;b<a.length;b++)this.add(a[b]);this.length=this.triples.length;return this};q.Graph.prototype.remove=function(a){for(var b=null,e=0;e<this.triples.length;e++)if(this.triples[e].equals(a)){delete this.duplicates[a.subject.toString()+
a.predicate.toString()+a.object.toString()];b=e;break}b!=null&&this.triples.splice(b,1);this.length=this.triples.length;return this};q.Graph.prototype.toArray=function(){return this.triples};q.Graph.prototype.some=function(a){for(var b=0;b<this.triples.length;b++)if(a(this.triples[b],this)===!0)return!0;return!1};q.Graph.prototype.every=function(a){for(var b=0;b<this.triples.length;b++)if(a(this.triples[b],this)===!1)return!1;return!0};q.Graph.prototype.filter=function(a){for(var b=new q.Graph,e=
0;e<this.triples.length;e++)a(this.triples[e],this)===!0&&b.add(this.triples[e]);return b};q.Graph.prototype.forEach=function(a){for(var b=0;b<this.triples.length;b++)a(this.triples[b],this)};q.Graph.prototype.merge=function(){for(var a=new q.Graph,b=0;b<this.triples.length;b++)a.add(this.triples[b]);return a};q.Graph.prototype.match=function(a,b,e,d){for(var g=new q.Graph,i=0,f=0;f<this.triples.length;f++){var h=this.triples[f];if(a==null||h.subject.equals(a))if(b==null||h.predicate.equals(b))if(e==
null||h.object.equals(e))if(d==null||i<d)i++,g.add(h);else break}return g};q.Graph.prototype.removeMatches=function(a,b,e){for(var d=[],g=0;g<this.triples.length;g++){var i=this.triples[g];if(a==null||i.subject.equals(a))if(b==null||i.predicate.equals(b))(e==null||i.object.equals(e))&&d.push(i)}for(g=0;g<d.length;g++)this.remove(d[g]);return this};q.Graph.prototype.toNT=function(){var a="";this.forEach(function(b){a+=b.toString()});return a};q.buildRDFResource=function(a,b,e,d){return a.token==="blank"?
q.buildBlankNode(a,b,e,d):a.token==="literal"?q.buildLiteral(a,b,e,d):a.token==="uri"?q.buildNamedNode(a,b,e,d):a.token==="var"?(a=b[a.value],a!=null?q.buildRDFResource(a,b,e,d):null):null};q.buildBlankNode=function(a){if(a.valuetmp!=null)a.value=a.valuetmp;if(a.value.indexOf("_:")===0)a.value=a.value.split("_:")[1];return new q.BlankNode(a.value)};q.buildLiteral=function(a){return new q.Literal(a.value,a.lang,a.type)};q.buildNamedNode=function(a,b,e,d){if(a.value==null&&a.prefix!=null)b=e.resolveNsInEnvironment(a.prefix,
d),a.value=b+a.suffix;return new q.NamedNode(a)};q.rdf=new q.RDFEnvironment;var h={checkFilters:function(a,b,e,d,g,i){var f=a.filter,n=[];if(f==null||a.length!=null)return b;for(a=0;a<f.length;a++){for(var b=h.run(f[a].value,b,e,d,g,i),k=[],o=0;o<b.length;o++)b[o].__nullify__!=null?n.push(b[o]):k.push(b[o]);b=k}return b.concat(n)}};h.boundVars=function(a){if(a.expressionType!=null){var b=a.expressionType;if(b=="relationalexpression")return b=a.op2,h.boundVars(a.op1)+h.boundVars(b);else if(b=="conditionalor"||
b=="conditionaland"){for(var e=[],b=0;b<a.operands;b++)e=e.concat(h.boundVars(a.operands[b]));return e}else if(b=="builtincall")if(a.args==null)return[];else{e=[];for(b=0;b<a.args.length;b++)e=e.concat(h.boundVars(a.args[b]));return e}else if(b=="multiplicativeexpression"){e=h.boundVars(a.factor);for(b=0;b<a.factors.length;b++)e=e.concat(h.boundVars(a.factors[b].expression));return e}else if(b=="additiveexpression"){e=h.boundVars(a.summand);for(b=0;b<a.summands.length;b++)e=e.concat(h.boundVars(a.summands[b].expression));
return e}else if(b=="regex")return e=h.boundVars(a.expression1),e.concat(h.boundVars(a.expression2));else if(b=="unaryexpression")return h.boundVars(a.expression);else if(b=="atomic")return a.primaryexpression=="var"?[a.value]:[]}else throw console.log("ERROR"),console.log(a),"Cannot find bound expressions in a no expression token";};h.run=function(a,b,e,d,g,i){for(var f=i.copyDenormalizedBindings(b,g.outCache),n=[],k=0;k<b.length;k++){var o=h.runFilter(a,f[k],i,d,g),o=h.ebv(o);h.isEbvError(o)?e&&
(o={__nullify__:!0,bindings:b[k]},n.push(o)):o===!0?n.push(b[k]):e&&(o={__nullify__:!0,bindings:b[k]},n.push(o))}return n};h.collect=function(a,b,e,d,g){for(var i=g.copyDenormalizedBindings(b,d.outCache),f=[],n=0;n<i.length;n++){var k=h.runFilter(a,i[n],g,e,d);f.push({binding:b[n],value:k})}return f};h.runDistinct=function(){};h.runAggregator=function(a,b,e,d,g){if(b==null||b.length===0)return h.ebvError();else if(a.token==="variable"&&a.kind=="var")return b[0][a.value.value];else if(a.token==="variable"&&
a.kind==="aliased")if(a.expression.expressionType==="atomic"&&a.expression.primaryexpression==="var")return b[0][a.expression.value.value];else if(a.expression.expressionType==="aggregate")if(a.expression.aggregateType==="max"){for(var i=null,f=0;f<b.length;f++){var n=b[f],n=h.runFilter(a.expression.expression,n,e,d,g);h.isEbvError(n)||(i===null?i=n:h.runLtFunction(i,n).value===!0&&(i=n))}return i===null?h.ebvError():i}else if(a.expression.aggregateType==="min"){i=null;for(f=0;f<b.length;f++)n=b[f],
n=h.runFilter(a.expression.expression,n,e,d,g),h.isEbvError(n)||(i===null?i=n:h.runGtFunction(i,n).value===!0&&(i=n));return i===null?h.ebvError():i}else if(a.expression.aggregateType==="count"){var i={},k=0;if(a.expression.expression==="*")if(a.expression.distinct!=null&&a.expression.distinct!="")for(f=0;f<b.length;f++){var n=b[f],o=s.hashTerm(n);i[o]==null&&(i[o]=!0,k++)}else k=b.length;else for(f=0;f<b.length;f++)n=b[f],n=h.runFilter(a.expression.expression,n,e,d,g),h.isEbvError(n)||(a.expression.distinct!=
null&&a.expression.distinct!=""?(o=s.hashTerm(n),i[o]==null&&(i[o]=!0,k++)):k++);return{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:""+k}}else if(a.expression.aggregateType==="avg"){for(var i={},m={token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:"0"},f=k=0;f<b.length;f++)n=b[f],n=h.runFilter(a.expression.expression,n,e,d,g),h.isEbvError(n)||(a.expression.distinct!=null&&a.expression.distinct!=""?(o=s.hashTerm(n),i[o]==null&&(i[o]=!0,h.isNumeric(n)&&
(m=h.runSumFunction(m,n),k++))):h.isNumeric(n)&&(m=h.runSumFunction(m,n),k++));a=h.runDivFunction(m,{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:""+k});a.value=""+a.value;return a}else if(a.expression.aggregateType==="sum"){i={};m={token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:"0"};for(f=0;f<b.length;f++)n=b[f],n=h.runFilter(a.expression.expression,n,e,d,g),h.isEbvError(n)||(a.expression.distinct!=null&&a.expression.distinct!=""?(o=s.hashTerm(n),i[o]==
null&&(i[o]=!0,h.isNumeric(n)&&(m=h.runSumFunction(m,n)))):h.isNumeric(n)&&(m=h.runSumFunction(m,n)));m.value=""+m.value;return m}else return n=h.runFilter(aggregate.expression,b[0],d,{blanks:{},outCache:{}})};h.runFilter=function(a,b,e,d,g){if(a.expressionType!=null){var i=a.expressionType;if(i=="relationalexpression"){var i=h.runFilter(a.op1,b,e,d,g),f=h.runFilter(a.op2,b,e,d,g);return h.runRelationalFilter(a,i,f,b,e,d,g)}else if(i=="conditionalor")return h.runOrFunction(a,b,e,d,g);else if(i=="conditionaland")return h.runAndFunction(a,
b,e,d,g);else if(i=="additiveexpression")return h.runAddition(a.summand,a.summands,b,e,d,g);else if(i=="builtincall")return h.runBuiltInCall(a.builtincall,a.args,b,e,d,g);else if(i=="multiplicativeexpression")return h.runMultiplication(a.factor,a.factors,b,e,d,g);else if(i=="unaryexpression")return h.runUnaryExpression(a.unaryexpression,a.expression,b,e,d,g);else if(i=="irireforfunction")return h.runIriRefOrFunction(a.iriref,a.args,b,e,d,g);else if(i=="regex")return h.runRegex(a.text,a.pattern,a.flags,
b,e,d,g);else if(i=="custom")return h.runBuiltInCall(a.name,a.args,b,e,d,g);else if(i=="atomic")if(a.primaryexpression=="var")return b[a.value.value];else{if(typeof a.value=="object"&&!(a.value.type==null||typeof a.value.type!="object"))a.value.type=s.lexicalFormBaseUri(a.value.type,g);return a.value}else throw"Unknown filter expression type";}else throw"Cannot find bound expressions in a no expression token";};h.isRDFTerm=function(a){return a==null?!1:a.token&&a.token=="literal"||a.token&&a.token==
"uri"||a.token&&a.token=="blank"?!0:!1};h.RDFTermEquality=function(a,b,e,d){return a.token==="literal"&&b.token==="literal"?a.lang==b.lang&&a.type==b.type&&a.value==b.value?!0:a.type!=null&&b.type!=null?h.ebvError():h.isSimpleLiteral(a)&&b.type!=null?h.ebvError():h.isSimpleLiteral(b)&&a.type!=null?h.ebvError():!1:a.token==="uri"&&b.token==="uri"?s.lexicalFormBaseUri(a,d)==s.lexicalFormBaseUri(b,d):a.token==="blank"&&b.token==="blank"?a.value==b.value:!1};h.isInteger=function(a){return a==null?!1:
a.token==="literal"?a.type=="http://www.w3.org/2001/XMLSchema#integer"||a.type=="http://www.w3.org/2001/XMLSchema#decimal"||a.type=="http://www.w3.org/2001/XMLSchema#double"||a.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||a.type=="http://www.w3.org/2001/XMLSchema#negativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#long"||a.type=="http://www.w3.org/2001/XMLSchema#int"||a.type=="http://www.w3.org/2001/XMLSchema#short"||a.type=="http://www.w3.org/2001/XMLSchema#byte"||a.type==
"http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedLong"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedInt"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedShort"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedByte"||a.type=="http://www.w3.org/2001/XMLSchema#positiveInteger"?!0:!1:!1};h.isFloat=function(a){return a==null?!1:a.token==="literal"?a.type=="http://www.w3.org/2001/XMLSchema#float"?!0:!1:!1};h.isDecimal=function(a){return a==
null?!1:a.token==="literal"?a.type=="http://www.w3.org/2001/XMLSchema#decimal"?!0:!1:!1};h.isDouble=function(a){return a==null?!1:a.token==="literal"?a.type=="http://www.w3.org/2001/XMLSchema#double"?!0:!1:!1};h.isNumeric=function(a){return a==null?!1:a.token==="literal"?a.type=="http://www.w3.org/2001/XMLSchema#integer"||a.type=="http://www.w3.org/2001/XMLSchema#decimal"||a.type=="http://www.w3.org/2001/XMLSchema#float"||a.type=="http://www.w3.org/2001/XMLSchema#double"||a.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||
a.type=="http://www.w3.org/2001/XMLSchema#negativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#long"||a.type=="http://www.w3.org/2001/XMLSchema#int"||a.type=="http://www.w3.org/2001/XMLSchema#short"||a.type=="http://www.w3.org/2001/XMLSchema#byte"||a.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedLong"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedInt"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedShort"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedByte"||
a.type=="http://www.w3.org/2001/XMLSchema#positiveInteger"?!0:!1:!1};h.isSimpleLiteral=function(a){return a&&a.token=="literal"?a.type==null&&a.lang==null?!0:!1:!1};h.isXsdType=function(a,b){return b&&b.token=="literal"?b.type=="http://www.w3.org/2001/XMLSchema#"+a:!1};h.ebv=function(a){if(a==null||h.isEbvError(a))return h.ebvError();else if(a.token&&a.token==="literal")if(a.type=="http://www.w3.org/2001/XMLSchema#integer"||a.type=="http://www.w3.org/2001/XMLSchema#decimal"||a.type=="http://www.w3.org/2001/XMLSchema#double"||
a.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||a.type=="http://www.w3.org/2001/XMLSchema#negativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#long"||a.type=="http://www.w3.org/2001/XMLSchema#int"||a.type=="http://www.w3.org/2001/XMLSchema#short"||a.type=="http://www.w3.org/2001/XMLSchema#byte"||a.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedLong"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedInt"||a.type==
"http://www.w3.org/2001/XMLSchema#unsignedShort"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedByte"||a.type=="http://www.w3.org/2001/XMLSchema#positiveInteger"){var b=parseFloat(a.value);return isNaN(b)?!1:parseFloat(a.value)!=0}else return a.type==="http://www.w3.org/2001/XMLSchema#boolean"?a.value==="true"||a.value===!0||a.value==="True":a.type==="http://www.w3.org/2001/XMLSchema#string"?a.value!="":a.type==="http://www.w3.org/2001/XMLSchema#dateTime"?new Date(a.value)!=null:h.isEbvError(a)?
a:a.type==null?a.value!=""?!0:!1:h.ebvError();else return a.value===!0};h.effectiveBooleanValue=h.ebv;h.ebvTrue=function(){return{token:"literal",type:"http://www.w3.org/2001/XMLSchema#boolean",value:!0}};h.ebvFalse=function(){return{token:"literal",type:"http://www.w3.org/2001/XMLSchema#boolean",value:!1}};h.ebvError=function(){return{token:"literal",type:"https://github.com/antoniogarrote/js-tools/types#error",value:null}};h.isEbvError=function(a){return typeof a=="object"&&a!=null?a.type==="https://github.com/antoniogarrote/js-tools/types#error":
!1};h.ebvBoolean=function(a){return h.isEbvError(a)?a:a===!0?h.ebvTrue():h.ebvFalse()};h.runRelationalFilter=function(a,b,e,d,g,i,f){a=a.operator;if(a==="=")return h.runEqualityFunction(b,e,d,g,i,f);else if(a==="!="){b=h.runEqualityFunction(b,e,d,g,i,f);if(!h.isEbvError(b))b.value=!b.value;return b}else if(a==="<")return h.runLtFunction(b,e,d);else if(a===">")return h.runGtFunction(b,e,d);else if(a==="<=")return h.runLtEqFunction(b,e,d);else if(a===">=")return h.runGtEqFunction(b,e,d);else throw"Error applying relational filter, unknown operator";
};h.effectiveTypeValue=function(a){if(a.token=="literal")if(a.type=="http://www.w3.org/2001/XMLSchema#integer")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#decimal")return a=parseFloat(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#float")return a=parseFloat(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#double")return a=parseFloat(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger")return a=parseFloat(a.value);else if(a.type==
"http://www.w3.org/2001/XMLSchema#negativeInteger")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#long")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#int")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#short")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#byte")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger")return a=parseInt(a.value);
else if(a.type=="http://www.w3.org/2001/XMLSchema#unsignedLong")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#unsignedInt")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#unsignedShort")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#unsignedByte")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#positiveInteger")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#date"||
a.type=="http://www.w3.org/2001/XMLSchema#dateTime")try{return s.parseISO8601(a.value)}catch(b){return null}else return a.type=="http://www.w3.org/2001/XMLSchema#boolean"?a.value===!0||a.value==="true"||a.value==="1"||a.value===1||a.value===!0?!0:a.value===!1||a.value==="false"||a.value==="0"||a.value===0||a.value===!1?!1:void 0:a.type=="http://www.w3.org/2001/XMLSchema#string"?a.value===null||a.value===void 0?void 0:""+a.value:a.value;else throw console.log("not implemented yet"),console.log(a),
"value not supported in operations yet";};h.runOrFunction=function(a,b,e,d,g){for(var i=null,f=0;f<a.operands.length;f++){var n=h.runFilter(a.operands[f],b,e,d,g);h.isEbvError(n)==!1&&(n=h.ebv(n));i==null?i=n:h.isEbvError(n)?i=h.isEbvError(i)?h.ebvError():i===!0?!0:h.ebvError():n===!0?i=!0:h.isEbvError(i)&&(i=h.ebvError())}return h.ebvBoolean(i)};h.runAndFunction=function(a,b,e,d,g){for(var i=null,f=0;f<a.operands.length;f++){var n=h.runFilter(a.operands[f],b,e,d,g);h.isEbvError(n)==!1&&(n=h.ebv(n));
i==null?i=n:h.isEbvError(n)?i=h.isEbvError(i)?h.ebvError():i===!0?h.ebvError():!1:n===!0?h.isEbvError(i)&&(i=h.ebvError()):i=!1}return h.ebvBoolean(i)};h.runEqualityFunction=function(a,b,e,d,g,i){if(h.isEbvError(a)||h.isEbvError(b))return h.ebvError();if(h.isNumeric(a)&&h.isNumeric(b))return e=h.effectiveTypeValue(a),g=h.effectiveTypeValue(b),isNaN(e)||isNaN(g)?h.ebvBoolean(h.RDFTermEquality(a,b,d,i)):h.ebvBoolean(e==g);else if((h.isSimpleLiteral(a)||h.isXsdType("string",a))&&(h.isSimpleLiteral(b)||
h.isXsdType("string",b)))return h.ebvBoolean(h.effectiveTypeValue(a)==h.effectiveTypeValue(b));else if(h.isXsdType("boolean",a)&&h.isXsdType("boolean",b))return h.ebvBoolean(h.effectiveTypeValue(a)==h.effectiveTypeValue(b));else if((h.isXsdType("dateTime",a)||h.isXsdType("date",a))&&(h.isXsdType("dateTime",b)||h.isXsdType("date",b))){if(h.isXsdType("dateTime",a)&&h.isXsdType("date",b))return h.ebvFalse();if(h.isXsdType("date",a)&&h.isXsdType("dateTime",b))return h.ebvFalse();a=s.compareDateComponents(a.value,
b.value);return a!=null?a==0?h.ebvTrue():h.ebvFalse():h.ebvError()}else return h.isRDFTerm(a)&&h.isRDFTerm(b)?h.ebvBoolean(h.RDFTermEquality(a,b,d,i)):h.ebvFalse()};h.runGtFunction=function(a,b){if(h.isEbvError(a)||h.isEbvError(b))return h.ebvError();if(h.isNumeric(a)&&h.isNumeric(b))return h.ebvBoolean(h.effectiveTypeValue(a)>h.effectiveTypeValue(b));else if(h.isSimpleLiteral(a)&&h.isSimpleLiteral(b))return h.ebvBoolean(h.effectiveTypeValue(a)>h.effectiveTypeValue(b));else if(h.isXsdType("string",
a)&&h.isXsdType("string",b))return h.ebvBoolean(h.effectiveTypeValue(a)>h.effectiveTypeValue(b));else if(h.isXsdType("boolean",a)&&h.isXsdType("boolean",b))return h.ebvBoolean(h.effectiveTypeValue(a)>h.effectiveTypeValue(b));else if((h.isXsdType("dateTime",a)||h.isXsdType("date",a))&&(h.isXsdType("dateTime",b)||h.isXsdType("date",b))){if(h.isXsdType("dateTime",a)&&h.isXsdType("date",b))return h.ebvFalse();if(h.isXsdType("date",a)&&h.isXsdType("dateTime",b))return h.ebvFalse();var e=s.compareDateComponents(a.value,
b.value);return e!=null?e==1?h.ebvTrue():h.ebvFalse():h.ebvError()}else return h.ebvFalse()};h.runTotalGtFunction=function(a,b){return h.isEbvError(a)||h.isEbvError(b)?h.ebvError():h.isNumeric(a)&&h.isNumeric(b)||h.isSimpleLiteral(a)&&h.isSimpleLiteral(b)||h.isXsdType("string",a)&&h.isSimpleLiteral("string",b)||h.isXsdType("boolean",a)&&h.isSimpleLiteral("boolean",b)||h.isXsdType("dateTime",a)&&h.isSimpleLiteral("dateTime",b)?h.runGtFunction(a,b,[]):a.token&&a.token==="uri"&&b.token&&b.token==="uri"?
h.ebvBoolean(a.value>b.value):a.token&&a.token==="literal"&&b.token&&b.token==="literal"?h.ebvBoolean(""+a.value+a.type+a.lang>""+b.value+b.type+b.lang):a.token&&a.token==="blank"&&b.token&&b.token==="blank"?h.ebvBoolean(a.value>b.value):a.value&&b.value?h.ebvBoolean(a.value>b.value):h.ebvTrue()};h.runLtFunction=function(a,b){if(h.isEbvError(a)||h.isEbvError(b))return h.ebvError();if(h.isNumeric(a)&&h.isNumeric(b))return h.ebvBoolean(h.effectiveTypeValue(a)<h.effectiveTypeValue(b));else if(h.isSimpleLiteral(a)&&
h.isSimpleLiteral(b))return h.ebvBoolean(h.effectiveTypeValue(a)<h.effectiveTypeValue(b));else if(h.isXsdType("string",a)&&h.isXsdType("string",b))return h.ebvBoolean(h.effectiveTypeValue(a)<h.effectiveTypeValue(b));else if(h.isXsdType("boolean",a)&&h.isXsdType("boolean",b))return h.ebvBoolean(h.effectiveTypeValue(a)<h.effectiveTypeValue(b));else if((h.isXsdType("dateTime",a)||h.isXsdType("date",a))&&(h.isXsdType("dateTime",b)||h.isXsdType("date",b))){if(h.isXsdType("dateTime",a)&&h.isXsdType("date",
b))return h.ebvFalse();if(h.isXsdType("date",a)&&h.isXsdType("dateTime",b))return h.ebvFalse();var e=s.compareDateComponents(a.value,b.value);return e!=null?e==-1?h.ebvTrue():h.ebvFalse():h.ebvError()}else return h.ebvFalse()};h.runGtEqFunction=function(a,b){if(h.isEbvError(a)||h.isEbvError(b))return h.ebvError();if(h.isNumeric(a)&&h.isNumeric(b))return h.ebvBoolean(h.effectiveTypeValue(a)>=h.effectiveTypeValue(b));else if(h.isSimpleLiteral(a)&&h.isSimpleLiteral(b))return h.ebvBoolean(h.effectiveTypeValue(a)>=
h.effectiveTypeValue(b));else if(h.isXsdType("string",a)&&h.isXsdType("string",b))return h.ebvBoolean(h.effectiveTypeValue(a)>=h.effectiveTypeValue(b));else if(h.isXsdType("boolean",a)&&h.isXsdType("boolean",b))return h.ebvBoolean(h.effectiveTypeValue(a)>=h.effectiveTypeValue(b));else if((h.isXsdType("dateTime",a)||h.isXsdType("date",a))&&(h.isXsdType("dateTime",b)||h.isXsdType("date",b))){if(h.isXsdType("dateTime",a)&&h.isXsdType("date",b))return h.ebvFalse();if(h.isXsdType("date",a)&&h.isXsdType("dateTime",
b))return h.ebvFalse();var e=s.compareDateComponents(a.value,b.value);return e!=null?e!=-1?h.ebvTrue():h.ebvFalse():h.ebvError()}else return h.ebvFalse()};h.runLtEqFunction=function(a,b){if(h.isEbvError(a)||h.isEbvError(b))return h.ebvError();if(h.isNumeric(a)&&h.isNumeric(b))return h.ebvBoolean(h.effectiveTypeValue(a)<=h.effectiveTypeValue(b));else if(h.isSimpleLiteral(a)&&h.isSimpleLiteral(b))return h.ebvBoolean(h.effectiveTypeValue(a)<=h.effectiveTypeValue(b));else if(h.isXsdType("string",a)&&
h.isXsdType("string",b))return h.ebvBoolean(h.effectiveTypeValue(a)<=h.effectiveTypeValue(b));else if(h.isXsdType("boolean",a)&&h.isXsdType("boolean",b))return h.ebvBoolean(h.effectiveTypeValue(a)<=h.effectiveTypeValue(b));else if((h.isXsdType("dateTime",a)||h.isXsdType("date",a))&&(h.isXsdType("dateTime",b)||h.isXsdType("date",b))){if(h.isXsdType("dateTime",a)&&h.isXsdType("date",b))return h.ebvFalse();if(h.isXsdType("date",a)&&h.isXsdType("dateTime",b))return h.ebvFalse();var e=s.compareDateComponents(a.value,
b.value);return e!=null?e!=1?h.ebvTrue():h.ebvFalse():h.ebvError()}else return h.ebvFalse()};h.runAddition=function(a,b,e,d,g,i){var f=h.runFilter(a,e,d,g,i);if(h.isEbvError(f))return h.ebvError();a=f;if(h.isNumeric(f)){for(f=0;f<b.length;f++){var n=h.runFilter(b[f].expression,e,d,g,i);if(h.isNumeric(n))b[f].operator==="+"?a=h.runSumFunction(a,n):b[f].operator==="-"&&(a=h.runSubFunction(a,n));else return h.ebvFalse()}return a}else return h.ebvFalse()};h.runSumFunction=function(a,b){if(h.isEbvError(a)||
h.isEbvError(b))return h.ebvError();var e=h.effectiveTypeValue(a)+h.effectiveTypeValue(b);return h.isDouble(a)||h.isDouble(b)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",value:e}:h.isFloat(a)||h.isFloat(b)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",value:e}:h.isDecimal(a)||h.isDecimal(b)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:e}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:e}};h.runSubFunction=function(a,
b){if(h.isEbvError(a)||h.isEbvError(b))return h.ebvError();var e=h.effectiveTypeValue(a)-h.effectiveTypeValue(b);return h.isDouble(a)||h.isDouble(b)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",value:e}:h.isFloat(a)||h.isFloat(b)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",value:e}:h.isDecimal(a)||h.isDecimal(b)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:e}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:e}};
h.runMultiplication=function(a,b,e,d,g,i){a=h.runFilter(a,e,d,g,i);if(h.isEbvError(a))return a;var f=a;if(h.isNumeric(a)){for(var n=0;n<b.length;n++){var k=h.runFilter(b[n].expression,e,d,g,i);if(h.isEbvError(k))return a;if(h.isNumeric(k))b[n].operator==="*"?f=h.runMulFunction(f,k):b[n].operator==="/"&&(f=h.runDivFunction(f,k));else return h.ebvFalse()}return f}else return h.ebvFalse()};h.runMulFunction=function(a,b){if(h.isEbvError(a)||h.isEbvError(b))return h.ebvError();var e=h.effectiveTypeValue(a)*
h.effectiveTypeValue(b);return h.isDouble(a)||h.isDouble(b)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",value:e}:h.isFloat(a)||h.isFloat(b)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",value:e}:h.isDecimal(a)||h.isDecimal(b)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:e}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:e}};h.runDivFunction=function(a,b){if(h.isEbvError(a)||h.isEbvError(b))return h.ebvError();var e=
h.effectiveTypeValue(a)/h.effectiveTypeValue(b);return h.isDouble(a)||h.isDouble(b)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",value:e}:h.isFloat(a)||h.isFloat(b)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",value:e}:h.isDecimal(a)||h.isDecimal(b)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:e}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:e}};h.runBuiltInCall=function(a,b,e,d,g,i){if(a==="notexists"||a==="exists"){var f=
JSON.parse(JSON.stringify(b[0])),f=d.abstractQueryTree.parseSelect({pattern:f},e),f=d.abstractQueryTree.bind(f.pattern,e),e=d.executeSelectUnit([{kind:"*"}],g,f,i);return a==="exists"?h.ebvBoolean(e.length!==0):h.ebvBoolean(e.length===0)}else{for(var f=[],n=0;n<b.length;n++)if(b[n].token==="var")f.push(b[n]);else{var k=h.runFilter(b[n],e,d,g,i);if(h.isEbvError(k))return k;f.push(k)}if(a==="str")return f[0].token==="literal"?{token:"literal",type:null,value:""+f[0].value}:f[0].token==="uri"?{token:"literal",
type:null,value:f[0].value}:h.ebvFalse();else if(a==="lang")return f[0].token==="literal"?f[0].lang!=null?{token:"literal",value:""+f[0].lang}:{token:"literal",value:""}:h.ebvError();else if(a==="datatype")return f[0].token==="literal"?(a=f[0],a.type!=null?typeof a.type==="string"?{token:"uri",value:a.type,prefix:null,suffix:null}:a.type:a.lang==null?{token:"uri",value:"http://www.w3.org/2001/XMLSchema#string",prefix:null,suffix:null}:h.ebvError()):h.ebvError();else if(a==="isliteral")return f[0].token===
"literal"?h.ebvTrue():h.ebvFalse();else if(a==="isblank")return f[0].token==="blank"?h.ebvTrue():h.ebvFalse();else if(a==="isuri"||a==="isiri")return f[0].token==="uri"?h.ebvTrue():h.ebvFalse();else if(a==="sameterm")return a=h.RDFTermEquality(f[0],f[1],d,i),h.isEbvError(a)&&(a=!1),h.ebvBoolean(a);else if(a==="langmatches")return a=f[0],e=f[1],a.token==="literal"&&e.token==="literal"?e.value==="*"&&a.value!=""?h.ebvTrue():h.ebvBoolean(a.value.toLowerCase().indexOf(e.value.toLowerCase())===0):h.ebvError();
else if(a==="bound")return a=f[0].value,a==null?h.ebvError():e[a]!=null?h.ebvTrue():h.ebvFalse();else if(d.customFns[a]!=null)return d.customFns[a](h,f);else throw"Builtin call "+a+" not implemented yet";}};h.runUnaryExpression=function(a,b,e,d,g,i){b=h.runFilter(b,e,d,g,i);if(h.isEbvError(b))return b;if(a==="!"){var f=h.ebv(b);return h.isEbvError(f)?h.ebvFalse():h.ebvBoolean(!f)}else if(a==="+")return h.isNumeric(b)?b:h.ebvError();else if(a==="-")if(h.isNumeric(b)){a={};for(f in b)a[f]=b[f];a.value=
-a.value;return a}else return h.ebvError()};h.runRegex=function(a,b,e,d,g,i,f){if(a!=null)a=h.runFilter(a,d,g,i,f);else return h.ebvError();if(b!=null)b=h.runFilter(b,d,g,i,f);else return h.ebvError();e!=null&&(e=h.runFilter(e,d,g,i,f));if(b!=null&&b.token==="literal"&&(e==null||e.token==="literal"))b=b.value,e=e==null?null:e.value;else return h.ebvError();if(a!=null&&a.token=="var")if(d[a.value]!=null)a=d[a.value];else return h.ebvError();else if(a!=null&&a.token==="literal")if(a.type==null||h.isXsdType("string",
a))a=a.value;else return h.ebvError();else return h.ebvError();return(e==null?RegExp(b):RegExp(b,e.toLowerCase())).exec(a)?h.ebvTrue():h.ebvFalse()};h.normalizeLiteralDatatype=function(a,b,e){if(!(a.value.type==null||typeof a.value.type!="object"))a.value.type=s.lexicalFormBaseUri(a.value.type,e);return a};h.runIriRefOrFunction=function(a,b,e,d,g,i){if(b==null)return a;else{for(var f=[],n=0;n<b.length;n++)f.push(h.runFilter(b[n],e,d,g,i));a=s.lexicalFormBaseUri(a,i);if(a=="http://www.w3.org/2001/XMLSchema#integer"||
a=="http://www.w3.org/2001/XMLSchema#decimal"||a=="http://www.w3.org/2001/XMLSchema#double"||a=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||a=="http://www.w3.org/2001/XMLSchema#negativeInteger"||a=="http://www.w3.org/2001/XMLSchema#long"||a=="http://www.w3.org/2001/XMLSchema#int"||a=="http://www.w3.org/2001/XMLSchema#short"||a=="http://www.w3.org/2001/XMLSchema#byte"||a=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||a=="http://www.w3.org/2001/XMLSchema#unsignedLong"||a=="http://www.w3.org/2001/XMLSchema#unsignedInt"||
a=="http://www.w3.org/2001/XMLSchema#unsignedShort"||a=="http://www.w3.org/2001/XMLSchema#unsignedByte"||a=="http://www.w3.org/2001/XMLSchema#positiveInteger")if(f=f[0],f.token==="literal")if(f=h.normalizeLiteralDatatype(f,d,i),f.type=="http://www.w3.org/2001/XMLSchema#integer"||f.type=="http://www.w3.org/2001/XMLSchema#decimal"||f.type=="http://www.w3.org/2001/XMLSchema#double"||f.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||f.type=="http://www.w3.org/2001/XMLSchema#negativeInteger"||
f.type=="http://www.w3.org/2001/XMLSchema#long"||f.type=="http://www.w3.org/2001/XMLSchema#int"||f.type=="http://www.w3.org/2001/XMLSchema#short"||f.type=="http://www.w3.org/2001/XMLSchema#byte"||f.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||f.type=="http://www.w3.org/2001/XMLSchema#unsignedLong"||f.type=="http://www.w3.org/2001/XMLSchema#unsignedInt"||f.type=="http://www.w3.org/2001/XMLSchema#unsignedShort"||f.type=="http://www.w3.org/2001/XMLSchema#unsignedByte"||f.type=="http://www.w3.org/2001/XMLSchema#positiveInteger")return f.type=
a,f;else if(f.type=="http://www.w3.org/2001/XMLSchema#boolean")return h.ebv(f)==!0?(f.type=a,f.value=1):(f.type=a,f.value=0),f;else if(f.type=="http://www.w3.org/2001/XMLSchema#float"||f.type=="http://www.w3.org/2001/XMLSchema#double")return f.type=a,f.value=parseInt(f.value),f;else if(f.type=="http://www.w3.org/2001/XMLSchema#string"||f.type==null){if(f.value.split(".").length>2)return h.ebvError();else if(f.value.split("-").length>2)return h.ebvError();else if(f.value.split("/").length>2)return h.ebvError();
else if(f.value.split("+").length>2)return h.ebvError();if(a=="http://www.w3.org/2001/XMLSchema#decimal"&&(f.value.indexOf("e")!=-1||f.value.indexOf("E")!=-1))return h.ebvError();if(a=="http://www.w3.org/2001/XMLSchema#int"||a=="http://www.w3.org/2001/XMLSchema#integer")if(f.value.indexOf("e")!=-1||f.value.indexOf("E")!=-1||f.value.indexOf(".")!=-1)return h.ebvError();try{return f.value=parseInt(parseFloat(f.value)),isNaN(f.value)?h.ebvError():(f.type=a,f)}catch(k){return h.ebvError()}}else return h.ebvError();
else return h.ebvError();else if(a=="http://www.w3.org/2001/XMLSchema#boolean")return f=f[0],f.token==="literal"&&f.type==null?f.value==="true"||f.value==="1"?h.ebvTrue():f.value==="false"||f.value==="0"?h.ebvFalse():h.ebvError():f.token==="literal"?h.isEbvError(f)?f:h.ebvBoolean(f):h.ebvError();else if(a=="http://www.w3.org/2001/XMLSchema#string")if(f=f[0],f.token==="literal")if(f=h.normalizeLiteralDatatype(f,d,i),f.type=="http://www.w3.org/2001/XMLSchema#integer"||f.type=="http://www.w3.org/2001/XMLSchema#decimal"||
f.type=="http://www.w3.org/2001/XMLSchema#double"||f.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||f.type=="http://www.w3.org/2001/XMLSchema#negativeInteger"||f.type=="http://www.w3.org/2001/XMLSchema#long"||f.type=="http://www.w3.org/2001/XMLSchema#int"||f.type=="http://www.w3.org/2001/XMLSchema#short"||f.type=="http://www.w3.org/2001/XMLSchema#byte"||f.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||f.type=="http://www.w3.org/2001/XMLSchema#unsignedLong"||f.type=="http://www.w3.org/2001/XMLSchema#unsignedInt"||
f.type=="http://www.w3.org/2001/XMLSchema#unsignedShort"||f.type=="http://www.w3.org/2001/XMLSchema#unsignedByte"||f.type=="http://www.w3.org/2001/XMLSchema#positiveInteger"||f.type=="http://www.w3.org/2001/XMLSchema#float")return f.type=a,f.value=""+f.value,f;else if(f.type=="http://www.w3.org/2001/XMLSchema#string")return f;else if(f.type=="http://www.w3.org/2001/XMLSchema#boolean")return h.ebv(f)?(f.type=a,f.value="true"):(f.type=a,f.value="false"),f;else if(f.type=="http://www.w3.org/2001/XMLSchema#dateTime"||
f.type=="http://www.w3.org/2001/XMLSchema#date"){f.type=a;if(typeof f.value!="string")f.value=s.iso8601(f.value);return f}else return f.type==null?(f.value=""+f.value,f.type=a,f):h.ebvError();else return f.token==="uri"?{token:"literal",value:s.lexicalFormBaseUri(f,i),type:a,lang:null}:h.ebvError();else if(a=="http://www.w3.org/2001/XMLSchema#dateTime"||a=="http://www.w3.org/2001/XMLSchema#date")if(f=f[0],f.type=="http://www.w3.org/2001/XMLSchema#dateTime"||f.type=="http://www.w3.org/2001/XMLSchema#date")return f;
else if(f.type=="http://www.w3.org/2001/XMLSchema#string"||f.type==null)try{return f.value=s.iso8601(s.parseStrictISO8601(f.value)),f.type=a,f}catch(o){return h.ebvError()}else return h.ebvError();else if(a=="http://www.w3.org/2001/XMLSchema#float")if(f=f[0],f.token==="literal")if(f=h.normalizeLiteralDatatype(f,d,i),f.type=="http://www.w3.org/2001/XMLSchema#decimal"||f.type=="http://www.w3.org/2001/XMLSchema#int")return f.type=a,f.value=parseFloat(f.value),f;else if(f.type=="http://www.w3.org/2001/XMLSchema#boolean")return h.ebv(f)==
!0?(f.type=a,f.value=1):(f.type=a,f.value=0),f;else if(f.type=="http://www.w3.org/2001/XMLSchema#float"||f.type=="http://www.w3.org/2001/XMLSchema#double")return f.type=a,f.value=parseFloat(f.value),f;else if(f.type=="http://www.w3.org/2001/XMLSchema#string")try{return f.value=parseFloat(f.value),isNaN(f.value)?h.ebvError():(f.type=a,f)}catch(m){return h.ebvError()}else if(f.type==null){if(f.value.split(".").length>2)return h.ebvError();else if(f.value.split("-").length>2)return h.ebvError();else if(f.value.split("/").length>
2)return h.ebvError();else if(f.value.split("+").length>2)return h.ebvError();try{return f.value=parseFloat(f.value),isNaN(f.value)?h.ebvError():(f.type=a,f)}catch(q){return h.ebvError()}}else return h.ebvError();else return h.ebvError();else return h.ebvError()}};var A={variablesInBGP:function(a){var b=a.variables;if(b)return b;var e=a.value||a,b=[],d;for(d in e)e[d]&&e[d].token==="var"?b.push(e[d].value):e[d]&&e[d].token==="blank"&&b.push("blank:"+e[d].value);return a.variables=b},connected:function(a,
b){for(var e="/"+a.vars.join("/")+"/",d=0;d<b.vars.length;d++)if(e.indexOf("/"+b.vars[d]+"/")!=-1)return!0;return!1},variablesIntersectionBGP:function(a,b){for(var e=A.variablesInBGP(a).sort(),d=A.variablesInBGP(b).sort(),g=0,i=0,f=[];g<e.length&&i<d.length;)e[g]===d[i]?(f.push(e[g]),g++,i++):e[g]<d[i]?g++:i++;return f},executeAndBGPsGroups:function(a){for(var b={},e={},d=0,g=0;g<a.length;g++){var i=a[g],f={},h={},k=[],o;for(o in i)o!="_cost"&&(i[o].token==="var"?k.push(i[o].value):i[o].token==="blank"&&
k.push(i[o].value));var m=!1,q={},t;for(t in e){for(var s=e[t],m=!1,A=0;A<k.length;A++)if(s.indexOf("/"+k[A]+"/")!=-1){m=!0;break}m?q[t]=!0:(f[t]=b[t],h[t]=e[t])}if(m){var m=[],A=s="",y;for(y in q)s+=y,m=m.concat(b[y]),A=e[y];A=A+k.join("/")+"/";m.push(i);f[s]=m;h[s]=A}else f[d]=[i],h[d]="/"+k.join("/")+"/",d++;b=f;e=h}a=[];for(d in b)a.push(b[d]);return a},intersectionSize:function(a,b){for(var e=b.i.split("_"),d=0;d<e.length;d++)if(e[d]!=""&&a.i.indexOf("_"+e[d]+"_")!=-1)return 1;return 0},createJoinTree:function(a,
b){for(var e="/"+a.vars.join("/")+"/",d=a.vars.concat([]),g=[],i=0;i<b.vars.length;i++)e.indexOf("/"+b.vars[i]+"/")!=-1?b.vars[i].indexOf("_:")==0?g.push("blank:"+b.vars[i]):g.push(b.vars[i]):d.push(b.vars[i]);for(var f=b.i.split("_"),h=a.i.split("_"),e={},i=0;i<f.length;i++)f[i]!=""&&(e[f[i]]=!0);for(i=0;i<h.length;i++)h[i]!=""&&(e[h[i]]=!0);var i=[],k;for(k in e)i.push(k);return{left:a,right:b,cost:a.cost+b.cost,i:"_"+i.sort().join("_")+"_",vars:d,join:g}}};A.executeBushyTree=function(a,b,e,d){if(a.left==
null)return A.executeEmptyJoinBGP(a.right,b,e,d);else if(a.right==null)return A.executeEmptyJoinBGP(a.left,b,e,d);else{var g=A.executeBushyTree(a.left,b,e,d);if(g!=null)return b=A.executeBushyTree(a.right,b,e,d),b!=null?A.joinBindings2(a.join,g,b):null}};A.executeAndBGPsDPSize=function(a,b,e,d){for(var g=A.executeAndBGPsGroups(a),a=[],i=0;i<g.length;i++){var f=g[i];e.computeCosts(f,d);var h={},k={},o={},m=1,q=null,t={};o["1"]=[];for(var s=0;s<f.length;s++){var m=[],z;for(z in f[s])z!="_cost"&&(f[s][z].token===
"var"?m.push(f[s][z].value):f[s][z].token==="blank"&&m.push(f[s][z].value));k["_"+s+"_"]={left:f[s],right:null,cost:f[s]._cost,i:"_"+s+"_",vars:m};m={left:f[s],right:null,cost:f[s]._cost,i:"_"+s+"_",vars:m};h["_"+s+"_"]=m;delete f[s]._cost;t["_"+s+"_"]=!0;o["1"].push("_"+s+"_");if(q==null||q.cost>m.cost)q=m}for(var y=2;y<=f.length;y++)for(var C=1;C<y;C++)for(var D=o[""+C]||[],E=o[""+(y-C)]||[],s=0;s<D.length;s++)for(var I=0;I<E.length;I++)if(D[s]!==E[I]){var F=k[D[s]],G=k[E[I]];if(A.intersectionSize(F,
G)==0&&A.connected(F,G)&&(m=y,G=A.createJoinTree(h[F.i],h[G.i]),!t[G.i])){t[G.i]=!0;var M=G.cost+1;if(h[G.i]!=null)M=h[G.i].cost;F=o[y]||[];F.push(G.i);k[G.i]=G;o[y]=F;M>G.cost&&(m===y&&(q=G),h[G.i]=G)}}a.push(q)}F=null;for(i=0;i<a.length;i++)z=A.executeBushyTree(a[i],b,e,d),F=F==null?z:A.crossProductBindings(F,z);return F};A.executeEmptyJoinBGP=function(a,b,e,d){return A.executeBGPDatasets(a,b,e,d)};A.executeBGPDatasets=function(a,b,e,d){var g={};if(a.graph==null){for(var i=[],f=0;f<b.implicit.length;f++)if(g[b.implicit[f].oid]==
null){g[b.implicit[f].oid]=!0;a.graph=b.implicit[f];var h=e.rangeQuery(a,d),h=A.buildBindingsFromRange(h,a);i.push(h)}return a=A.unionManyBindings(i)}else if(a.graph.token==="var"){for(var k=a.graph.value,i=[],f=0;f<b.named.length;f++)if(g[b.named[f].oid]==null)if(g[b.named[f].oid]=!0,a.graph=b.named[f],h=e.rangeQuery(a,d),h!=null){for(var h=A.buildBindingsFromRange(h,a),o=0;o<h.length;o++)h[o][k]=b.named[f].oid;i.push(h)}else return null;return a=A.unionManyBindings(i||[])}else return h=e.rangeQuery(a,
d),h!=null?h=A.buildBindingsFromRange(h,a):null};A.buildBindingsFromRange=function(a,b){A.variablesInBGP(b);var e={},d=b.value||b,e={};for(k in d)d[k]&&d[k].token==="var"?e[k]=d[k].value:d[k]&&d[k].token==="blank"&&(e[k]="blank:"+d[k].value);d=[];if(a!=null)for(var g=0;g<a.length;g++){var i={},f=a[g],h=!1,k;for(k in e){var o=f[k];if(i[e[k]]==null||i[e[k]]===o)i[e[k]]=o;else{h=!0;break}}h||d.push(i)}return d};A.areCompatibleBindings=function(a,b){for(var e in a)if(b[e]!=null&&b[e]!=a[e])return!1;return!0};
A.mergeBindings=function(a,b){var e={},d;for(d in a)e[d]=a[d];for(d in b)e[d]=b[d];return e};A.joinBindings2=function(a,b,e){for(var d={},g,i,f,h,k=[],o=0;o<b.length;o++){g=b[o];h=d;for(var m=0;m<a.length;m++)i=a[m],i=g[i],m==a.length-1?(f=h[i]||[],f.push(g),h[i]=f):(f=h[i]||{},h=h[i]=f)}for(o=0;o<e.length;o++){g=e[o];h=d;for(m=0;m<a.length;m++)if(i=a[m],i=g[i],h[i]!=null)if(m==a.length-1)for(b=0;b<h[i].length;b++)k.push(A.mergeBindings(h[i][b],g));else h=h[i]}return k};A.joinBindings=function(a,
b){for(var e=[],d=0;d<a.length;d++)for(var g=a[d],i=0;i<b.length;i++){var f=b[i];A.areCompatibleBindings(g,f)&&e.push(A.mergeBindings(g,f))}return e};A.augmentMissingBindings=function(a,b){for(var e in b)a[e]==null&&(a[e]=null);return a};A.leftOuterJoinBindings=function(a,b){for(var e=[],d=0;d<a.length;d++){for(var g=a[d],i=!1,f=0;f<b.length;f++){var h=b[f];A.areCompatibleBindings(g,h)&&(i=!0,e.push(A.mergeBindings(g,h)))}i===!1&&(A.augmentMissingBindings(g,h),e.push(g))}return e};A.crossProductBindings=
function(a,b){for(var e=[],d=0;d<a.length;d++)for(var g=a[d],i=0;i<b.length;i++)e.push(A.mergeBindings(g,b[i]));return e};A.unionBindings=function(a,b){return a.concat(b)};A.unionManyBindings=function(a){for(var b=[],e=0;e<a.length;e++)b=A.unionBindings(b,a[e]);return b};var z={},$=A;z.QueryEngine=function(a){if(arguments.length!=0)this.backend=a.backend,this.lexicon=a.lexicon,this.eventsOnBatchLoad=a.eventsOnBatchLoad||!1,this.defaultPrefixes={},this.abstractQueryTree=new F.AbstractQueryTree,this.rdfLoader=
new Y.RDFLoader(a.communication),this.callbacksBackend=new E.CallbacksBackend(this),this.customFns=a.customFns||{}};z.QueryEngine.prototype.setCustomFunctions=function(a){this.customFns=a};z.QueryEngine.prototype.registerNsInEnvironment=function(a,b){var e=[];if(a!=null&&a.prefixes!=null)e=a.prefixes;var d={},g;for(g in this.defaultPrefixes)d[g]=this.defaultPrefixes[g];for(g=0;g<e.length;g++){var i=e[g];if(i.token==="prefix")d[i.prefix]=i.local}b.namespaces=d;b.base=a!=null&&a.base&&typeof a.base===
"object"?a.base.value:null};z.QueryEngine.prototype.applyModifier=function(a,b){if(a=="DISTINCT"){for(var e={},d=[],g=0;g<b.length;g++){var i=b[g],f="",h;for(h in i){var k=i[h];k==null?f=f+h+"null":k.token=="literal"?(k.value!=null&&(f+=k.value),k.lang!=null&&(f+=k.lang),k.type!=null&&(f+=k.type)):f=k.value?f+h+k.value:f+h+k}e[f]==null&&(d.push(i),e[f]=!0)}return d}else return b};z.QueryEngine.prototype.applyLimitOffset=function(a,b,e){if(b==null&&a==null)return e;a==null&&(a=0);b=b==null?e.length:
a+b;return e.slice(a,b)};z.QueryEngine.prototype.applySingleOrderBy=function(a,b,e,d){for(var g=[],i=0;i<a.length;i++){var f=h.collect(a[i].expression,[b],e,d,this);g.push(f[0].value)}return{binding:b,value:g}};z.QueryEngine.prototype.applyOrderBy=function(a,b,e,d){var g=this,i=[];if(a!=null&&a.length>0){for(var f=0;f<b.length;f++){var h=g.applySingleOrderBy(a,b[f],e,d);i.push(h)}i.sort(function(b,e){return g.compareFilteredBindings(b,e,a,d)});b=[];for(f=0;f<i.length;f++)b.push(i[f].binding)}return b};
z.QueryEngine.prototype.compareFilteredBindings=function(a,b,e,d){for(var g=0;;){if(g==a.value.length)return 0;var i=e[g].direction;if(a.value[g]==null&&b.value[g]==null)g++;else{if(a.value[g]==null)a={value:!1};else if(b.value[g]==null)a={value:!0};else if(a.value[g].token==="blank"&&b.value[g].token==="blank"){g++;continue}else if(a.value[g].token==="blank")a={value:!1};else if(b.value[g].token==="blank")a={value:!0};else if(a.value[g].token==="uri"&&b.value[g].token==="uri")if(h.runEqualityFunction(a.value[g],
b.value[g],[],this,d).value==!0){g++;continue}else a=h.runTotalGtFunction(a.value[g],b.value[g],[]);else if(a.value[g].token==="uri")a={value:!1};else if(b.value[g].token==="uri")a={value:!0};else if(a.value[g].token==="literal"&&b.value[g].token==="literal"&&a.value[g].type==null&&b.value[g].type==null)if(h.runEqualityFunction(a.value[g],b.value[g],[],this,d).value==!0){g++;continue}else a=h.runTotalGtFunction(a.value[g],b.value[g],[]);else if(a.value[g].token==="literal"&&a.value[g].type==null)a=
{value:!1};else if(b.value[g].token==="literal"&&b.value[g].type==null)a={value:!0};else if(h.runEqualityFunction(a.value[g],b.value[g],[],this,d).value==!0){g++;continue}else a=h.runTotalGtFunction(a.value[g],b.value[g],[]);return a.value==!0?i==="ASC"?1:-1:i==="ASC"?-1:1}}};z.QueryEngine.prototype.removeDefaultGraphBindings=function(a,b){for(var e=[],d={},g=0;g<b.named.length;g++)d[b.named[g].oid]=!0;for(g=0;g<b.implicit.length;g++)d[b.implicit[g].oid]==null&&e.push(b.implicit[g].oid);e=[];for(g=
0;g<a.length;g++){var i=a[g],f=!1,h;for(h in i){for(var k=0;k<d.length;k++)if(i[h]===d[k]){f=!0;break}if(f)break}f||e.push(i)}return e};z.QueryEngine.prototype.aggregateBindings=function(a,b,e,d){for(var b=this.copyDenormalizedBindings(b,d.outCache),g={},i=0;i<a.length;i++){var f=h.runAggregator(a[i],b,this,e,d);a[i].alias?g[a[i].alias.value]=f:g[a[i].value.value]=f}return g};z.QueryEngine.prototype.projectBindings=function(a,b,e){if(a[0].kind==="*")return b;else{for(var d=[],g=0;g<b.length;g++){for(var i=
b[g],f={},n=!0,k=0;k<a.length;k++)if(a[k].token=="variable"&&a[k].kind!="aliased")f[a[k].value.value]=i[a[k].value.value];else if(a[k].token=="variable"&&a[k].kind=="aliased"){var o=h.runFilter(a[k].expression,i,this,e,{blanks:{},outCache:{}});if(h.isEbvError(o)){n=!1;break}else f[a[k].alias.value]=o}n===!0&&d.push(f)}return d}};z.QueryEngine.prototype.resolveNsInEnvironment=function(a,b){return b.namespaces[a]};z.QueryEngine.prototype.termCost=function(a,b){if(a.token==="uri"){var e=s.lexicalFormBaseUri(a,
b);return e==null?0:this.lexicon.resolveUriCost(e)}else return a.token==="literal"?this.lexicon.resolveLiteralCost(s.lexicalFormLiteral(a,b)):a.token==="blank"?this.lexicon.resolveBlankCost(a.value):a.token==="var"?this.lexicon.oidCounter/3:null};z.QueryEngine.prototype.normalizeTerm=function(a,b,e){if(a.token==="uri")return b=s.lexicalFormBaseUri(a,b),b==null?null:e?this.lexicon.registerUri(b):this.lexicon.resolveUri(b);else if(a.token==="literal")return b=s.lexicalFormLiteral(a,b),a=e?this.lexicon.registerLiteral(b):
this.lexicon.resolveLiteral(b);else if(a.token==="blank"){var d=a.value,a=b.blanks[d];a==null&&(a=e?this.lexicon.registerBlank(d):this.lexicon.resolveBlank(d),b.blanks[d]=a);return a}else return a.token==="var"?a.value:null};z.QueryEngine.prototype.normalizeDatasets=function(a,b){for(var e=0;e<a.length;e++){var d=a[e];if(d.value===this.lexicon.defaultGraphUri)d.oid=this.lexicon.defaultGraphOid;else{var g=this.normalizeTerm(d,b,!1);if(g!=null)d.oid=g;else return null}}return!0};z.QueryEngine.prototype.normalizeQuad=
function(a,b,e){var d=null,g=null,i=d=null,f;if(a.graph==null)i=0;else if(f=this.normalizeTerm(a.graph,b,e),f!=null)i=f,e===!0&&a.graph.token!="var"&&this.lexicon.registerGraph(f);else return null;f=this.normalizeTerm(a.subject,b,e);if(f!=null)d=f;else return null;f=this.normalizeTerm(a.predicate,b,e);if(f!=null)g=f;else return null;f=this.normalizeTerm(a.object,b,e);return f==null?null:{subject:d,predicate:g,object:f,graph:i}};z.QueryEngine.prototype.quadCost=function(a,b){var e=null,d=null,g=null,
i=null,i=a.graph==null?this.lexicon.oidCounter/4:this.termCost(a.graph,b),e=this.termCost(a.subject,b),d=this.termCost(a.predicate,b),g=this.termCost(a.object,b);return i+e+d+g};z.QueryEngine.prototype.denormalizeBindingsList=function(a,b){for(var e=[],d=0;d<a.length;d++){var g=this.denormalizeBindings(a[d],b);e.push(g)}return e};z.QueryEngine.prototype.copyDenormalizedBindings=function(a,b){for(var e=[],d=0;d<a.length;d++){for(var g={},i=a[d],f=s.keys(i),h=0;h<f.length;h++){var k=i[f[h]];if(k==null)g[f[h]]=
null;else if(typeof k==="object")g[f[h]]=k;else{var o=b[k];o==null&&(o=this.lexicon.retrieve(k),b[k]=o);g[f[h]]=o}}e.push(g)}return e};z.QueryEngine.prototype.denormalizeBindings=function(a,b){for(var e=s.keys(a),d=b.outCache,g=0;g<e.length;g++){var i=a[e[g]];if(i==null)a[e[g]]=null;else if(d[i]!=null)a[e[g]]=d[i];else{var f=this.lexicon.retrieve(i);a[e[g]]=f;f.token==="blank"&&(b.blanks[f.value]=i)}}return a};z.QueryEngine.prototype.execute=function(a,b,e,d){a=s.normalizeUnicodeLiterals(a);a=this.abstractQueryTree.parseQueryString(a);
if(a==null)b(!1,"Error parsing query string");else if(a.token==="query"&&a.kind=="update"){this.callbacksBackend.startGraphModification();var g=this;this.executeUpdate(a,function(a,d){g.lexicon.updateAfterWrite&&g.lexicon.updateAfterWrite();a?g.callbacksBackend.endGraphModification(function(){b(a,d)}):(g.callbacksBackend.cancelGraphModification(),b(a,d))})}else a.token==="query"&&a.kind=="query"&&this.executeQuery(a,b,e,d)};z.QueryEngine.prototype.executeQuery=function(a,b,e,d){var g=a.units,i=this,
f={blanks:{},outCache:{}};this.registerNsInEnvironment(a.prologue,f);var h=i.abstractQueryTree.parseExecutableUnit(g[0]);if(h.kind==="select")this.executeSelect(h,f,e,d,function(a,d){a?typeof d==="object"&&d.denorm===!0?b(!0,d.bindings):(d=i.denormalizeBindingsList(d,f),d!=null?b(!0,d):b(!1,d)):b(!1,d)});else if(h.kind==="ask")h.projection=[{token:"variable",kind:"*"}],this.executeSelect(h,f,e,d,function(a,d){a?a?d.length>0?b(!0,!0):b(!0,!1):b(!1,d):b(!1,d)});else if(h.kind==="construct")h.projection=
[{token:"variable",kind:"*"}],i=this,this.executeSelect(h,f,e,d,function(a,d){if(a)if(a)if(d=i.denormalizeBindingsList(d,f),d!=null){var e=new q.Graph;if(h.template==null)h.template={triplesContext:h.pattern};for(var g=1,t=[],s=0;s<d.length;s++){for(var A=d[s],y=0;y<t.length;y++)delete t[y].valuetmp;for(y=0;y<h.template.triplesContext.length;y++){for(var z=["subject","predicate","object"],C=h.template.triplesContext[y],D=0;D<z.length;D++){var E=z[D];if(C[E].token==="blank"&&!(C[E].valuetmp&&C[E].valuetmp!=
null)){var F="_:b"+g;g++;C[E].valuetmp=F;t.push(C[E])}}z=q.buildRDFResource(C.subject,A,i,f);D=q.buildRDFResource(C.predicate,A,i,f);C=q.buildRDFResource(C.object,A,i,f);z!=null&&D!=null&&C!=null&&(D=new q.Triple(z,D,C),e.add(D))}}b(!0,e)}else b(!1,d);else b(!1,d);else b(!1,d)})};z.QueryEngine.prototype.executeSelect=function(a,b,e,d,g){if(a.kind==="select"||a.kind==="ask"||a.kind==="construct"||a.kind==="modify"){var i=a.projection,f=a.dataset,h=a.modifier,k=a.limit,o=a.offset,m=a.order;if(e!=null||
d!=null)f.implicit=e||[],f.named=d||[];f.implicit!=null&&f.implicit.length===0&&f.named!=null&&f.named.length===0&&f.implicit.push(this.lexicon.defaultGraphUriTerm);if(this.normalizeDatasets(f.implicit.concat(f.named),b)!=null)if(d=this.executeSelectUnit(i,f,a.pattern,b),d!=null){if(a.group!=null&&a.group===""){for(var q=!1,e=0;e<a.projection.length;e++)if(a.projection[e].expression!=null&&a.projection[e].expression.expressionType==="aggregate"){q=!0;break}if(q===!0)a.group="singleGroup"}if(a.group&&
a.group!="")if(this.checkGroupSemantics(a.group,i)){k=this.groupSolution(d,a.group,f,b);o=[];for(e=0;e<k.length;e++)h=this.aggregateBindings(i,k[e],f,b),o.push(h);g(!0,{bindings:o,denorm:!0})}else g(!1,"Incompatible Group and Projection variables");else b=this.applyOrderBy(m,d,f,b),i=this.projectBindings(i,b,f),i=this.applyModifier(h,i),f=this.removeDefaultGraphBindings(this.applyLimitOffset(o,k,i),f),g(!0,f)}else g(!1,d);else g(!1,"Error normalizing datasets")}else g(!1,"Cannot execute "+a.kind+
" query as a select query")};z.QueryEngine.prototype.groupSolution=function(a,b,e,d){var g=[],i=[],f=!1;if(b==="singleGroup")return[a];else{for(var n=0;n<a.length;n++){for(var k=a[n],o=!0,m=0;m<b.length;m++){var q=b[m],t=null;if(q.token==="var")t=q.value,f==!1&&g.push(t);else if(q.token==="aliased_expression")if(t=q.alias.value,f==!1&&g.push(t),q.expression.primaryexpression==="var")k[q.alias.value]=k[q.expression.value.value];else if(t=this.copyDenormalizedBindings([k],d.outCache),t=h.runFilter(q.expression,
t[0],this,e,d),h.isEbvError(t))o=!1;else{if(t.value!=null)t.value=""+t.value;k[q.alias.value]=t}else t=this.copyDenormalizedBindings([k],d.outCache),t=h.runFilter(q,t[0],this,d),h.isEbvError(t)?o=!1:(k["groupCondition"+env._i]=t,t="groupCondition"+env._i,f==!1&&g.push(t))}f==!1&&(f=!0);o===!0&&i.push(k)}a={};for(n=0;n<i.length;n++){b=i[n];e="";for(m=0;m<g.length;m++)d=b[g[m]],e+=typeof d==="object"?d.value:d;a[e]==null?a[e]=[b]:a[e].push(b)}var g=[],s;for(s in a)g.push(a[s]);return g}};z.QueryEngine.prototype.executeSelectUnit=
function(a,b,e,d){return e.kind==="BGP"?this.executeAndBGP(a,b,e,d):e.kind==="UNION"?this.executeUNION(a,b,e.value,d):e.kind==="JOIN"?this.executeJOIN(a,b,e,d):e.kind==="LEFT_JOIN"?this.executeLEFT_JOIN(a,b,e,d):e.kind==="FILTER"?(a=this.executeSelectUnit(a,b,e.value,d),a!=null?a=h.checkFilters(e,a,!1,b,d,this):[]):e.kind==="EMPTY_PATTERN"?[]:e.kind==="ZERO_OR_MORE_PATH"||e.kind==="ONE_OR_MORE_PATH"?this.executeZeroOrMorePath(e,b,d):(console.log("Cannot execute query pattern "+e.kind+". Not implemented yet."),
null)};z.QueryEngine.prototype.executeZeroOrMorePath=function(a,b,e){var d=[];a.x.token==="var"&&d.push({token:"variable",kind:"var",value:a.x.value});a.y.token==="var"&&d.push({token:"variable",kind:"var",value:a.y.value});d.length===0&&d.push({token:"variable",kind:"*"});if(a.x.token==="var"&&a.y.token==="var"){var g=this.executeAndBGP(d,b,a.path,e),i={},d=[],f,h,k,o,m=a.x.value;h=a.x;for(var q=a.path,t=0;t<g.length;t++)if(f=g[t][m],i[f]==null){o=this.lexicon.retrieve(f);a.x=o;a.path=this.abstractQueryTree.replace(q,
h,o,e);q=s.clone(a.path);h=this.executeZeroOrMorePath(a,b,e);for(var A=0;A<h.length;A++)k=h[A],k[m]=f,d.push(k);h=o}return d}else if(a.x.token!=="var"&&a.y.token==="var"){i={};f=!0;o=[];for(m=[];f==!0||o.length!==0;){f===!0?(g=this.executeAndBGP(d,b,a.path,e),h=a.x,f=!1):(q=this.lexicon.retrieve(o.pop()),g=a.path,g=this.abstractQueryTree.replace(g,h,q,e),g=this.executeAndBGP(d,b,g,e),h=q);for(t=0;t<g.length;t++)q=g[t][a.y.value],i[q]!==!0&&(k={},k[a.y.value]=q,m.push(k),i[q]=!0,o.push(q))}return m}else throw"Kind of path not supported!";
};z.QueryEngine.prototype.executeUNION=function(a,b,e,d){var g=e[0],i=e[1],f=null,n=null;if(e.length!=2)throw"SPARQL algebra UNION with more than two components";f=this.executeSelectUnit(a,b,g,d);if(f==null)return null;n=this.executeSelectUnit(a,b,i,d);if(n==null)return null;a=$.unionBindings(f,n);return a=h.checkFilters(e,a,!1,b,d,this)};z.QueryEngine.prototype.executeAndBGP=function(a,b,e,d){a=$.executeAndBGPsDPSize(e.value,b,this,d);return a!=null?h.checkFilters(e,a,!1,b,d,this):null};z.QueryEngine.prototype.executeLEFT_JOIN=
function(a,b,e,d){var g=e.rvalue,i=null,f=null,i=this.executeSelectUnit(a,b,e.lvalue,d);if(i==null)return null;f=this.executeSelectUnit(a,b,g,d);if(f==null)return null;a=$.leftOuterJoinBindings(i,f);b=h.checkFilters(e,a,!0,b,d,this);if(i.length>1&&f.length>1){var e=[],d={},n;for(n in i[0])d[n]=!0;for(n in f[0])d[n]!=!0&&e.push(n);i=[];f={};for(d=0;d<b.length;d++)if(b[d].__nullify__===!0){for(g=0;g<e.length;g++)b[d].bindings[e[g]]=null;g=[];a=[];for(n in b[d].bindings)b[d].bindings[n]!=null&&(g.push(n+
b[d].bindings[n]),g.sort(),a.push(g.join("")));if(f[g.join("")]==null){for(g=0;g<a.length;g++)f[a[g]]=!0;i.push(b[d].bindings)}}else for(n in i.push(b[d]),g=[],b[d])g.push(n+b[d][n]),g.sort(),f[g.join("")]=!0;return i}else return b};z.QueryEngine.prototype.executeJOIN=function(a,b,e,d){var g=e.lvalue,i=e.rvalue,f=null,n=null,f=this.executeSelectUnit(a,b,g,d);if(f==null)return null;n=this.executeSelectUnit(a,b,i,d);if(n==null)return null;a=null;if(f.length===0||n.length===0)a=[];else{var a={},k=[],
o;for(o in f[0])a[o]=!1;for(o in n[0])a[o]===!1&&k.push(o);a=k.length==0?$.joinBindings(f,n):this.abstractQueryTree.treeWithUnion(g)||this.abstractQueryTree.treeWithUnion(i)?$.joinBindings(f,n):$.joinBindings2(k,f,n)}return a=h.checkFilters(e,a,!1,b,d,this)};z.QueryEngine.prototype.rangeQuery=function(a,b){var e=this.normalizeQuad(a,b,!1);return e!=null?(e=this.backend.range(new T.Pattern(e)),e==null||e.length==0?[]:e):(console.log("ERROR normalizing quad"),null)};z.QueryEngine.prototype.executeUpdate=
function(a,b){var e=a.units,d=this,g={blanks:{},outCache:{}};this.registerNsInEnvironment(a.prologue,g);for(var i=0;i<e.length;i++){var f=d.abstractQueryTree.parseExecutableUnit(e[i]);if(f.kind==="insertdata"){for(var h=0;h<f.quads.length;h++){var k=f.quads[h];if(d._executeQuadInsert(k,g)!==!0)return b(!1,error)}b(!0)}else if(f.kind==="deletedata"){for(h=0;h<f.quads.length;h++)k=f.quads[h],this._executeQuadDelete(k,g);b(!0)}else if(f.kind==="modify")this._executeModifyQuery(f,g,b);else if(f.kind===
"create")b(!0);else if(f.kind==="load")h={uri:s.lexicalFormBaseUri(f.sourceGraph,g)},f.destinyGraph!=null&&(h={uri:s.lexicalFormBaseUri(f.destinyGraph,g)}),d=this,this.rdfLoader.load(f.sourceGraph.value,h,function(a,e){a==!1?(console.log("Error loading graph"),console.log(e),b(!1,"error batch loading quads")):(e=d.batchLoad(e),b(e!=null,e||"error batch loading quads"))});else if(f.kind==="drop")this._executeClearGraph(f.destinyGraph,g,b);else if(f.kind==="clear")this._executeClearGraph(f.destinyGraph,
g,b);else throw Error("not supported execution unit");}};z.QueryEngine.prototype.batchLoad=function(a,b){var e=null,d=null,g=null,i=null,f=0,h=!0,k={},o,m;this.eventsOnBatchLoad&&this.callbacksBackend.startGraphModification();for(var q=0;q<a.length;q++){m=a[q];if(m.subject.uri||m.subject.token==="uri"){if(o=this.lexicon.registerUri(m.subject.uri||m.subject.value),m.subject.uri!=null)m.subject={token:"uri",value:m.subject.uri},delete m.subject.uri}else if(m.subject.literal||m.subject.token==="literal"){if(o=
this.lexicon.registerLiteral(m.subject.literal||m.subject.value),m.subject.literal!=null)m.subject=this.lexicon.parseLiteral(m.subject.literal),delete m.subject.literal}else if(o=k[m.subject.blank||m.subject.value],o==null&&(o=this.lexicon.registerBlank(m.subject.blank||m.subject.value),k[m.subject.blank||m.subject.value]=o),m.subject.token==null)m.subject.token="blank",m.subject.value=m.subject.blank,delete m.subject.blank;e=o;if(m.predicate.uri||m.predicate.token==="uri"){if(o=this.lexicon.registerUri(m.predicate.uri||
m.predicate.value),m.predicate.uri!=null)m.predicate={token:"uri",value:m.predicate.uri},delete m.subject.uri}else if(m.predicate.literal||m.predicate.token==="literal"){if(o=this.lexicon.registerLiteral(m.predicate.literal||m.predicate.value),m.predicate.literal!=null)m.predicate=this.lexicon.parseLiteral(m.predicate.literal),delete m.predicate.literal}else if(o=k[m.predicate.blank||m.predicate.value],o==null&&(o=this.lexicon.registerBlank(m.predicate.blank||m.predicate.value),k[m.predicate.blank||
m.predicate.value]=o),m.predicate.token==null)m.predicate.token="blank",m.predicate.value=m.predicate.blank,delete m.predicate.blank;d=o;if(m.object.uri||m.object.token==="uri"){if(o=this.lexicon.registerUri(m.object.uri||m.object.value),m.object.uri!=null)m.object={token:"uri",value:m.object.uri},delete m.subject.uri}else if(m.object.literal||m.object.token==="literal"){if(m.object.token==="literal")m.object.value=m.object.type!=null?'"'+m.object.value+'"^^<'+m.object.type+">":m.object.lang!=null?
'"'+m.object.value+'"@'+m.object.lang:'"'+m.object.value+'"';o=this.lexicon.registerLiteral(m.object.literal||m.object.value);if(m.object.literal!=null)m.object=this.lexicon.parseLiteral(m.object.literal),delete m.object.literal}else if(o=k[m.object.blank||m.object.value],o==null&&(o=this.lexicon.registerBlank(m.object.blank||m.object.value),k[m.object.blank||m.object.value]=o),m.object.token==null)m.object.token="blank",m.object.value=m.object.blank,delete m.object.blank;g=o;if(m.graph.uri||m.graph.token===
"uri"){o=this.lexicon.registerUri(m.graph.uri||m.graph.value);if(m.graph.uri!=null)m.graph={token:"uri",value:m.graph.uri},delete m.subject.uri;this.lexicon.registerGraph(o)}else if(m.graph.literal||m.graph.token==="literal"){if(o=this.lexicon.registerLiteral(m.graph.literal||m.graph.value),m.predicate.literal!=null)m.predicate=this.lexicon.parseLiteral(m.predicate.literal),delete m.predicate.literal}else if(o=k[m.graph.blank||m.graph.value],o==null&&(o=this.lexicon.registerBlank(m.graph.blank||m.graph.value),
k[m.graph.blank||m.graph.value]=o),m.graph.token==null)m.graph.token="blank",m.graph.value=m.graph.blank,delete m.graph.blank;i=o;o=m;m={subject:e,predicate:d,object:g,graph:i};e=new T.NodeKey(m);d=this.backend.search(e);if(!d)if(d=this.backend.index(e),d==!0)this.eventsOnBatchLoad&&this.callbacksBackend.nextGraphModification(E.added,[o,m]),f+=1;else{h=!1;break}}this.lexicon.updateAfterWrite!=null&&this.lexicon.updateAfterWrite();var t=function(){h?b&&b(!0,f):b&&b(!1,null)};this.eventsOnBatchLoad?
this.callbacksBackend.endGraphModification(function(){t()}):t();return h?f:null};z.QueryEngine.prototype.computeCosts=function(a,b){for(var e=0;e<a.length;e++)a[e]._cost=this.quadCost(a[e],b);return a};z.QueryEngine.prototype._executeModifyQuery=function(a,b,e){var d=this,g=!0,i=null,f=["subject","predicate","object","graph"];a.insert=a.insert==null?[]:a.insert;a["delete"]=a["delete"]==null?[]:a["delete"];s.seq(function(e){var f=[],h=[];a["with"]!=null&&f.push(a["with"]);if(a.using!=null)for(var h=
[],m=0;m<a.using.length;m++){var q=a.using[m];q.kind==="named"?h.push(q.uri):f.push(q.uri)}a.dataset={};a.projection=[{token:"variable",kind:"*"}];d.executeSelect(a,b,f,h,function(a,f){a?(f=d.denormalizeBindingsList(f,b),f!=null?i=f:g=!1):g=!1;return e()})},function(e){var h=a["with"];if(g){for(var o=[],m=0;m<a["delete"].length;m++)for(var q=a["delete"][m],t=0;t<i.length;t++){for(var s={},A=i[t],y=0;y<f.length;y++){var z=f[y];z=="graph"&&q[z]==null?s.graph=h:s[z]=q[z].token==="var"?A[q[z].value]:
q[z]}o.push(s)}for(t=0;t<o.length;t++)s=o[t],d._executeQuadDelete(s,b)}e()},function(e){var h=a["with"];if(g){for(var o=[],m=0;m<a.insert.length;m++)for(var q=a.insert[m],t=0;t<i.length;t++){for(var s={},A=i[t],y=0;y<f.length;y++){var z=f[y];z=="graph"&&q[z]==null?s.graph=h:s[z]=q[z].token==="var"?A[q[z].value]:q[z]}o.push(s)}for(m=0;m<o.length;m++)s=o[m],d._executeQuadInsert(s,b)}e()})(function(){e(g)})};z.QueryEngine.prototype._executeQuadInsert=function(a,b){var e=this.normalizeQuad(a,b,!0);if(e!=
null){var d=new T.NodeKey(e),g=this.backend.search(d);return g?g:(g=this.backend.index(d),g==!0?(this.callbacksBackend.nextGraphModification(E.added,[a,e]),!0):(console.log("ERROR inserting quad"),!1))}else return console.log("ERROR normalizing quad"),!1};z.QueryEngine.prototype._executeQuadDelete=function(a,b){var e=this.normalizeQuad(a,b,!1);if(e!=null){var d=new T.NodeKey(e);this.backend["delete"](d);return this.lexicon.unregister(a,d)==!0?(this.callbacksBackend.nextGraphModification(E.deleted,
[a,e]),!0):(console.log("ERROR unregistering quad"),!1)}else return console.log("ERROR normalizing quad"),!1};z.QueryEngine.prototype._executeClearGraph=function(a,b,e){if(a==="default")this.execute("DELETE { ?s ?p ?o } WHERE { ?s ?p ?o }",e);else if(a==="named"){var d=this,g=this.lexicon.registeredGraphs(!0);if(g!=null){var i=!1;s.repeat(0,g.length,function(a,b){var e=g[b._i],h=arguments.callee;i?a(h,b):d.execute("DELETE { GRAPH <"+e+"> { ?s ?p ?o } } WHERE { GRAPH <"+e+"> { ?s ?p ?o } }",function(d){i=
!d;a(h,b)})},function(){e(!i)})}else e(!1,"Error deleting named graphs")}else a==="all"?(d=this,this.execute("CLEAR DEFAULT",function(a,b){a?d.execute("CLEAR NAMED",e):e(!1,b)})):a.token=="uri"?(a=s.lexicalFormBaseUri(a,b),a!=null?this.execute("DELETE { GRAPH <"+a+"> { ?s ?p ?o } } WHERE { GRAPH <"+a+"> { ?s ?p ?o } }",e):e(!1,"wrong graph URI")):e(!1,"wrong graph URI")};z.QueryEngine.prototype.checkGroupSemantics=function(a,b){if(a==="singleGroup")return!0;for(var e={},d=0;d<a.length;d++){var g=
a[d];g.token==="var"?e[g.value]=!0:g.token==="aliased_expression"&&(e[g.alias.value]=!0)}for(d=0;d<b.length;d++)if(g=b[d],g.kind==="var"){if(e[g.value.value]==null)return!1}else if(g.kind==="aliased"&&g.expression&&g.expression.primaryexpression==="var"&&e[g.expression.value.value]==null)return!1;return!0};z.QueryEngine.prototype.registerDefaultNamespace=function(a,b){this.defaultPrefixes[a]=b};var E={ANYTHING:{token:"var",value:"_"},added:"added",deleted:"deleted",eventsFlushed:"eventsFlushed",CallbacksBackend:function(a){this.aqt=
new F.AbstractQueryTree;this.engine=a;this.indexMap={};this.observersMap={};this.queriesIndexMap={};this.emptyNotificationsMap={};this.queriesList=[];this.pendingQueries=[];this.matchedQueries=[];this.updateInProgress=null;this.indices=["SPOG","GP","OGS","POG","GSP","OS"];this.componentOrders={SPOG:["subject","predicate","object","graph"],GP:["graph","predicate","subject","object"],OGS:["object","graph","subject","predicate"],POG:["predicate","object","graph","subject"],GSP:["graph","subject","predicate",
"object"],OS:["object","subject","predicate","graph"]};this.callbackCounter=0;this.callbacksMap={};this.callbacksInverseMap={};this.queryCounter=0;this.queriesMap={};this.queriesCallbacksMap={};this.queriesInverseMap={};for(a=0;a<this.indices.length;a++){var b=this.indices[a];this.indexMap[b]={};this.queriesIndexMap[b]={}}}};E.CallbacksBackend.prototype.startGraphModification=function(){this.pendingQueries=[].concat(this.queriesList);this.matchedQueries=[];if(this.updateInProgress==null)this.updateInProgress=
{added:[],deleted:[]}};E.CallbacksBackend.prototype.nextGraphModification=function(a,b){this.updateInProgress[a].push(b)};E.CallbacksBackend.prototype.endGraphModification=function(a){var b=this;if(this.updateInProgress!=null){var e=b.updateInProgress;b.updateInProgress=null;this.sendNotification(E.deleted,e[E.deleted],function(){b.sendNotification(E.added,e[E.added],function(){b.sendEmptyNotification(E.eventsFlushed,null,function(){b.dispatchQueries(function(){a(!0)})})})})}else a(!0)};E.CallbacksBackend.prototype.cancelGraphModification=
function(){this.updateInProgress=null};E.CallbacksBackend.prototype.sendNotification=function(a,b,e){for(var d={},g=0;g<b.length;g++){var i=b[g],f;for(f in this.indexMap){var h=this.indexMap[f],k=this.componentOrders[f];this._searchCallbacksInIndex(h,k,a,i,d);this.pendingQueries.length!=0&&(h=this.queriesIndexMap[f],this._searchQueriesInIndex(h,k,i))}}this.dispatchNotifications(d);e!=null&&e(!0)};E.CallbacksBackend.prototype.sendEmptyNotification=function(a,b,e){for(var d=this.emptyNotificationsMap[a]||
[],g=0;g<d.length;g++)d[g](a,b);e()};E.CallbacksBackend.prototype.dispatchNotifications=function(a){for(var b in a){var e=this.callbacksMap[b],d=a[b][E.deleted];if(d!=null)try{e(E.deleted,d)}catch(g){}for(var i in a[b])if(i!=E.deleted)try{e(i,a[b][i])}catch(f){}}};E.CallbacksBackend.prototype._searchCallbacksInIndex=function(a,b,e,d,g){for(var i=d[1],d=d[0],f=0;f<b.length+1;f++){for(var h=a._||[],k=[],o=0;o<h.length;o++){var m=h[o];this.callbacksMap[m]!=null&&(g[m]=g[m]||{},g[m][e]=g[m][e]||[],g[m][e].push(d),
k.push(m))}a._=k;h=b[f];if(a[""+i[h]]!=null)a=a[""+i[h]];else break}};E.CallbacksBackend.prototype.subscribeEmpty=function(a,b){var e=this.emptyNotificationsMap[a]||[];e.push(b);this.emptyNotificationsMap[a]=e};E.CallbacksBackend.prototype.unsubscribeEmpty=function(a,b){var e=this.emptyNotificationsMap[a];e!=null&&(e=s.remove(e,b));this.emptyNotificationsMap[a]=e};E.CallbacksBackend.prototype.subscribe=function(a,b,e,d,g,i){a=this._tokenizeComponents(a,b,e,d);b={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,
b);a=this.engine.normalizeQuad(a,b,!0);e=this._indexForPattern(new T.Pattern(a));b=this.componentOrders[e];e=this.indexMap[e];for(d=0;d<b.length;d++){var f=a[b[d]];if(f==="_"){e._==null&&(e._=[]);this.callbackCounter++;e._.push(this.callbackCounter);this.callbacksMap[this.callbackCounter]=g;this.callbacksInverseMap[g]=this.callbackCounter;break}else d===b.length-1?(e[f]=e[f]||{_:[]},this.callbackCounter++,e[f]._.push(this.callbackCounter),this.callbacksMap[this.callbackCounter]=g,this.callbacksInverseMap[g]=
this.callbackCounter):(e[f]=e[f]||{},e=e[f])}i!=null&&i(!0)};E.CallbacksBackend.prototype.unsubscribe=function(a){var b=this.callbacksInverseMap[a];b!=null&&(delete this.callbacksInverseMap[a],delete this.callbacksMap[b])};E.CallbacksBackend.prototype._tokenizeComponents=function(a,b,e,d){var g={};g.subject=a==null?E.ANYTHING:a.indexOf("_:")==0?{token:"blank",value:a}:{token:"uri",value:a};g.predicate=b==null?E.ANYTHING:{token:"uri",value:b};g.object=e==null?E.ANYTHING:{token:"uri",value:e};g.graph=
d==null?E.ANYTHING:{token:"uri",value:d};return g};E.CallbacksBackend.prototype._indexForPattern=function(a){for(var a=a.indexKey,b=this.indices,e=0;e<b.length;e++)for(var d=b[e],g=this.componentOrders[d],i=0;i<g.length;i++){if(s.include(a,g[i])===!1)break;if(i==a.length-1)return d}return"SPOG"};E.CallbacksBackend.prototype.observeNode=function(){var a,b,e,d;arguments.length===4?(a=arguments[0],b=arguments[1],e=arguments[2],d=arguments[3]):(a=arguments[0],b=this.engine.lexicon.defaultGraphUri,e=arguments[1],
d=arguments[2]);b="CONSTRUCT { <"+a+"> ?p ?o } WHERE { GRAPH <"+b+"> { <"+a+"> ?p ?o } }";var g=this,i={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,i);var f=[];this.engine.execute(b,function(b,h){if(b){var o=!1,m=function(a,b){if(a==="eventsFlushed"&&o){o=!1;try{e(h)}catch(d){}}else if(a!=="eventsFlushed"){o=!0;for(var m=0;m<b.length;m++){var n=b[m],s=q.buildRDFResource(n.subject,f,g.engine,i),z=q.buildRDFResource(n.predicate,f,g.engine,i),n=q.buildRDFResource(n.object,f,g.engine,
i);s!=null&&z!=null&&n!=null&&(n=new q.Triple(s,z,n),a===E.added?h.add(n):a===E.deleted&&h.remove(n))}}};g.observersMap[e]=m;g.subscribeEmpty(E.eventsFlushed,m);g.subscribe(a,null,null,null,m,function(){try{e(h)}catch(a){}d&&d(!0)})}else d&&d(!1)})};E.CallbacksBackend.prototype.stopObservingNode=function(a){return(a=this.observersMap[a])?(this.unsubscribe(a),this.unsubscribeEmpty(E.eventsFlushed,a),!0):!1};E.CallbacksBackend.prototype.observeQuery=function(a,b,e){var d=this.aqt.collectBasicTriples(this.aqt.parseSelect(this.aqt.parseQueryString(a).units[0])),
g={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,g);var i,f,h,k=this.queryCounter;this.queryCounter++;this.queriesMap[k]=a;this.queriesInverseMap[a]=k;this.queriesList.push(k);this.queriesCallbacksMap[k]=b;for(var o=0;o<d.length;o++){f=d[o];if(f.graph==null)f.graph=this.engine.lexicon.defaultGraphUriTerm;f=this.engine.normalizeQuad(f,g,!0);i=new T.Pattern(f);h=this._indexForPattern(i);i=this.componentOrders[h];h=this.queriesIndexMap[h];for(var m=0;m<i.length;m++){var q=f[i[m]];if(typeof q===
"string"){h._==null&&(h._=[]);h._.push(k);break}else m===i.length-1?(h[q]=h[q]||{_:[]},h[q]._.push(k)):(h[q]=h[q]||{},h=h[q])}}this.engine.execute(a,function(a,d){a?b(d):console.log("ERROR in query callback "+d)});e!=null&&e()};E.CallbacksBackend.prototype.stopObservingQuery=function(a){var b=this.queriesInverseMap[a];if(b!=null)delete this.queriesInverseMap[a],delete this.queriesMap[b],this.queriesList=s.remove(this.queriesList,b)};E.CallbacksBackend.prototype._searchQueriesInIndex=function(a,b,
e){for(var e=e[1],d=0;d<b.length+1;d++){for(var g=a._||[],i=[],f=0;f<g.length;f++){var h=g[f];s.include(this.pendingQueries,h)&&(s.remove(this.pendingQueries,h),this.matchedQueries.push(h));this.queriesMap[h]!=null&&i.push(h)}a._=i;g=b[d];if(a[""+e[g]]!=null)a=a[""+e[g]];else break}};E.CallbacksBackend.prototype.dispatchQueries=function(a){var b=this,e,d,g,i,f={};s.repeat(0,this.matchedQueries.length,function(a,h){e=arguments.callee;g=b.matchedQueries[h._i];f[g]==null?(f[g]=!0,d=b.queriesMap[g],i=
b.queriesCallbacksMap[g],s.recur(function(){b.engine.execute(d,function(b,d){if(b)try{i(d)}catch(f){}a(e,h)})})):a(e,h)},function(){a()})};var I={};try{typeof Worker=="undefined"&&(Worker=null)}catch(wc){Worker=null}if(Worker)I.RDFStoreClient=function(a,b,e){console.log("trying to load "+a);this.connection=Worker.Worker?new Worker.Worker(a):new Worker(a);this.callbacksCounter=1;var d=this;this.rdf=q.rdf;console.log("The worker");console.log(this.connection);d=this;this.connection.onmessage=function(a){d.receive(a)};
this.observingCallbacks={};this.callbacks={0:{cb:function(a,b){a===!0?e(!0,d):e(!1,b)},fn:"create"}};this.connection.postMessage({fn:"create",args:b,callback:"0"})},I.RDFStoreClient.prototype.receive=function(a){a=a.data||a;if(a.fn==="workerRequest:NetworkTransport:load"){var b=this,e=a.callback,a=a.arguments.concat(function(a,d){b.connection.postMessage({fn:"workerRequestResponse",results:[a,d],callback:e})});P.load.apply(P,a)}else{var d=this.callbacks[a.callback];d&&(d.fn==="create"||d.fn==="execute"||
d.fn==="insert"||d.fn=="graph"||d.fn==="node"||d.fn==="insert"||d.fn==="delete"||d.fn==="clear"||d.fn==="load"||d.fn==="startObservingQueryEndCb"||d.fn==="registeredGraphs"?(delete this.callbacks[a.callback],d.cb(a.success,a.result)):d.fn==="startObservingQuery"?d.cb(a.result):d.fn==="startObservingNode"?d.cb(a.result):d.fn==="subscribe"&&d.cb(a.event,a.result))}},I.RDFStoreClient.prototype.registerCallback=function(a,b){var e=""+this.callbacksCounter;this.callbacks[e]={fn:a,cb:b};this.callbacksCounter++;
return e},I.RDFStoreClient.prototype.execute=function(){if(arguments.length===3)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2]);else if(arguments.length===4)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2],arguments[3]);else{var a,b;arguments.length===1?(a=arguments[0],b=function(){}):arguments.length===2&&(a=arguments[0],b=arguments[1]);b=this.registerCallback("execute",b);this.connection.postMessage({fn:"execute",args:[a],callback:b})}},I.RDFStoreClient.prototype.insert=
function(){var a,b,e;if(arguments.length===1)b=arguments[0],this.connection.postMessage({fn:"insert",args:[b]});else if(arguments.length===2)b=arguments[0],e=arguments[1]||function(){},e=this.registerCallback("insert",e),this.connection.postMessage({fn:"insert",args:[b],callback:e});else if(arguments.length===3)b=arguments[0],a=arguments[1],e=arguments[2]||function(){},e=this.registerCallback("insert",e),this.connection.postMessage({fn:"insert",args:[b,a],callback:e});else throw"The triples to insert, an optional graph and callback must be provided";
},I.RDFStoreClient.prototype.graph=function(){var a=null,b=null;if(arguments.length===1)b=arguments[0]||function(){};else if(arguments.length===2)b=arguments[1]||function(){},a=arguments[0];else throw"An optional graph URI and a callback function must be provided";var e=this,d=this.registerCallback("insert",function(a,d){if(a){for(var f,h=0;h<d.triples.length;h++)f=d.triples[h],d.triples[h]=new q.Triple(e.adaptJSInterface(f.subject),e.adaptJSInterface(f.predicate),e.adaptJSInterface(f.object));b(a,
e.rdf.createGraph(d.triples))}else b(a,d)});a==null?this.connection.postMessage({fn:"graph",args:[],callback:d}):this.connection.postMessage({fn:"graph",args:[a],callback:d})},I.RDFStoreClient.prototype.node=function(){var a=null,b=null,e=null;if(arguments.length===2)e=arguments[0],b=arguments[1]||function(){};else if(arguments.length===3)e=arguments[0],a=arguments[1],b=arguments[2]||function(){};else throw"An optional graph URI and a callback function must be provided";var d=this,g=this.registerCallback("insert",
function(a,e){if(a){for(var g,h=0;h<e.triples.length;h++)g=e.triples[h],e.triples[h]=new q.Triple(d.adaptJSInterface(g.subject),d.adaptJSInterface(g.predicate),d.adaptJSInterface(g.object));b(a,d.rdf.createGraph(e.triples))}else b(a,e)});a==null?this.connection.postMessage({fn:"node",args:[e],callback:g}):this.connection.postMessage({fn:"node",args:[e,a],callback:g})},I.RDFStoreClient.prototype.setPrefix=function(a,b){this.rdf.setPrefix(a,b);this.connection.postMessage({fn:"rdf/setPrefix",args:[a,
b],callback:null})},I.RDFStoreClient.prototype.setDefaultPrefix=function(a){this.rdf.setDefaultPrefix(a);this.connection.postMessage({fn:"rdf/setDefaultPrefix",args:[a],callback:null})},I.RDFStoreClient.prototype["delete"]=function(){var a,b,e;if(arguments.length===1)b=arguments[0],this.connection.postMessage({fn:"delete",args:[b]});else if(arguments.length===2)b=arguments[0],e=arguments[1]||function(){},e=this.registerCallback("delete",e),this.connection.postMessage({fn:"delete",args:[b],callback:e});
else if(arguments.length===3)b=arguments[0],a=arguments[1],e=arguments[2]||function(){},e=this.registerCallback("delete",e),this.connection.postMessage({fn:"delete",args:[b,a],callback:e});else throw"The triples to delete, an optional graph and callback must be provided";},I.RDFStoreClient.prototype.clear=function(){var a,b;if(arguments.length===1)b=arguments[0]||function(){},b=this.registerCallback("clear",b),this.connection.postMessage({fn:"clear",args:[],callback:b});else if(arguments.length===
2)a=arguments[0],b=arguments[1]||function(){},b=this.registerCallback("clear",b),this.connection.postMessage({fn:"clear",args:[a],callback:b});else throw"The optional graph and a callback must be provided";},I.RDFStoreClient.prototype.setBatchLoadEvents=function(a){this.connection.postMessage({fn:"setBatchLoadEvents",args:[a]})},I.RDFStoreClient.prototype.registerDefaultNamespace=function(a,b){this.connection.postMessage({fn:"registerDefaultNamespace",args:[a,b]})},I.RDFStoreClient.prototype.registerDefaultProfileNamespaces=
function(){this.connection.postMessage({fn:"registerDefaultProfileNamespaces",args:[]})},I.RDFStoreClient.prototype.load=function(){var a,b,e,d;if(arguments.length===3)a=arguments[0],b=arguments[1],d=arguments[2]||function(){},d=this.registerCallback("load",d),this.connection.postMessage({fn:"load",args:[a,b],callback:d});else if(arguments.length===4)a=arguments[0],b=arguments[1],e=arguments[2],d=arguments[3]||function(){},d=this.registerCallback("load",d),this.connection.postMessage({fn:"load",args:[a,
b,e],callback:d});else if(arguments.length===2)throw"The mediaType of the parser, the data a callback and an optional graph must be provided";},I.RDFStoreClient.prototype.startObservingQuery=function(a,b,e){e!=null?(b=this.registerCallback("startObservingQuery",b),this.observingCallbacks[a]=b,e=this.registerCallback("startObservingQueryEndCb",e),this.connection.postMessage({fn:"startObservingQuery",args:[a],callback:[b,e]})):(b=this.registerCallback("startObservingQuery",b),this.observingCallbacks[a]=
b,this.connection.postMessage({fn:"startObservingQuery",args:[a],callback:[b]}))},I.RDFStoreClient.prototype.stopObservingQuery=function(a){var b=this.observingCallbacks[a];delete this.observingCallbacks[a];delete this.callbacks[b];this.connection.postMessage({fn:"stopObservingQuery",args:[a],callback:[]})},I.RDFStoreClient.prototype.startObservingNode=function(){var a,b,e;if(arguments.length===2){a=arguments[0];e=arguments[1];var d=this,g=this.registerCallback("startObservingNode",function(a){for(var b,
g=0;g<a.triples.length;g++)b=a.triples[g],a.triples[g]=new q.Triple(d.adaptJSInterface(b.subject),d.adaptJSInterface(b.predicate),d.adaptJSInterface(b.object));e(d.rdf.createGraph(a.triples))});this.observingCallbacks[e]=g;this.connection.postMessage({fn:"startObservingNode",args:[a],callback:g})}else arguments.length===3&&(a=arguments[0],b=arguments[1],e=arguments[2],d=this,g=this.registerCallback("startObservingNode",function(a){for(var b,g=0;g<a.triples.length;g++)b=a.triples[g],a.triples[g]=new q.Triple(d.adaptJSInterface(b.subject),
d.adaptJSInterface(b.predicate),d.adaptJSInterface(b.object));e(d.rdf.createGraph(a.triples))}),this.observingCallbacks[e]=g,this.connection.postMessage({fn:"startObservingNode",args:[a,b],callback:g}))},I.RDFStoreClient.prototype.stopObservingNode=function(a){var b=this.observingCallbacks[a];delete this.observingCallbacks[a];delete this.callbacks[b];this.connection.postMessage({fn:"stopObservingNode",args:[b],callback:[]})},I.RDFStoreClient.prototype.subscribe=function(a,b,e,d,g){var i=this,f=this.registerCallback("subscribe",
function(a,b){for(var d,e=0;e<b.length;e++)d=b[e],b[e]=new q.Triple(i.adaptJSInterface(d.subject),i.adaptJSInterface(d.predicate),i.adaptJSInterface(d.object));g(a,b)});this.observingCallbacks[g]=f;this.connection.postMessage({fn:"subscribe",args:[a,b,e,d],callback:f})},I.RDFStoreClient.prototype.unsubscribe=function(a){var b=this.observingCallbacks[a];delete this.observingCallbacks[a];delete this.callbacks[b];this.connection.postMessage({fn:"unsubscribe",args:[b],callback:[]})},I.RDFStoreClient.prototype.registeredGraphs=
function(a){var b=this;this.connection.postMessage({fn:"registeredGraphs",args:[],callback:this.registerCallback("registeredGraphs",function(e,d){if(e)for(var g=0;g<d.length;g++)d[g]=b.adaptJSInterface(d[g]);a(e,d)})})},I.RDFStoreClient.prototype.adaptJSInterface=function(a){if(a.interfaceName==="BlankNode")return new q.BlankNode(a.bnodeId);else if(a.interfaceName==="Literal")return new q.Literal(a.nominalValue,a.language,a.datatype);else if(a.interfaceName==="NamedNode")return new q.NamedNode(a.nominalValue)},
I.RDFStoreClient.prototype.isWebWorkerConnection=!0;var D={},vc={MongodbQueryEngine:function(){throw"MongoDB backend not supported in the browser version";}};D.VERSION="0.8.1";D.connect=function(){var a,b,e;arguments.length==1&&(a=__dirname,b={},e=arguments[0]);arguments.length==2?(typeof arguments[0]==="string"?(a=arguments[0],b={}):(a=__dirname+"/index.js",b=arguments[0]),e=arguments[1]):(a=arguments[0],b=arguments[1],e=arguments[2]);try{Worker?new I.RDFStoreClient(a,b,function(a,b){e(a,b)}):D.create(b,
function(a){e(!1,a)})}catch(d){D.create(b,function(a){e(!1,a)})}};D.create=function(){return arguments.length==1?new D.Store(arguments[0]):arguments.length==2?new D.Store(arguments[0],arguments[1]):new D.Store};D.Store=function(a,b){var e=null,d=null;if(arguments.length==0)d={};else if(arguments.length==1)d={},e=a;else if(arguments.length>1)d=a,e=b;else throw"An optional argument map and a callback must be provided";d.treeOrder==null&&(d.treeOrder=15);this.functionMap={};var g=this;this.customFns=
{};d.engine==="mongodb"?(this.isMongodb=!0,this.engine=new vc.MongodbQueryEngine(d),this.engine.readConfiguration(function(){d.overwrite===!0?g.engine.clean(function(){e(g)}):e(g)})):new G.Lexicon(function(a){d.overwrite===!0&&a.clear();new V.QuadBackend(d,function(b){d.overwrite===!0&&b.clear();d.backend=b;d.lexicon=a;g.engine=new z.QueryEngine(d);e&&e(g)})},d.name)};D.Store.prototype.rdf=q.rdf;D.Store.prototype.rdf.api=q;D.Store.prototype.registerCustomFunction=function(a,b){this.customFns[a]=b;
this.engine.setCustomFunctions(this.customFns)};D.Store.prototype.execute=function(){if(arguments.length===3)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2]);else if(arguments.length===4)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2],arguments[3]);else{var a,b;arguments.length===1?(a=arguments[0],b=function(){}):arguments.length===2&&(a=arguments[0],b=arguments[1]);this.engine.execute(a,b)}};D.Store.prototype.executeWithEnvironment=function(){var a,b,e;if(arguments.length===
3){a=arguments[0];var d=function(){};b=arguments[1];e=arguments[2]}else arguments.length===4&&(a=arguments[0],d=arguments[3],b=arguments[1],e=arguments[2]);for(var g=[],h=[],f=0;f<b.length;f++)g.push({token:"uri",value:b[f]});for(f=0;f<e.length;f++)h.push({token:"uri",value:e[f]});this.engine.execute(a,d,g,h)};D.Store.prototype.graph=function(){var a=null,b=null;if(arguments.length===1)b=arguments[0]||function(){},a=this.engine.lexicon.defaultGraphUri;else if(arguments.length===2)b=arguments[1]||
function(){},a=arguments[0];else throw"An optional graph URI and a callback function must be provided";this.rdf.resolve(a)!=null&&(a=this.rdf.resolve(a));this.engine.execute("CONSTRUCT { ?s ?p ?o } WHERE { GRAPH <"+a+"> { ?s ?p ?o } }",b)};D.Store.prototype.node=function(){var a=null,b=null,e=null;if(arguments.length===2)e=arguments[0],b=arguments[1]||function(){},a=this.engine.lexicon.defaultGraphUri;else if(arguments.length===3)e=arguments[0],a=arguments[1],b=arguments[2]||function(){};else throw"An optional graph URI, node URI and a callback function must be provided";
this.rdf.resolve(a)!=null&&(a=this.rdf.resolve(a));this.rdf.resolve(e)!=null&&(e=this.rdf.resolve(e));this.engine.execute("CONSTRUCT { <"+e+"> ?p ?o } WHERE { GRAPH <"+a+"> { <"+e+"> ?p ?o } }",b)};D.Store.prototype.startObservingNode=function(){var a,b,e;arguments.length===2?(a=arguments[0],e=arguments[1],this.engine.callbacksBackend.observeNode(a,e,function(){})):arguments.length===3&&(a=arguments[0],b=arguments[1],e=arguments[2],this.engine.callbacksBackend.observeNode(a,b,e,function(){}))};D.Store.prototype.stopObservingNode=
function(a){this.engine.callbacksBackend.stopObservingNode(a)};D.Store.prototype.startObservingQuery=function(a,b,e){e!=null?this.engine.callbacksBackend.observeQuery(a,b,e):this.engine.callbacksBackend.observeQuery(a,b,function(){})};D.Store.prototype.stopObservingQuery=function(a){this.engine.callbacksBackend.stopObservingQuery(a)};D.Store.prototype.subscribe=function(a,b,e,d,g){var h=this,f=function(a,b){for(var d=[],e={blanks:{},outCache:{}},f=[],s=0;s<b.length;s++){var z=b[s],A=q.buildRDFResource(z.subject,
f,h.engine,e),y=q.buildRDFResource(z.predicate,f,h.engine,e),z=q.buildRDFResource(z.object,f,h.engine,e);A!=null&&y!=null&&z!=null&&(z=new q.Triple(A,y,z),d.push(z))}g(a,d)};this.functionMap[g]=f;this.engine.callbacksBackend.subscribe(a,b,e,d,f,function(){})};D.Store.prototype.unsubscribe=function(a){this.engine.callbacksBackend.unsubscribe(this.functionMap[a]);delete this.functionMap[a]};D.Store.prototype.setPrefix=function(a,b){this.rdf.setPrefix(a,b)};D.Store.prototype.setDefaultPrefix=function(a){this.rdf.setDefaultPrefix(a)};
D.Store.prototype.insert=function(){var a,b,e;if(arguments.length===1)b=arguments[0];else if(arguments.length===2)a=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),b=arguments[0],e=arguments[1]||function(){};else if(arguments.length===3)b=arguments[0],a=this.rdf.createNamedNode(arguments[1]),e=arguments[2]||function(){};else throw"The triples to insert, an optional graph and callback must be provided";var d="",g=this;b.forEach(function(a){d=d+g._nodeToQuery(a.subject)+g._nodeToQuery(a.predicate)+
g._nodeToQuery(a.object)+"."});d=a!=null?"INSERT DATA { GRAPH "+this._nodeToQuery(a)+" { "+d+" } }":"INSERT DATA { "+this._nodeToQuery(a)+" { "+d+" }";this.engine.execute(d,e)};D.Store.prototype._nodeToQuery=function(a){if(a.interfaceName==="NamedNode"){var b=this.rdf.resolve(a.valueOf());return b!=null?"<"+b+">":"<"+a.valueOf()+">"}else{if(a.interfaceName!=="")if(a.lang!=null)return'"'+a.valueOf()+'"@'+a.lang;else if(a.datatype!=null)return'"'+a.valueOf()+'"^^<'+a.datatype+">";return a.toString()}};
D.Store.prototype["delete"]=function(){var a,b,e;if(arguments.length===1)b=arguments[0];else if(arguments.length===2)a=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),b=arguments[0],e=arguments[1]||function(){};else if(arguments.length===3)b=arguments[0],a=this.rdf.createNamedNode(arguments[1]),e=arguments[2]||function(){};else throw"The triples to delete, an optional graph and callback must be provided";var d="",g=this;b.forEach(function(a){d=d+g._nodeToQuery(a.subject)+g._nodeToQuery(a.predicate)+
g._nodeToQuery(a.object)+"."});d=a!=null?"DELETE DATA { GRAPH "+this._nodeToQuery(a)+" { "+d+" } }":"DELETE DATA { "+this._nodeToQuery(a)+" { "+d+" }";this.engine.execute(d,e)};D.Store.prototype.clear=function(){var a,b;if(arguments.length===0)a=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),b=function(){};else if(arguments.length===1)a=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),b=arguments[0]||function(){};else if(arguments.length===2)a=this.rdf.createNamedNode(arguments[0]),
b=arguments[1]||function(){};else throw"The optional graph and a callback must be provided";this.engine.execute("CLEAR GRAPH "+this._nodeToQuery(a),b)};D.Store.prototype.setBatchLoadEvents=function(a){this.engine.eventsOnBatchLoad=a};D.Store.prototype.registerDefaultNamespace=function(a,b){this.rdf.prefixes.set(a,b);this.engine.registerDefaultNamespace(a,b)};D.Store.prototype.registerDefaultProfileNamespaces=function(){var a=this.rdf.prefixes.values(),b;for(b in a)this.registerDefaultNamespace(b,
a[b])};D.Store.prototype.load=function(){var a,b,e,d;if(arguments.length===3)e=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),a=arguments[0],b=arguments[1],d=arguments[2]||function(){};else if(arguments.length===4)a=arguments[0],b=arguments[1],e=this.rdf.createNamedNode(arguments[2]),d=arguments[3]||function(){};else if(arguments.length===2)throw"The mediaType of the parser, the data a callback and an optional graph must be provided";if(a==="remote")b=this.rdf.createNamedNode(b),this.engine.execute("LOAD <"+
b.valueOf()+"> INTO GRAPH <"+e.valueOf()+">",d);else if(b&&typeof b==="string"&&b.indexOf("file://")===0){a=this.engine.rdfLoader.parsers[a];var g=this;this.engine.rdfLoader.loadFromFile(a,{token:"uri",value:e.valueOf()},b,function(a,b){a?g.engine.batchLoad(b,d):d(a,b)})}else a=this.engine.rdfLoader.parsers[a],g=this,this.engine.rdfLoader.tryToParse(a,{token:"uri",value:e.valueOf()},b,function(a,b){a?g.engine.batchLoad(b,d):d(a,b)})};D.Store.prototype.registerParser=function(a,b){this.engine.rdfLoader.registerParser(a,
b)};D.Store.prototype.registeredGraphs=function(a){if(this.isMongodb)this.engine.registeredGraphs(!0,function(b){for(var d=[],e=0;e<b.length;e++){var g=new q.NamedNode(b[e]);d.push(g)}return a(!0,d)});else{for(var b=this.engine.lexicon.registeredGraphs(!0),e=[],d=0;d<b.length;d++){var g=new q.NamedNode(b[d]);e.push(g)}return a(!0,e)}};D.Store.prototype._nodeToQuery=function(a){if(a.interfaceName==="NamedNode"){var b=this.rdf.resolve(a.valueOf());return b!=null?"<"+b+">":"<"+a.valueOf()+">"}else return a.toString()};
D.Store.prototype.getNetworkTransport=function(){return P};D.Store.prototype.setNetworkTransport=function(a){P=a};D.Store.prototype.close=function(a){a==null&&(a=function(){});this.engine.close?this.engine.close(a):a()};RDFStoreWorker={observingCallbacks:{},workerCallbacksCounter:0,workerCallbacks:{}};RDFStoreWorker.registerCallback=function(a){var b=""+RDFStoreWorker.workerCallbacksCounter;RDFStoreWorker.workerCallbacksCounter++;RDFStoreWorker.workerCallbacks[b]=a;return b};RDFStoreWorker.handleCreate=
function(a,b){typeof P!="undefined"&&P!=null&&(P={load:function(a,b,e){var f=RDFStoreWorker.registerCallback(function(a){e.apply(e,a)});postMessage({fn:"workerRequest:NetworkTransport:load",callback:f,arguments:[a,b]})},loadFromFile:function(){}});var e=[a];e.push(function(a){RDFStoreWorker.store=a;postMessage({callback:b,result:"created",success:!0})});D.create.apply(D,e)};RDFStoreWorker.receive=function(a){var b=a.data||a;if(b.fn==="workerRequestResponse"){var e=b.callback,d=RDFStoreWorker.workerCallbacks[e];
d!=null&&(delete RDFStoreWorker.workerCallbacks[e],d(b.results))}else if(b.fn==="create"&&b.args!=null)RDFStoreWorker.handleCreate(b.args,b.callback);else if(b.fn==="setBatchLoadEvents")RDFStoreWorker.store[b.fn].apply(RDFStoreWorker.store,b.args);else if(b.fn==="registerDefaultNamespace")RDFStoreWorker.store[b.fn].apply(RDFStoreWorker.store,b.args);else if(b.fn==="registerDefaultProfileNamespaces")RDFStoreWorker.store[b.fn].apply(RDFStoreWorker.store,b.args);else if((b.fn==="execute"||b.fn==="executeWithEnvironment"||
b.fn==="graph"||b.fn==="node"||b.fn==="clear"||b.fn==="load")&&b.args!=null){b.args.push(function(a,d){b.callback!=null&&postMessage({callback:b.callback,result:d,success:a})});try{RDFStoreWorker.store[b.fn].apply(RDFStoreWorker.store,b.args)}catch(g){console.log("Error executing method through connection"),console.log(g)}}else if((b.fn==="insert"||b.fn==="delete")&&b.args!=null)try{b.args.push(function(a,d){b.callback!=null&&postMessage({callback:b.callback,result:d,success:a})});d=b.args[0];for(a=
0;a<d.triples.length;a++)e=d.triples[a],d.triples[a]=new q.Triple(RDFStoreWorker.adaptJSInterface(e.subject),RDFStoreWorker.adaptJSInterface(e.predicate),RDFStoreWorker.adaptJSInterface(e.object));b.args[1].interfaceName!=null&&(b.args[1]=RDFStoreWorker.adaptJSInterface(b.args[1]));b.args[0]=RDFStoreWorker.store.rdf.createGraph(d.triples);RDFStoreWorker.store[b.fn].apply(RDFStoreWorker.store,b.args)}catch(h){console.log("Error executing method through connection"),console.log(h)}else b.fn==="rdf/setPrefix"&&
b.args!=null?RDFStoreWorker.store.rdf.setPrefix(b.args[0],b.args[1]):b.fn==="rdf/setDefaultPrefix"&&b.args!=null?RDFStoreWorker.store.rdf.setDefaultPrefix(b.args[0]):b.fn==="startObservingQuery"&&b.args!=null?(e=function(a,d){postMessage({callback:b.callback[0],result:d,success:a})},RDFStoreWorker.observingCallbacks[b.args[0]]=e,b.args.push(e),b.args.push(function(a,d){b.callback&&b.callback[1]!=null&&postMessage({callback:b.callback[1],result:d,success:a})}),RDFStoreWorker.store[b.fn].apply(RDFStoreWorker.store,
b.args)):b.fn==="stopObservingQuery"?((e=RDFStoreWorker.observingCallbacks[b.args[0]])&&RDFStoreWorker.store[b.fn].apply(RDFStoreWorker.store,[e]),delete RDFStoreWorker.observingCallbacks[b.args[0]]):b.fn==="startObservingNode"&&b.args!=null?(e=function(a){postMessage({callback:b.callback,result:a})},RDFStoreWorker.observingCallbacks[b.callback]=e,b.args.push(e),RDFStoreWorker.store[b.fn].apply(RDFStoreWorker.store,b.args)):b.fn==="stopObservingNode"&&b.args!=null?((e=RDFStoreWorker.observingCallbacks[b.args[0]])&&
RDFStoreWorker.store[b.fn].apply(RDFStoreWorker.store,[e]),delete RDFStoreWorker.observingCallbacks[b.args[0]]):b.fn==="subscribe"&&b.args!=null?(e=function(a,d){postMessage({callback:b.callback,event:a,result:d})},RDFStoreWorker.observingCallbacks[b.callback]=e,b.args.push(e),RDFStoreWorker.store[b.fn].apply(RDFStoreWorker.store,b.args)):b.fn==="stopObservingNode"&&b.args!=null?((e=RDFStoreWorker.observingCallbacks[b.args[0]])&&RDFStoreWorker.store[b.fn].apply(RDFStoreWorker.store,[e]),delete RDFStoreWorker.observingCallbacks[b.args[0]]):
b.fn==="registeredGraphs"&&b.args!=null&&RDFStoreWorker.store[b.fn].apply(RDFStoreWorker.store,[function(a,d){b.callback!=null&&postMessage({callback:b.callback,result:d,success:a})}])};RDFStoreWorker.adaptJSInterface=function(a){if(a.interfaceName==="BlankNode")return new q.BlankNode(a.bnodeId);else if(a.interfaceName==="Literal")return new q.Literal(a.nominalValue,a.language,a.datatype);else if(a.interfaceName==="NamedNode")return new q.NamedNode(a.nominalValue)};onmessage=RDFStoreWorker.receive;
try{window.rdfstore=D}catch(xc){}})();
